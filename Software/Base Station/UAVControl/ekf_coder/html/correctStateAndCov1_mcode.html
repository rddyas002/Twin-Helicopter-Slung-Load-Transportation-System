<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">xCorr</span>,<span class="var type1" id="S3T29U4">PCorr</span>] = correctStateAndCov(<span class="var type1" id="S4T7U7">x</span>,<span class="var type1" id="S5T2U8">z</span>,<span class="var type1" id="S6T29U9">P</span>,<span class="var type1" id="S7T5U10">object_points</span>,<span class="var type1" id="S8T1U11">Measurement_noise</span>)<span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">    <span class="comment">% need to determine the number of rows of H</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">    <span class="comment">% 2 eqs per blob per camera --&gt; maximum of 24 equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line">    <span class="comment">% z is a 1x4 (column per camera) struct with the following field</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line">    <span class="comment">%     f1 = 'number_red';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">%     f2 = 'number_green';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="comment">%     f3 = 'number_blue';   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="comment">%     f4 = 'red_data';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="comment">%     f5 = 'green_data';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%     f6 = 'blue_data';  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="comment">%     f7 = 'time';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo" id="T1:U8"><span class="var type1" id="S9T1U14">num_measurements</span> = <span class="mxinfo" id="T1:U10">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">% only allow single blob detection for now</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S10T1U18">i</span> = <span class="mxinfo" id="T1:U12">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U13"><span class="mxinfo" id="T1:U14"><span class="mxinfo" id="T53:U15"><span class="var type1" id="S5T2U28">z</span>(<span class="var type1" id="S10T1U29">i</span>)</span>.number_red</span> == <span class="mxinfo" id="T1:U18">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">            <span class="mxinfo" id="T1:U19"><span class="var type1" id="S9T1U34">num_measurements</span> = <span class="mxinfo" id="T1:U21"><span class="var type1" id="S9T1U36">num_measurements</span> + <span class="mxinfo" id="T1:U23">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U24"><span class="mxinfo" id="T1:U25"><span class="mxinfo" id="T53:U26"><span class="var type1" id="S5T2U44">z</span>(<span class="var type1" id="S10T1U45">i</span>)</span>.number_green</span> == <span class="mxinfo" id="T1:U29">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">            <span class="mxinfo" id="T1:U30"><span class="var type1" id="S9T1U50">num_measurements</span> = <span class="mxinfo" id="T1:U32"><span class="var type1" id="S9T1U52">num_measurements</span> + <span class="mxinfo" id="T1:U34">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U35"><span class="mxinfo" id="T1:U36"><span class="mxinfo" id="T53:U37"><span class="var type1" id="S5T2U60">z</span>(<span class="var type1" id="S10T1U61">i</span>)</span>.number_blue</span> == <span class="mxinfo" id="T1:U40">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">            <span class="mxinfo" id="T1:U41"><span class="var type1" id="S9T1U66">num_measurements</span> = <span class="mxinfo" id="T1:U43"><span class="var type1" id="S9T1U68">num_measurements</span> + <span class="mxinfo" id="T1:U45">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">        <span class="keyword">end</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo" id="T20:U46"><span class="var type1" id="S11T20U72">H</span> = <span class="mxinfo" id="T20:U48">zeros(<span class="var type1" id="S9T1U75">num_measurements</span>,<span class="mxinfo" id="T1:U50">16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo" id="T6:U51"><span class="var type1" id="S13T6U79">Twp</span> = <span class="mxinfo" id="T6:U53"><span class="var type1" id="S4T7U81">x</span>(<span class="mxinfo" id="T17:U55"><span class="mxinfo" id="T1:U56">1</span>:<span class="mxinfo" id="T1:U57">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    <span class="mxinfo" id="T9:U58"><span class="var type1" id="S14T9U87">qwp</span> = <span class="mxinfo" id="T9:U60"><span class="var type1" id="S4T7U89">x</span>(<span class="mxinfo" id="T18:U62"><span class="mxinfo" id="T1:U63">7</span>:<span class="mxinfo" id="T1:U64">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="mxinfo" id="T34:U65"><span class="var type1" id="S15T34U95">z_est</span> = <span class="mxinfo" id="T34:U67">zeros(<span class="var type1" id="S9T1U98">num_measurements</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo" id="T34:U69"><span class="var type1" id="S16T34U102">z_meas</span> = <span class="mxinfo" id="T34:U71">zeros(<span class="var type1" id="S9T1U105">num_measurements</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="comment">% calculate innovation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo" id="T1:U73"><span class="var type1" id="S17T1U109">k</span> = <span class="mxinfo" id="T1:U75">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S10T1U113">i</span> = <span class="mxinfo" id="T1:U77">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">        <span class="comment">% red blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U78"><span class="mxinfo" id="T1:U79"><span class="mxinfo" id="T53:U80"><span class="var type1" id="S5T2U123">z</span>(<span class="mxinfo" id="T1:U82">1</span>,<span class="var type1" id="S10T1U125">i</span>)</span>.number_red</span> == <span class="mxinfo" id="T1:U84">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">            <span class="comment">% do measurement estimation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">            <span class="mxinfo" id="T5:U85"><span class="var type1" id="S18T5U130">A</span> = <span class="mxinfo" id="T5:U87"><span class="mxinfo" id="T5:U88"><span class="mxinfo" id="T4:U89"><span class="mxinfo" id="T53:U90"><span class="var type1" id="S5T2U135">z</span>(<span class="mxinfo" id="T1:U92">1</span>,<span class="var type1" id="S10T1U137">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*<span class="mxinfo" id="T1:U94">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">            <span class="mxinfo" id="T5:U95"><span class="var type1" id="S19T5U143">Rcw</span> = <span class="mxinfo" id="T5:U97"><span class="mxinfo" id="T4:U98"><span class="mxinfo" id="T53:U99"><span class="var type1" id="S5T2U147">z</span>(<span class="mxinfo" id="T1:U101">1</span>,<span class="var type1" id="S10T1U149">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">            <span class="mxinfo" id="T6:U103"><span class="var type1" id="S20T6U154">Tcw</span> = <span class="mxinfo" id="T6:U105"><span class="mxinfo" id="T6:U106"><span class="mxinfo" id="T4:U107"><span class="mxinfo" id="T53:U108"><span class="var type1" id="S5T2U159">z</span>(<span class="mxinfo" id="T1:U110">1</span>,<span class="var type1" id="S10T1U161">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U112">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">            <span class="mxinfo" id="T16:U113"><span class="var type1" id="S21T16U167">u</span> = <span class="mxinfo" id="T16:U115"><span class="fcn" id="F55N4:B169">project2_2D</span>(<span class="var type1" id="S18T5U170">A</span>,<span class="var type1" id="S19T5U171">Rcw</span>,<span class="var type1" id="S20T6U172">Tcw</span>,<span class="var type1" id="S13T6U173">Twp</span>,<span class="var type1" id="S14T9U174">qwp</span>,<span class="mxinfo" id="T6:U121"><span class="mxinfo" id="T6:U122"><span class="var type1" id="S7T5U177">object_points</span>(:,<span class="mxinfo" id="T1:U124">1</span>)</span>/<span class="mxinfo" id="T1:U125">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">            <span class="mxinfo" id="T16:U126"><span class="mxinfo" id="T16:U127"><span class="var type1" id="S15T34U184">z_est</span>(<span class="mxinfo" id="T16:U129"><span class="var type1" id="S17T1U186">k</span>:<span class="mxinfo" id="T1:U131"><span class="var type1" id="S17T1U188">k</span>+1</span></span>,<span class="mxinfo" id="T1:U133">1</span>)</span> = <span class="var type1" id="S21T16U191">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">            <span class="comment">% do jacobian calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">            <span class="mxinfo" id="T5:U135"><span class="var type1" id="S23T5U194">K</span> = <span class="mxinfo" id="T5:U137"><span class="var type1" id="S18T5U196">A</span>*<span class="var type1" id="S19T5U197">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">            <span class="mxinfo" id="T1:U140"><span class="var type1" id="S24T1U200">X</span> = <span class="mxinfo" id="T1:U142"><span class="mxinfo" id="T1:U143"><span class="var type1" id="S7T5U203">object_points</span>(<span class="mxinfo" id="T1:U145">1</span>,<span class="mxinfo" id="T1:U146">1</span>)</span>/<span class="mxinfo" id="T1:U147">1000</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">            <span class="mxinfo" id="T1:U148"><span class="var type1" id="S25T1U209">Y</span> = <span class="mxinfo" id="T1:U150"><span class="mxinfo" id="T1:U151"><span class="var type1" id="S7T5U212">object_points</span>(<span class="mxinfo" id="T1:U153">2</span>,<span class="mxinfo" id="T1:U154">1</span>)</span>/<span class="mxinfo" id="T1:U155">1000</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">            <span class="mxinfo" id="T1:U156"><span class="var type1" id="S26T1U218">Z</span> = <span class="mxinfo" id="T1:U158"><span class="mxinfo" id="T1:U159"><span class="var type1" id="S7T5U221">object_points</span>(<span class="mxinfo" id="T1:U161">3</span>,<span class="mxinfo" id="T1:U162">1</span>)</span>/<span class="mxinfo" id="T1:U163">1000</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">            <span class="mxinfo" id="T1:U164"><span class="var type1" id="S27T1U227">B1</span> = <span class="mxinfo" id="T1:U166"><span class="mxinfo" id="T1:U167"><span class="mxinfo" id="T1:U168"><span class="mxinfo" id="T1:U169"><span class="mxinfo" id="T1:U170">(<span class="mxinfo" id="T1:U171"><span class="mxinfo" id="T1:U172"><span class="mxinfo" id="T1:U173"><span class="mxinfo" id="T1:U174"><span class="mxinfo" id="T1:U175"><span class="var type1" id="S14T9U239">qwp</span>(<span class="mxinfo" id="T1:U177">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U178"><span class="mxinfo" id="T1:U179"><span class="var type1" id="S14T9U244">qwp</span>(<span class="mxinfo" id="T1:U181">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U182"><span class="mxinfo" id="T1:U183"><span class="var type1" id="S14T9U249">qwp</span>(<span class="mxinfo" id="T1:U185">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U186"><span class="mxinfo" id="T1:U187"><span class="var type1" id="S14T9U254">qwp</span>(<span class="mxinfo" id="T1:U189">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U257">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T1:U164"><span class="mxinfo" id="T1:U166"><span class="mxinfo" id="T1:U167"><span class="mxinfo" id="T1:U168"><span class="mxinfo" id="T1:U169">                <span class="mxinfo" id="T1:U191"><span class="mxinfo" id="T1:U192"><span class="mxinfo" id="T1:U193">+ 2</span>*(<span class="mxinfo" id="T1:U194"><span class="mxinfo" id="T1:U195"><span class="mxinfo" id="T1:U196"><span class="var type1" id="S14T9U266">qwp</span>(<span class="mxinfo" id="T1:U198">2</span>)</span>*<span class="mxinfo" id="T1:U199"><span class="var type1" id="S14T9U269">qwp</span>(<span class="mxinfo" id="T1:U201">3</span>)</span></span> - <span class="mxinfo" id="T1:U202"><span class="mxinfo" id="T1:U203"><span class="var type1" id="S14T9U273">qwp</span>(<span class="mxinfo" id="T1:U205">1</span>)</span>*<span class="mxinfo" id="T1:U206"><span class="var type1" id="S14T9U276">qwp</span>(<span class="mxinfo" id="T1:U208">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U278">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo" id="T1:U164"><span class="mxinfo" id="T1:U166"><span class="mxinfo" id="T1:U167"><span class="mxinfo" id="T1:U168">                <span class="mxinfo" id="T1:U210"><span class="mxinfo" id="T1:U211"><span class="mxinfo" id="T1:U212">+ 2</span>*(<span class="mxinfo" id="T1:U213"><span class="mxinfo" id="T1:U214"><span class="mxinfo" id="T1:U215"><span class="var type1" id="S14T9U287">qwp</span>(<span class="mxinfo" id="T1:U217">2</span>)</span>*<span class="mxinfo" id="T1:U218"><span class="var type1" id="S14T9U290">qwp</span>(<span class="mxinfo" id="T1:U220">4</span>)</span></span> + <span class="mxinfo" id="T1:U221"><span class="mxinfo" id="T1:U222"><span class="var type1" id="S14T9U294">qwp</span>(<span class="mxinfo" id="T1:U224">1</span>)</span>*<span class="mxinfo" id="T1:U225"><span class="var type1" id="S14T9U297">qwp</span>(<span class="mxinfo" id="T1:U227">3</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U299">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T1:U164"><span class="mxinfo" id="T1:U166"><span class="mxinfo" id="T1:U167">                + <span class="mxinfo" id="T1:U229"><span class="var type1" id="S13T6U302">Twp</span>(<span class="mxinfo" id="T1:U231">1</span>)</span></span> - <span class="mxinfo" id="T1:U232"><span class="mxinfo" id="T1:U233"><span class="mxinfo" id="T6:U234"><span class="mxinfo" id="T4:U235"><span class="mxinfo" id="T53:U236"><span class="var type1" id="S5T2U309">z</span>(<span class="mxinfo" id="T1:U238">1</span>,<span class="var type1" id="S10T1U311">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U240">1</span>)</span>/<span class="mxinfo" id="T1:U241">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">            <span class="mxinfo" id="T1:U242"><span class="var type1" id="S28T1U318">B2</span> = <span class="mxinfo" id="T1:U244"><span class="mxinfo" id="T1:U245"><span class="mxinfo" id="T1:U246"><span class="mxinfo" id="T1:U247"><span class="mxinfo" id="T1:U248"><span class="mxinfo" id="T1:U249"><span class="mxinfo" id="T1:U250">2</span>*(<span class="mxinfo" id="T1:U251"><span class="mxinfo" id="T1:U252"><span class="mxinfo" id="T1:U253"><span class="var type1" id="S14T9U330">qwp</span>(<span class="mxinfo" id="T1:U255">2</span>)</span>*<span class="mxinfo" id="T1:U256"><span class="var type1" id="S14T9U333">qwp</span>(<span class="mxinfo" id="T1:U258">3</span>)</span></span> + <span class="mxinfo" id="T1:U259"><span class="mxinfo" id="T1:U260"><span class="var type1" id="S14T9U337">qwp</span>(<span class="mxinfo" id="T1:U262">1</span>)</span>*<span class="mxinfo" id="T1:U263"><span class="var type1" id="S14T9U340">qwp</span>(<span class="mxinfo" id="T1:U265">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U342">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="mxinfo" id="T1:U242"><span class="mxinfo" id="T1:U244"><span class="mxinfo" id="T1:U245"><span class="mxinfo" id="T1:U246"><span class="mxinfo" id="T1:U247">                <span class="mxinfo" id="T1:U267">+ (<span class="mxinfo" id="T1:U268"><span class="mxinfo" id="T1:U269"><span class="mxinfo" id="T1:U270"><span class="mxinfo" id="T1:U271"><span class="mxinfo" id="T1:U272"><span class="var type1" id="S14T9U351">qwp</span>(<span class="mxinfo" id="T1:U274">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U275"><span class="mxinfo" id="T1:U276"><span class="var type1" id="S14T9U356">qwp</span>(<span class="mxinfo" id="T1:U278">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U279"><span class="mxinfo" id="T1:U280"><span class="var type1" id="S14T9U361">qwp</span>(<span class="mxinfo" id="T1:U282">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U283"><span class="mxinfo" id="T1:U284"><span class="var type1" id="S14T9U366">qwp</span>(<span class="mxinfo" id="T1:U286">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U369">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T1:U242"><span class="mxinfo" id="T1:U244"><span class="mxinfo" id="T1:U245"><span class="mxinfo" id="T1:U246">                <span class="mxinfo" id="T1:U288"><span class="mxinfo" id="T1:U289"><span class="mxinfo" id="T1:U290">+ 2</span>*(<span class="mxinfo" id="T1:U291"><span class="mxinfo" id="T1:U292"><span class="mxinfo" id="T1:U293"><span class="var type1" id="S14T9U378">qwp</span>(<span class="mxinfo" id="T1:U295">3</span>)</span>*<span class="mxinfo" id="T1:U296"><span class="var type1" id="S14T9U381">qwp</span>(<span class="mxinfo" id="T1:U298">4</span>)</span></span> - <span class="mxinfo" id="T1:U299"><span class="mxinfo" id="T1:U300"><span class="var type1" id="S14T9U385">qwp</span>(<span class="mxinfo" id="T1:U302">1</span>)</span>*<span class="mxinfo" id="T1:U303"><span class="var type1" id="S14T9U388">qwp</span>(<span class="mxinfo" id="T1:U305">2</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U390">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo" id="T1:U242"><span class="mxinfo" id="T1:U244"><span class="mxinfo" id="T1:U245">                + <span class="mxinfo" id="T1:U307"><span class="var type1" id="S13T6U393">Twp</span>(<span class="mxinfo" id="T1:U309">2</span>)</span></span> - <span class="mxinfo" id="T1:U310"><span class="mxinfo" id="T1:U311"><span class="mxinfo" id="T6:U312"><span class="mxinfo" id="T4:U313"><span class="mxinfo" id="T53:U314"><span class="var type1" id="S5T2U400">z</span>(<span class="mxinfo" id="T1:U316">1</span>,<span class="var type1" id="S10T1U402">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U318">2</span>)</span>/<span class="mxinfo" id="T1:U319">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">            <span class="mxinfo" id="T1:U320"><span class="var type1" id="S29T1U409">B3</span> = <span class="mxinfo" id="T1:U322"><span class="mxinfo" id="T1:U323"><span class="mxinfo" id="T1:U324"><span class="mxinfo" id="T1:U325"><span class="mxinfo" id="T1:U326"><span class="mxinfo" id="T1:U327"><span class="mxinfo" id="T1:U328">2</span>*(<span class="mxinfo" id="T1:U329"><span class="mxinfo" id="T1:U330"><span class="mxinfo" id="T1:U331"><span class="var type1" id="S14T9U421">qwp</span>(<span class="mxinfo" id="T1:U333">2</span>)</span>*<span class="mxinfo" id="T1:U334"><span class="var type1" id="S14T9U424">qwp</span>(<span class="mxinfo" id="T1:U336">4</span>)</span></span> - <span class="mxinfo" id="T1:U337"><span class="mxinfo" id="T1:U338"><span class="var type1" id="S14T9U428">qwp</span>(<span class="mxinfo" id="T1:U340">1</span>)</span>*<span class="mxinfo" id="T1:U341"><span class="var type1" id="S14T9U431">qwp</span>(<span class="mxinfo" id="T1:U343">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U433">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="mxinfo" id="T1:U320"><span class="mxinfo" id="T1:U322"><span class="mxinfo" id="T1:U323"><span class="mxinfo" id="T1:U324"><span class="mxinfo" id="T1:U325">                <span class="mxinfo" id="T1:U345"><span class="mxinfo" id="T1:U346"><span class="mxinfo" id="T1:U347">+ 2</span>*(<span class="mxinfo" id="T1:U348"><span class="mxinfo" id="T1:U349"><span class="mxinfo" id="T1:U350"><span class="var type1" id="S14T9U442">qwp</span>(<span class="mxinfo" id="T1:U352">3</span>)</span>*<span class="mxinfo" id="T1:U353"><span class="var type1" id="S14T9U445">qwp</span>(<span class="mxinfo" id="T1:U355">4</span>)</span></span> + <span class="mxinfo" id="T1:U356"><span class="mxinfo" id="T1:U357"><span class="var type1" id="S14T9U449">qwp</span>(<span class="mxinfo" id="T1:U359">1</span>)</span>*<span class="mxinfo" id="T1:U360"><span class="var type1" id="S14T9U452">qwp</span>(<span class="mxinfo" id="T1:U362">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U454">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo" id="T1:U320"><span class="mxinfo" id="T1:U322"><span class="mxinfo" id="T1:U323"><span class="mxinfo" id="T1:U324">                <span class="mxinfo" id="T1:U364">+ (<span class="mxinfo" id="T1:U365"><span class="mxinfo" id="T1:U366"><span class="mxinfo" id="T1:U367"><span class="mxinfo" id="T1:U368"><span class="mxinfo" id="T1:U369"><span class="var type1" id="S14T9U463">qwp</span>(<span class="mxinfo" id="T1:U371">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U372"><span class="mxinfo" id="T1:U373"><span class="var type1" id="S14T9U468">qwp</span>(<span class="mxinfo" id="T1:U375">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U376"><span class="mxinfo" id="T1:U377"><span class="var type1" id="S14T9U473">qwp</span>(<span class="mxinfo" id="T1:U379">3</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U380"><span class="mxinfo" id="T1:U381"><span class="var type1" id="S14T9U478">qwp</span>(<span class="mxinfo" id="T1:U383">4</span>)</span>^2</span></span>)*<span class="var type1" id="S26T1U481">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo" id="T1:U320"><span class="mxinfo" id="T1:U322"><span class="mxinfo" id="T1:U323">                + <span class="mxinfo" id="T1:U385"><span class="var type1" id="S13T6U484">Twp</span>(<span class="mxinfo" id="T1:U387">3</span>)</span></span> - <span class="mxinfo" id="T1:U388"><span class="mxinfo" id="T1:U389"><span class="mxinfo" id="T6:U390"><span class="mxinfo" id="T4:U391"><span class="mxinfo" id="T53:U392"><span class="var type1" id="S5T2U491">z</span>(<span class="mxinfo" id="T1:U394">1</span>,<span class="var type1" id="S10T1U493">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U396">3</span>)</span>/<span class="mxinfo" id="T1:U397">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m                </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">            <span class="mxinfo" id="T1:U398"><span class="var type1" id="S30T1U500">b</span> = <span class="mxinfo" id="T1:U400"><span class="mxinfo" id="T1:U401"><span class="mxinfo" id="T1:U402"><span class="mxinfo" id="T1:U403"><span class="var type1" id="S23T5U505">K</span>(<span class="mxinfo" id="T1:U405">3</span>,<span class="mxinfo" id="T1:U406">1</span>)</span>*<span class="var type1" id="S27T1U508">B1</span></span> + <span class="mxinfo" id="T1:U408"><span class="mxinfo" id="T1:U409"><span class="var type1" id="S23T5U511">K</span>(<span class="mxinfo" id="T1:U411">3</span>,<span class="mxinfo" id="T1:U412">2</span>)</span>*<span class="var type1" id="S28T1U514">B2</span></span></span> + <span class="mxinfo" id="T1:U414"><span class="mxinfo" id="T1:U415"><span class="var type1" id="S23T5U517">K</span>(<span class="mxinfo" id="T1:U417">3</span>,<span class="mxinfo" id="T1:U418">3</span>)</span>*<span class="var type1" id="S29T1U520">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            <span class="mxinfo" id="T1:U420"><span class="var type1" id="S31T1U523">bu</span> = <span class="var type1" id="S30T1U524">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">            <span class="mxinfo" id="T1:U423"><span class="var type1" id="S32T1U527">bv</span> = <span class="var type1" id="S30T1U528">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">            <span class="mxinfo" id="T1:U426"><span class="var type1" id="S33T1U531">au</span> = <span class="mxinfo" id="T1:U428"><span class="mxinfo" id="T1:U429"><span class="mxinfo" id="T1:U430"><span class="mxinfo" id="T1:U431"><span class="var type1" id="S23T5U536">K</span>(<span class="mxinfo" id="T1:U433">1</span>,<span class="mxinfo" id="T1:U434">1</span>)</span>*<span class="var type1" id="S27T1U539">B1</span></span> + <span class="mxinfo" id="T1:U436"><span class="mxinfo" id="T1:U437"><span class="var type1" id="S23T5U542">K</span>(<span class="mxinfo" id="T1:U439">1</span>,<span class="mxinfo" id="T1:U440">2</span>)</span>*<span class="var type1" id="S28T1U545">B2</span></span></span> + <span class="mxinfo" id="T1:U442"><span class="mxinfo" id="T1:U443"><span class="var type1" id="S23T5U548">K</span>(<span class="mxinfo" id="T1:U445">1</span>,<span class="mxinfo" id="T1:U446">3</span>)</span>*<span class="var type1" id="S29T1U551">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">            <span class="mxinfo" id="T1:U448"><span class="var type1" id="S34T1U554">av</span> = <span class="mxinfo" id="T1:U450"><span class="mxinfo" id="T1:U451"><span class="mxinfo" id="T1:U452"><span class="mxinfo" id="T1:U453"><span class="var type1" id="S23T5U559">K</span>(<span class="mxinfo" id="T1:U455">2</span>,<span class="mxinfo" id="T1:U456">1</span>)</span>*<span class="var type1" id="S27T1U562">B1</span></span> + <span class="mxinfo" id="T1:U458"><span class="mxinfo" id="T1:U459"><span class="var type1" id="S23T5U565">K</span>(<span class="mxinfo" id="T1:U461">2</span>,<span class="mxinfo" id="T1:U462">2</span>)</span>*<span class="var type1" id="S28T1U568">B2</span></span></span> + <span class="mxinfo" id="T1:U464"><span class="mxinfo" id="T1:U465"><span class="var type1" id="S23T5U571">K</span>(<span class="mxinfo" id="T1:U467">2</span>,<span class="mxinfo" id="T1:U468">3</span>)</span>*<span class="var type1" id="S29T1U574">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">            <span class="mxinfo" id="T17:U470"><span class="var type1" id="S35T17U577">dB_zeros</span> = <span class="mxinfo" id="T17:U472">[0 0 0]</span></span>;               </span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="mxinfo" id="T18:U473"><span class="var type1" id="S36T18U585">dB1_q</span> = <span class="mxinfo" id="T18:U475">[<span class="mxinfo" id="T1:U476"><span class="mxinfo" id="T1:U477">2</span>*(<span class="mxinfo" id="T1:U478"><span class="mxinfo" id="T1:U479"><span class="mxinfo" id="T1:U480"><span class="mxinfo" id="T1:U481"><span class="var type1" id="S14T9U595">qwp</span>(<span class="mxinfo" id="T1:U483">1</span>)</span>*<span class="var type1" id="S24T1U597">X</span></span> - <span class="mxinfo" id="T1:U485"><span class="mxinfo" id="T1:U486"><span class="var type1" id="S14T9U600">qwp</span>(<span class="mxinfo" id="T1:U488">4</span>)</span>*<span class="var type1" id="S25T1U602">Y</span></span></span> + <span class="mxinfo" id="T1:U490"><span class="mxinfo" id="T1:U491"><span class="var type1" id="S14T9U605">qwp</span>(<span class="mxinfo" id="T1:U493">3</span>)</span>*<span class="var type1" id="S26T1U607">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U495"><span class="mxinfo" id="T1:U496">2</span>*(<span class="mxinfo" id="T1:U497"><span class="mxinfo" id="T1:U498"><span class="mxinfo" id="T1:U499"><span class="mxinfo" id="T1:U500"><span class="var type1" id="S14T9U615">qwp</span>(<span class="mxinfo" id="T1:U502">2</span>)</span>*<span class="var type1" id="S24T1U617">X</span></span> + <span class="mxinfo" id="T1:U504"><span class="mxinfo" id="T1:U505"><span class="var type1" id="S14T9U620">qwp</span>(<span class="mxinfo" id="T1:U507">3</span>)</span>*<span class="var type1" id="S25T1U622">Y</span></span></span> + <span class="mxinfo" id="T1:U509"><span class="mxinfo" id="T1:U510"><span class="var type1" id="S14T9U625">qwp</span>(<span class="mxinfo" id="T1:U512">4</span>)</span>*<span class="var type1" id="S26T1U627">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo" id="T18:U473"><span class="mxinfo" id="T18:U475">                    <span class="mxinfo" id="T1:U514"><span class="mxinfo" id="T1:U515">2</span>*(<span class="mxinfo" id="T1:U516"><span class="mxinfo" id="T1:U517"><span class="mxinfo" id="T1:U518"><span class="mxinfo" id="T1:U519">-<span class="mxinfo" id="T1:U520"><span class="var type1" id="S14T9U636">qwp</span>(<span class="mxinfo" id="T1:U522">3</span>)</span></span>*<span class="var type1" id="S24T1U638">X</span></span> + <span class="mxinfo" id="T1:U524"><span class="mxinfo" id="T1:U525"><span class="var type1" id="S14T9U641">qwp</span>(<span class="mxinfo" id="T1:U527">2</span>)</span>*<span class="var type1" id="S25T1U643">Y</span></span></span> + <span class="mxinfo" id="T1:U529"><span class="mxinfo" id="T1:U530"><span class="var type1" id="S14T9U646">qwp</span>(<span class="mxinfo" id="T1:U532">1</span>)</span>*<span class="var type1" id="S26T1U648">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U534"><span class="mxinfo" id="T1:U535">2</span>*(<span class="mxinfo" id="T1:U536"><span class="mxinfo" id="T1:U537"><span class="mxinfo" id="T1:U538"><span class="mxinfo" id="T1:U539">-<span class="mxinfo" id="T1:U540"><span class="var type1" id="S14T9U657">qwp</span>(<span class="mxinfo" id="T1:U542">4</span>)</span></span>*<span class="var type1" id="S24T1U659">X</span></span> - <span class="mxinfo" id="T1:U544"><span class="mxinfo" id="T1:U545"><span class="var type1" id="S14T9U662">qwp</span>(<span class="mxinfo" id="T1:U547">1</span>)</span>*<span class="var type1" id="S25T1U664">Y</span></span></span> + <span class="mxinfo" id="T1:U549"><span class="mxinfo" id="T1:U550"><span class="var type1" id="S14T9U667">qwp</span>(<span class="mxinfo" id="T1:U552">2</span>)</span>*<span class="var type1" id="S26T1U669">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">            <span class="mxinfo" id="T18:U554"><span class="var type1" id="S37T18U672">dB2_q</span> = <span class="mxinfo" id="T18:U556">[<span class="mxinfo" id="T1:U557"><span class="mxinfo" id="T1:U558">2</span>*(<span class="mxinfo" id="T1:U559"><span class="mxinfo" id="T1:U560"><span class="mxinfo" id="T1:U561"><span class="mxinfo" id="T1:U562"><span class="var type1" id="S14T9U682">qwp</span>(<span class="mxinfo" id="T1:U564">4</span>)</span>*<span class="var type1" id="S24T1U684">X</span></span> + <span class="mxinfo" id="T1:U566"><span class="mxinfo" id="T1:U567"><span class="var type1" id="S14T9U687">qwp</span>(<span class="mxinfo" id="T1:U569">1</span>)</span>*<span class="var type1" id="S25T1U689">Y</span></span></span> - <span class="mxinfo" id="T1:U571"><span class="mxinfo" id="T1:U572"><span class="var type1" id="S14T9U692">qwp</span>(<span class="mxinfo" id="T1:U574">2</span>)</span>*<span class="var type1" id="S26T1U694">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U576"><span class="mxinfo" id="T1:U577">2</span>*(<span class="mxinfo" id="T1:U578"><span class="mxinfo" id="T1:U579"><span class="mxinfo" id="T1:U580"><span class="mxinfo" id="T1:U581"><span class="var type1" id="S14T9U702">qwp</span>(<span class="mxinfo" id="T1:U583">3</span>)</span>*<span class="var type1" id="S24T1U704">X</span></span> - <span class="mxinfo" id="T1:U585"><span class="mxinfo" id="T1:U586"><span class="var type1" id="S14T9U707">qwp</span>(<span class="mxinfo" id="T1:U588">2</span>)</span>*<span class="var type1" id="S25T1U709">Y</span></span></span> - <span class="mxinfo" id="T1:U590"><span class="mxinfo" id="T1:U591"><span class="var type1" id="S14T9U712">qwp</span>(<span class="mxinfo" id="T1:U593">1</span>)</span>*<span class="var type1" id="S26T1U714">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo" id="T18:U554"><span class="mxinfo" id="T18:U556">                    <span class="mxinfo" id="T1:U595"><span class="mxinfo" id="T1:U596">2</span>*(<span class="mxinfo" id="T1:U597"><span class="mxinfo" id="T1:U598"><span class="mxinfo" id="T1:U599"><span class="mxinfo" id="T1:U600"><span class="var type1" id="S14T9U722">qwp</span>(<span class="mxinfo" id="T1:U602">2</span>)</span>*<span class="var type1" id="S24T1U724">X</span></span> + <span class="mxinfo" id="T1:U604"><span class="mxinfo" id="T1:U605"><span class="var type1" id="S14T9U727">qwp</span>(<span class="mxinfo" id="T1:U607">3</span>)</span>*<span class="var type1" id="S25T1U729">Y</span></span></span> + <span class="mxinfo" id="T1:U609"><span class="mxinfo" id="T1:U610"><span class="var type1" id="S14T9U732">qwp</span>(<span class="mxinfo" id="T1:U612">4</span>)</span>*<span class="var type1" id="S26T1U734">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U614"><span class="mxinfo" id="T1:U615">2</span>*(<span class="mxinfo" id="T1:U616"><span class="mxinfo" id="T1:U617"><span class="mxinfo" id="T1:U618"><span class="mxinfo" id="T1:U619"><span class="var type1" id="S14T9U742">qwp</span>(<span class="mxinfo" id="T1:U621">1</span>)</span>*<span class="var type1" id="S24T1U744">X</span></span> - <span class="mxinfo" id="T1:U623"><span class="mxinfo" id="T1:U624"><span class="var type1" id="S14T9U747">qwp</span>(<span class="mxinfo" id="T1:U626">4</span>)</span>*<span class="var type1" id="S25T1U749">Y</span></span></span> + <span class="mxinfo" id="T1:U628"><span class="mxinfo" id="T1:U629"><span class="var type1" id="S14T9U752">qwp</span>(<span class="mxinfo" id="T1:U631">3</span>)</span>*<span class="var type1" id="S26T1U754">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">            <span class="mxinfo" id="T18:U633"><span class="var type1" id="S38T18U757">dB3_q</span> = <span class="mxinfo" id="T18:U635">[<span class="mxinfo" id="T1:U636"><span class="mxinfo" id="T1:U637">2</span>*(<span class="mxinfo" id="T1:U638"><span class="mxinfo" id="T1:U639"><span class="mxinfo" id="T1:U640"><span class="mxinfo" id="T1:U641">-<span class="mxinfo" id="T1:U642"><span class="var type1" id="S14T9U768">qwp</span>(<span class="mxinfo" id="T1:U644">3</span>)</span></span>*<span class="var type1" id="S24T1U770">X</span></span> + <span class="mxinfo" id="T1:U646"><span class="mxinfo" id="T1:U647"><span class="var type1" id="S14T9U773">qwp</span>(<span class="mxinfo" id="T1:U649">2</span>)</span>*<span class="var type1" id="S25T1U775">Y</span></span></span> + <span class="mxinfo" id="T1:U651"><span class="mxinfo" id="T1:U652"><span class="var type1" id="S14T9U778">qwp</span>(<span class="mxinfo" id="T1:U654">1</span>)</span>*<span class="var type1" id="S26T1U780">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U656"><span class="mxinfo" id="T1:U657">2</span>*(<span class="mxinfo" id="T1:U658"><span class="mxinfo" id="T1:U659"><span class="mxinfo" id="T1:U660"><span class="mxinfo" id="T1:U661"><span class="var type1" id="S14T9U788">qwp</span>(<span class="mxinfo" id="T1:U663">4</span>)</span>*<span class="var type1" id="S24T1U790">X</span></span> + <span class="mxinfo" id="T1:U665"><span class="mxinfo" id="T1:U666"><span class="var type1" id="S14T9U793">qwp</span>(<span class="mxinfo" id="T1:U668">1</span>)</span>*<span class="var type1" id="S25T1U795">Y</span></span></span> - <span class="mxinfo" id="T1:U670"><span class="mxinfo" id="T1:U671"><span class="var type1" id="S14T9U798">qwp</span>(<span class="mxinfo" id="T1:U673">2</span>)</span>*<span class="var type1" id="S26T1U800">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="mxinfo" id="T18:U633"><span class="mxinfo" id="T18:U635">                    <span class="mxinfo" id="T1:U675"><span class="mxinfo" id="T1:U676">2</span>*(<span class="mxinfo" id="T1:U677"><span class="mxinfo" id="T1:U678"><span class="mxinfo" id="T1:U679"><span class="mxinfo" id="T1:U680">-<span class="mxinfo" id="T1:U681"><span class="var type1" id="S14T9U809">qwp</span>(<span class="mxinfo" id="T1:U683">1</span>)</span></span>*<span class="var type1" id="S24T1U811">X</span></span> + <span class="mxinfo" id="T1:U685"><span class="mxinfo" id="T1:U686"><span class="var type1" id="S14T9U814">qwp</span>(<span class="mxinfo" id="T1:U688">4</span>)</span>*<span class="var type1" id="S25T1U816">Y</span></span></span> - <span class="mxinfo" id="T1:U690"><span class="mxinfo" id="T1:U691"><span class="var type1" id="S14T9U819">qwp</span>(<span class="mxinfo" id="T1:U693">3</span>)</span>*<span class="var type1" id="S26T1U821">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U695"><span class="mxinfo" id="T1:U696">2</span>*(<span class="mxinfo" id="T1:U697"><span class="mxinfo" id="T1:U698"><span class="mxinfo" id="T1:U699"><span class="mxinfo" id="T1:U700"><span class="var type1" id="S14T9U829">qwp</span>(<span class="mxinfo" id="T1:U702">2</span>)</span>*<span class="var type1" id="S24T1U831">X</span></span> + <span class="mxinfo" id="T1:U704"><span class="mxinfo" id="T1:U705"><span class="var type1" id="S14T9U834">qwp</span>(<span class="mxinfo" id="T1:U707">3</span>)</span>*<span class="var type1" id="S25T1U836">Y</span></span></span> + <span class="mxinfo" id="T1:U709"><span class="mxinfo" id="T1:U710"><span class="var type1" id="S14T9U839">qwp</span>(<span class="mxinfo" id="T1:U712">4</span>)</span>*<span class="var type1" id="S26T1U841">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">            <span class="mxinfo" id="T19:U714"><span class="var type1" id="S39T19U844">dB1_x</span> = <span class="mxinfo" id="T19:U716">[<span class="mxinfo" id="T1:U717">1</span> <span class="mxinfo" id="T1:U718">0</span> <span class="mxinfo" id="T1:U719">0</span> <span class="var type1" id="S35T17U850">dB_zeros</span> <span class="var type1" id="S36T18U851">dB1_q</span> <span class="var type1" id="S35T17U852">dB_zeros</span> <span class="var type1" id="S35T17U853">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">            <span class="mxinfo" id="T19:U724"><span class="var type1" id="S40T19U856">dB2_x</span> = <span class="mxinfo" id="T19:U726">[<span class="mxinfo" id="T1:U727">0</span> <span class="mxinfo" id="T1:U728">1</span> <span class="mxinfo" id="T1:U729">0</span> <span class="var type1" id="S35T17U862">dB_zeros</span> <span class="var type1" id="S37T18U863">dB2_q</span> <span class="var type1" id="S35T17U864">dB_zeros</span> <span class="var type1" id="S35T17U865">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">            <span class="mxinfo" id="T19:U734"><span class="var type1" id="S41T19U868">dB3_x</span> = <span class="mxinfo" id="T19:U736">[<span class="mxinfo" id="T1:U737">0</span> <span class="mxinfo" id="T1:U738">0</span> <span class="mxinfo" id="T1:U739">1</span> <span class="var type1" id="S35T17U874">dB_zeros</span> <span class="var type1" id="S38T18U875">dB3_q</span> <span class="var type1" id="S35T17U876">dB_zeros</span> <span class="var type1" id="S35T17U877">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">            <span class="mxinfo" id="T19:U744"><span class="var type1" id="S42T19U880">au_prime</span> = <span class="mxinfo" id="T19:U746"><span class="mxinfo" id="T19:U747"><span class="mxinfo" id="T19:U748"><span class="mxinfo" id="T1:U749"><span class="var type1" id="S23T5U885">K</span>(<span class="mxinfo" id="T1:U751">1</span>,<span class="mxinfo" id="T1:U752">1</span>)</span>*<span class="var type1" id="S39T19U888">dB1_x</span></span> + <span class="mxinfo" id="T19:U754"><span class="mxinfo" id="T1:U755"><span class="var type1" id="S23T5U891">K</span>(<span class="mxinfo" id="T1:U757">1</span>,<span class="mxinfo" id="T1:U758">2</span>)</span>*<span class="var type1" id="S40T19U894">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U760"><span class="mxinfo" id="T1:U761"><span class="var type1" id="S23T5U897">K</span>(<span class="mxinfo" id="T1:U763">1</span>,<span class="mxinfo" id="T1:U764">3</span>)</span>*<span class="var type1" id="S41T19U900">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">            <span class="mxinfo" id="T19:U766"><span class="var type1" id="S43T19U903">av_prime</span> = <span class="mxinfo" id="T19:U768"><span class="mxinfo" id="T19:U769"><span class="mxinfo" id="T19:U770"><span class="mxinfo" id="T1:U771"><span class="var type1" id="S23T5U908">K</span>(<span class="mxinfo" id="T1:U773">2</span>,<span class="mxinfo" id="T1:U774">1</span>)</span>*<span class="var type1" id="S39T19U911">dB1_x</span></span> + <span class="mxinfo" id="T19:U776"><span class="mxinfo" id="T1:U777"><span class="var type1" id="S23T5U914">K</span>(<span class="mxinfo" id="T1:U779">2</span>,<span class="mxinfo" id="T1:U780">2</span>)</span>*<span class="var type1" id="S40T19U917">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U782"><span class="mxinfo" id="T1:U783"><span class="var type1" id="S23T5U920">K</span>(<span class="mxinfo" id="T1:U785">2</span>,<span class="mxinfo" id="T1:U786">3</span>)</span>*<span class="var type1" id="S41T19U923">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">            <span class="mxinfo" id="T19:U788"><span class="var type1" id="S44T19U926">b_prime</span> = <span class="mxinfo" id="T19:U790"><span class="mxinfo" id="T19:U791"><span class="mxinfo" id="T19:U792"><span class="mxinfo" id="T1:U793"><span class="var type1" id="S23T5U931">K</span>(<span class="mxinfo" id="T1:U795">3</span>,<span class="mxinfo" id="T1:U796">1</span>)</span>*<span class="var type1" id="S39T19U934">dB1_x</span></span> + <span class="mxinfo" id="T19:U798"><span class="mxinfo" id="T1:U799"><span class="var type1" id="S23T5U937">K</span>(<span class="mxinfo" id="T1:U801">3</span>,<span class="mxinfo" id="T1:U802">2</span>)</span>*<span class="var type1" id="S40T19U940">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U804"><span class="mxinfo" id="T1:U805"><span class="var type1" id="S23T5U943">K</span>(<span class="mxinfo" id="T1:U807">3</span>,<span class="mxinfo" id="T1:U808">3</span>)</span>*<span class="var type1" id="S41T19U946">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">            <span class="mxinfo" id="T19:U810"><span class="var type1" id="S45T19U949">bu_prime</span> = <span class="var type1" id="S44T19U950">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">            <span class="mxinfo" id="T19:U813"><span class="var type1" id="S46T19U953">bv_prime</span> = <span class="var type1" id="S44T19U954">b_prime</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">            <span class="mxinfo" id="T1:U816"><span class="var type1" id="S47T1U957">b_sq</span> = <span class="mxinfo" id="T1:U818"><span class="var type1" id="S30T1U959">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">            <span class="mxinfo" id="T19:U820"><span class="var type1" id="S48T19U963">du_dx</span> = <span class="mxinfo" id="T19:U822">(<span class="mxinfo" id="T19:U823"><span class="mxinfo" id="T19:U824"><span class="var type1" id="S42T19U968">au_prime</span>*<span class="var type1" id="S31T1U969">bu</span></span> - <span class="mxinfo" id="T19:U827"><span class="var type1" id="S33T1U971">au</span>*<span class="var type1" id="S45T19U972">bu_prime</span></span></span>)/<span class="var type1" id="S47T1U973">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">            <span class="mxinfo" id="T19:U831"><span class="var type1" id="S49T19U976">dv_dx</span> = <span class="mxinfo" id="T19:U833">(<span class="mxinfo" id="T19:U834"><span class="mxinfo" id="T19:U835"><span class="var type1" id="S43T19U981">av_prime</span>*<span class="var type1" id="S32T1U982">bv</span></span> - <span class="mxinfo" id="T19:U838"><span class="var type1" id="S34T1U984">av</span>*<span class="var type1" id="S46T19U985">bv_prime</span></span></span>)/<span class="var type1" id="S47T1U986">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">            <span class="mxinfo" id="T54:U842"><span class="mxinfo" id="T54:U843"><span class="var type1" id="S11T20U990">H</span>(<span class="mxinfo" id="T16:U845"><span class="var type1" id="S17T1U992">k</span>:<span class="mxinfo" id="T1:U847"><span class="var type1" id="S17T1U994">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T54:U849">[<span class="var type1" id="S48T19U999">du_dx</span>;<span class="var type1" id="S49T19U1001">dv_dx</span>]</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">            <span class="mxinfo" id="T1:U852"><span class="mxinfo" id="T1:U853"><span class="var type1" id="S16T34U1005">z_meas</span>(<span class="var type1" id="S17T1U1006">k</span>,<span class="mxinfo" id="T1:U856">1</span>)</span> = <span class="mxinfo" id="T1:U857"><span class="mxinfo" id="T3:U858"><span class="mxinfo" id="T53:U859"><span class="var type1" id="S5T2U1011">z</span>(<span class="mxinfo" id="T1:U861">1</span>,<span class="var type1" id="S10T1U1013">i</span>)</span>.red_data</span>(<span class="mxinfo" id="T1:U863">1</span>,<span class="mxinfo" id="T1:U864">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">            <span class="mxinfo" id="T1:U865"><span class="mxinfo" id="T1:U866"><span class="var type1" id="S16T34U1020">z_meas</span>(<span class="mxinfo" id="T1:U868"><span class="var type1" id="S17T1U1022">k</span>+<span class="mxinfo" id="T1:U870">1</span></span>,<span class="mxinfo" id="T1:U871">1</span>)</span> = <span class="mxinfo" id="T1:U872"><span class="mxinfo" id="T3:U873"><span class="mxinfo" id="T53:U874"><span class="var type1" id="S5T2U1028">z</span>(<span class="mxinfo" id="T1:U876">1</span>,<span class="var type1" id="S10T1U1030">i</span>)</span>.red_data</span>(<span class="mxinfo" id="T1:U878">1</span>,<span class="mxinfo" id="T1:U879">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">            <span class="mxinfo" id="T1:U880"><span class="var type1" id="S17T1U1036">k</span> = <span class="mxinfo" id="T1:U882"><span class="var type1" id="S17T1U1038">k</span> + <span class="mxinfo" id="T1:U884">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">        <span class="comment">% green blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U885"><span class="mxinfo" id="T1:U886"><span class="mxinfo" id="T53:U887"><span class="var type1" id="S5T2U1046">z</span>(<span class="mxinfo" id="T1:U889">1</span>,<span class="var type1" id="S10T1U1048">i</span>)</span>.number_green</span> == <span class="mxinfo" id="T1:U891">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">            <span class="comment">% do measurement estimation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="mxinfo" id="T5:U892"><span class="var type1" id="S18T5U1053">A</span> = <span class="mxinfo" id="T5:U894"><span class="mxinfo" id="T5:U895"><span class="mxinfo" id="T4:U896"><span class="mxinfo" id="T53:U897"><span class="var type1" id="S5T2U1058">z</span>(<span class="mxinfo" id="T1:U899">1</span>,<span class="var type1" id="S10T1U1060">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*<span class="mxinfo" id="T1:U901">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">            <span class="mxinfo" id="T5:U902"><span class="var type1" id="S19T5U1066">Rcw</span> = <span class="mxinfo" id="T5:U904"><span class="mxinfo" id="T4:U905"><span class="mxinfo" id="T53:U906"><span class="var type1" id="S5T2U1070">z</span>(<span class="mxinfo" id="T1:U908">1</span>,<span class="var type1" id="S10T1U1072">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">            <span class="mxinfo" id="T6:U910"><span class="var type1" id="S20T6U1077">Tcw</span> = <span class="mxinfo" id="T6:U912"><span class="mxinfo" id="T6:U913"><span class="mxinfo" id="T4:U914"><span class="mxinfo" id="T53:U915"><span class="var type1" id="S5T2U1082">z</span>(<span class="mxinfo" id="T1:U917">1</span>,<span class="var type1" id="S10T1U1084">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U919">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">            <span class="mxinfo" id="T16:U920"><span class="var type1" id="S21T16U1090">u</span> = <span class="mxinfo" id="T16:U922"><span class="fcn" id="F55N4:B1092">project2_2D</span>(<span class="var type1" id="S18T5U1093">A</span>,<span class="var type1" id="S19T5U1094">Rcw</span>,<span class="var type1" id="S20T6U1095">Tcw</span>,<span class="var type1" id="S13T6U1096">Twp</span>,<span class="var type1" id="S14T9U1097">qwp</span>,<span class="mxinfo" id="T6:U928"><span class="mxinfo" id="T6:U929"><span class="var type1" id="S7T5U1100">object_points</span>(:,<span class="mxinfo" id="T1:U931">2</span>)</span>/<span class="mxinfo" id="T1:U932">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">            <span class="mxinfo" id="T16:U933"><span class="mxinfo" id="T16:U934"><span class="var type1" id="S15T34U1107">z_est</span>(<span class="mxinfo" id="T16:U936"><span class="var type1" id="S17T1U1109">k</span>:<span class="mxinfo" id="T1:U938"><span class="var type1" id="S17T1U1111">k</span>+1</span></span>,<span class="mxinfo" id="T1:U940">1</span>)</span> = <span class="var type1" id="S21T16U1114">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            <span class="comment">% do jacobian calc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="mxinfo" id="T5:U942"><span class="var type1" id="S23T5U1117">K</span> = <span class="mxinfo" id="T5:U944"><span class="var type1" id="S18T5U1119">A</span>*<span class="var type1" id="S19T5U1120">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="mxinfo" id="T1:U947"><span class="var type1" id="S24T1U1123">X</span> = <span class="mxinfo" id="T1:U949"><span class="mxinfo" id="T1:U950"><span class="var type1" id="S7T5U1126">object_points</span>(<span class="mxinfo" id="T1:U952">1</span>,<span class="mxinfo" id="T1:U953">2</span>)</span>/<span class="mxinfo" id="T1:U954">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">            <span class="mxinfo" id="T1:U955"><span class="var type1" id="S25T1U1132">Y</span> = <span class="mxinfo" id="T1:U957"><span class="mxinfo" id="T1:U958"><span class="var type1" id="S7T5U1135">object_points</span>(<span class="mxinfo" id="T1:U960">2</span>,<span class="mxinfo" id="T1:U961">2</span>)</span>/<span class="mxinfo" id="T1:U962">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="mxinfo" id="T1:U963"><span class="var type1" id="S26T1U1141">Z</span> = <span class="mxinfo" id="T1:U965"><span class="mxinfo" id="T1:U966"><span class="var type1" id="S7T5U1144">object_points</span>(<span class="mxinfo" id="T1:U968">3</span>,<span class="mxinfo" id="T1:U969">2</span>)</span>/<span class="mxinfo" id="T1:U970">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="mxinfo" id="T1:U971"><span class="var type1" id="S27T1U1150">B1</span> = <span class="mxinfo" id="T1:U973"><span class="mxinfo" id="T1:U974"><span class="mxinfo" id="T1:U975"><span class="mxinfo" id="T1:U976"><span class="mxinfo" id="T1:U977">(<span class="mxinfo" id="T1:U978"><span class="mxinfo" id="T1:U979"><span class="mxinfo" id="T1:U980"><span class="mxinfo" id="T1:U981"><span class="mxinfo" id="T1:U982"><span class="var type1" id="S14T9U1162">qwp</span>(<span class="mxinfo" id="T1:U984">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U985"><span class="mxinfo" id="T1:U986"><span class="var type1" id="S14T9U1167">qwp</span>(<span class="mxinfo" id="T1:U988">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U989"><span class="mxinfo" id="T1:U990"><span class="var type1" id="S14T9U1172">qwp</span>(<span class="mxinfo" id="T1:U992">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U993"><span class="mxinfo" id="T1:U994"><span class="var type1" id="S14T9U1177">qwp</span>(<span class="mxinfo" id="T1:U996">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U1180">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"><span class="mxinfo" id="T1:U971"><span class="mxinfo" id="T1:U973"><span class="mxinfo" id="T1:U974"><span class="mxinfo" id="T1:U975"><span class="mxinfo" id="T1:U976">                <span class="mxinfo" id="T1:U998"><span class="mxinfo" id="T1:U999"><span class="mxinfo" id="T1:U1000">+ 2</span>*(<span class="mxinfo" id="T1:U1001"><span class="mxinfo" id="T1:U1002"><span class="mxinfo" id="T1:U1003"><span class="var type1" id="S14T9U1189">qwp</span>(<span class="mxinfo" id="T1:U1005">2</span>)</span>*<span class="mxinfo" id="T1:U1006"><span class="var type1" id="S14T9U1192">qwp</span>(<span class="mxinfo" id="T1:U1008">3</span>)</span></span> - <span class="mxinfo" id="T1:U1009"><span class="mxinfo" id="T1:U1010"><span class="var type1" id="S14T9U1196">qwp</span>(<span class="mxinfo" id="T1:U1012">1</span>)</span>*<span class="mxinfo" id="T1:U1013"><span class="var type1" id="S14T9U1199">qwp</span>(<span class="mxinfo" id="T1:U1015">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1201">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="mxinfo" id="T1:U971"><span class="mxinfo" id="T1:U973"><span class="mxinfo" id="T1:U974"><span class="mxinfo" id="T1:U975">                <span class="mxinfo" id="T1:U1017"><span class="mxinfo" id="T1:U1018"><span class="mxinfo" id="T1:U1019">+ 2</span>*(<span class="mxinfo" id="T1:U1020"><span class="mxinfo" id="T1:U1021"><span class="mxinfo" id="T1:U1022"><span class="var type1" id="S14T9U1210">qwp</span>(<span class="mxinfo" id="T1:U1024">2</span>)</span>*<span class="mxinfo" id="T1:U1025"><span class="var type1" id="S14T9U1213">qwp</span>(<span class="mxinfo" id="T1:U1027">4</span>)</span></span> + <span class="mxinfo" id="T1:U1028"><span class="mxinfo" id="T1:U1029"><span class="var type1" id="S14T9U1217">qwp</span>(<span class="mxinfo" id="T1:U1031">1</span>)</span>*<span class="mxinfo" id="T1:U1032"><span class="var type1" id="S14T9U1220">qwp</span>(<span class="mxinfo" id="T1:U1034">3</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U1222">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T1:U971"><span class="mxinfo" id="T1:U973"><span class="mxinfo" id="T1:U974">                + <span class="mxinfo" id="T1:U1036"><span class="var type1" id="S13T6U1225">Twp</span>(<span class="mxinfo" id="T1:U1038">1</span>)</span></span> - <span class="mxinfo" id="T1:U1039"><span class="mxinfo" id="T1:U1040"><span class="mxinfo" id="T6:U1041"><span class="mxinfo" id="T4:U1042"><span class="mxinfo" id="T53:U1043"><span class="var type1" id="S5T2U1232">z</span>(<span class="mxinfo" id="T1:U1045">1</span>,<span class="var type1" id="S10T1U1234">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1047">1</span>)</span>/<span class="mxinfo" id="T1:U1048">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">            <span class="mxinfo" id="T1:U1049"><span class="var type1" id="S28T1U1241">B2</span> = <span class="mxinfo" id="T1:U1051"><span class="mxinfo" id="T1:U1052"><span class="mxinfo" id="T1:U1053"><span class="mxinfo" id="T1:U1054"><span class="mxinfo" id="T1:U1055"><span class="mxinfo" id="T1:U1056"><span class="mxinfo" id="T1:U1057">2</span>*(<span class="mxinfo" id="T1:U1058"><span class="mxinfo" id="T1:U1059"><span class="mxinfo" id="T1:U1060"><span class="var type1" id="S14T9U1253">qwp</span>(<span class="mxinfo" id="T1:U1062">2</span>)</span>*<span class="mxinfo" id="T1:U1063"><span class="var type1" id="S14T9U1256">qwp</span>(<span class="mxinfo" id="T1:U1065">3</span>)</span></span> + <span class="mxinfo" id="T1:U1066"><span class="mxinfo" id="T1:U1067"><span class="var type1" id="S14T9U1260">qwp</span>(<span class="mxinfo" id="T1:U1069">1</span>)</span>*<span class="mxinfo" id="T1:U1070"><span class="var type1" id="S14T9U1263">qwp</span>(<span class="mxinfo" id="T1:U1072">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1265">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line"><span class="mxinfo" id="T1:U1049"><span class="mxinfo" id="T1:U1051"><span class="mxinfo" id="T1:U1052"><span class="mxinfo" id="T1:U1053"><span class="mxinfo" id="T1:U1054">                <span class="mxinfo" id="T1:U1074">+ (<span class="mxinfo" id="T1:U1075"><span class="mxinfo" id="T1:U1076"><span class="mxinfo" id="T1:U1077"><span class="mxinfo" id="T1:U1078"><span class="mxinfo" id="T1:U1079"><span class="var type1" id="S14T9U1274">qwp</span>(<span class="mxinfo" id="T1:U1081">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U1082"><span class="mxinfo" id="T1:U1083"><span class="var type1" id="S14T9U1279">qwp</span>(<span class="mxinfo" id="T1:U1085">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U1086"><span class="mxinfo" id="T1:U1087"><span class="var type1" id="S14T9U1284">qwp</span>(<span class="mxinfo" id="T1:U1089">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1090"><span class="mxinfo" id="T1:U1091"><span class="var type1" id="S14T9U1289">qwp</span>(<span class="mxinfo" id="T1:U1093">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U1292">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"><span class="mxinfo" id="T1:U1049"><span class="mxinfo" id="T1:U1051"><span class="mxinfo" id="T1:U1052"><span class="mxinfo" id="T1:U1053">                <span class="mxinfo" id="T1:U1095"><span class="mxinfo" id="T1:U1096"><span class="mxinfo" id="T1:U1097">+ 2</span>*(<span class="mxinfo" id="T1:U1098"><span class="mxinfo" id="T1:U1099"><span class="mxinfo" id="T1:U1100"><span class="var type1" id="S14T9U1301">qwp</span>(<span class="mxinfo" id="T1:U1102">3</span>)</span>*<span class="mxinfo" id="T1:U1103"><span class="var type1" id="S14T9U1304">qwp</span>(<span class="mxinfo" id="T1:U1105">4</span>)</span></span> - <span class="mxinfo" id="T1:U1106"><span class="mxinfo" id="T1:U1107"><span class="var type1" id="S14T9U1308">qwp</span>(<span class="mxinfo" id="T1:U1109">1</span>)</span>*<span class="mxinfo" id="T1:U1110"><span class="var type1" id="S14T9U1311">qwp</span>(<span class="mxinfo" id="T1:U1112">2</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U1313">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="mxinfo" id="T1:U1049"><span class="mxinfo" id="T1:U1051"><span class="mxinfo" id="T1:U1052">                + <span class="mxinfo" id="T1:U1114"><span class="var type1" id="S13T6U1316">Twp</span>(<span class="mxinfo" id="T1:U1116">2</span>)</span></span> - <span class="mxinfo" id="T1:U1117"><span class="mxinfo" id="T1:U1118"><span class="mxinfo" id="T6:U1119"><span class="mxinfo" id="T4:U1120"><span class="mxinfo" id="T53:U1121"><span class="var type1" id="S5T2U1323">z</span>(<span class="mxinfo" id="T1:U1123">1</span>,<span class="var type1" id="S10T1U1325">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1125">2</span>)</span>/<span class="mxinfo" id="T1:U1126">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">            <span class="mxinfo" id="T1:U1127"><span class="var type1" id="S29T1U1332">B3</span> = <span class="mxinfo" id="T1:U1129"><span class="mxinfo" id="T1:U1130"><span class="mxinfo" id="T1:U1131"><span class="mxinfo" id="T1:U1132"><span class="mxinfo" id="T1:U1133"><span class="mxinfo" id="T1:U1134"><span class="mxinfo" id="T1:U1135">2</span>*(<span class="mxinfo" id="T1:U1136"><span class="mxinfo" id="T1:U1137"><span class="mxinfo" id="T1:U1138"><span class="var type1" id="S14T9U1344">qwp</span>(<span class="mxinfo" id="T1:U1140">2</span>)</span>*<span class="mxinfo" id="T1:U1141"><span class="var type1" id="S14T9U1347">qwp</span>(<span class="mxinfo" id="T1:U1143">4</span>)</span></span> - <span class="mxinfo" id="T1:U1144"><span class="mxinfo" id="T1:U1145"><span class="var type1" id="S14T9U1351">qwp</span>(<span class="mxinfo" id="T1:U1147">1</span>)</span>*<span class="mxinfo" id="T1:U1148"><span class="var type1" id="S14T9U1354">qwp</span>(<span class="mxinfo" id="T1:U1150">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1356">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo" id="T1:U1127"><span class="mxinfo" id="T1:U1129"><span class="mxinfo" id="T1:U1130"><span class="mxinfo" id="T1:U1131"><span class="mxinfo" id="T1:U1132">                <span class="mxinfo" id="T1:U1152"><span class="mxinfo" id="T1:U1153"><span class="mxinfo" id="T1:U1154">+ 2</span>*(<span class="mxinfo" id="T1:U1155"><span class="mxinfo" id="T1:U1156"><span class="mxinfo" id="T1:U1157"><span class="var type1" id="S14T9U1365">qwp</span>(<span class="mxinfo" id="T1:U1159">3</span>)</span>*<span class="mxinfo" id="T1:U1160"><span class="var type1" id="S14T9U1368">qwp</span>(<span class="mxinfo" id="T1:U1162">4</span>)</span></span> + <span class="mxinfo" id="T1:U1163"><span class="mxinfo" id="T1:U1164"><span class="var type1" id="S14T9U1372">qwp</span>(<span class="mxinfo" id="T1:U1166">1</span>)</span>*<span class="mxinfo" id="T1:U1167"><span class="var type1" id="S14T9U1375">qwp</span>(<span class="mxinfo" id="T1:U1169">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1377">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line"><span class="mxinfo" id="T1:U1127"><span class="mxinfo" id="T1:U1129"><span class="mxinfo" id="T1:U1130"><span class="mxinfo" id="T1:U1131">                <span class="mxinfo" id="T1:U1171">+ (<span class="mxinfo" id="T1:U1172"><span class="mxinfo" id="T1:U1173"><span class="mxinfo" id="T1:U1174"><span class="mxinfo" id="T1:U1175"><span class="mxinfo" id="T1:U1176"><span class="var type1" id="S14T9U1386">qwp</span>(<span class="mxinfo" id="T1:U1178">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U1179"><span class="mxinfo" id="T1:U1180"><span class="var type1" id="S14T9U1391">qwp</span>(<span class="mxinfo" id="T1:U1182">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1183"><span class="mxinfo" id="T1:U1184"><span class="var type1" id="S14T9U1396">qwp</span>(<span class="mxinfo" id="T1:U1186">3</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U1187"><span class="mxinfo" id="T1:U1188"><span class="var type1" id="S14T9U1401">qwp</span>(<span class="mxinfo" id="T1:U1190">4</span>)</span>^2</span></span>)*<span class="var type1" id="S26T1U1404">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line"><span class="mxinfo" id="T1:U1127"><span class="mxinfo" id="T1:U1129"><span class="mxinfo" id="T1:U1130">                + <span class="mxinfo" id="T1:U1192"><span class="var type1" id="S13T6U1407">Twp</span>(<span class="mxinfo" id="T1:U1194">3</span>)</span></span> - <span class="mxinfo" id="T1:U1195"><span class="mxinfo" id="T1:U1196"><span class="mxinfo" id="T6:U1197"><span class="mxinfo" id="T4:U1198"><span class="mxinfo" id="T53:U1199"><span class="var type1" id="S5T2U1414">z</span>(<span class="mxinfo" id="T1:U1201">1</span>,<span class="var type1" id="S10T1U1416">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1203">3</span>)</span>/<span class="mxinfo" id="T1:U1204">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m            </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">            <span class="mxinfo" id="T1:U1205"><span class="var type1" id="S30T1U1423">b</span> = <span class="mxinfo" id="T1:U1207"><span class="mxinfo" id="T1:U1208"><span class="mxinfo" id="T1:U1209"><span class="mxinfo" id="T1:U1210"><span class="var type1" id="S23T5U1428">K</span>(<span class="mxinfo" id="T1:U1212">3</span>,<span class="mxinfo" id="T1:U1213">1</span>)</span>*<span class="var type1" id="S27T1U1431">B1</span></span> + <span class="mxinfo" id="T1:U1215"><span class="mxinfo" id="T1:U1216"><span class="var type1" id="S23T5U1434">K</span>(<span class="mxinfo" id="T1:U1218">3</span>,<span class="mxinfo" id="T1:U1219">2</span>)</span>*<span class="var type1" id="S28T1U1437">B2</span></span></span> + <span class="mxinfo" id="T1:U1221"><span class="mxinfo" id="T1:U1222"><span class="var type1" id="S23T5U1440">K</span>(<span class="mxinfo" id="T1:U1224">3</span>,<span class="mxinfo" id="T1:U1225">3</span>)</span>*<span class="var type1" id="S29T1U1443">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">            <span class="mxinfo" id="T1:U1227"><span class="var type1" id="S31T1U1446">bu</span> = <span class="var type1" id="S30T1U1447">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="mxinfo" id="T1:U1230"><span class="var type1" id="S32T1U1450">bv</span> = <span class="var type1" id="S30T1U1451">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">            <span class="mxinfo" id="T1:U1233"><span class="var type1" id="S33T1U1454">au</span> = <span class="mxinfo" id="T1:U1235"><span class="mxinfo" id="T1:U1236"><span class="mxinfo" id="T1:U1237"><span class="mxinfo" id="T1:U1238"><span class="var type1" id="S23T5U1459">K</span>(<span class="mxinfo" id="T1:U1240">1</span>,<span class="mxinfo" id="T1:U1241">1</span>)</span>*<span class="var type1" id="S27T1U1462">B1</span></span> + <span class="mxinfo" id="T1:U1243"><span class="mxinfo" id="T1:U1244"><span class="var type1" id="S23T5U1465">K</span>(<span class="mxinfo" id="T1:U1246">1</span>,<span class="mxinfo" id="T1:U1247">2</span>)</span>*<span class="var type1" id="S28T1U1468">B2</span></span></span> + <span class="mxinfo" id="T1:U1249"><span class="mxinfo" id="T1:U1250"><span class="var type1" id="S23T5U1471">K</span>(<span class="mxinfo" id="T1:U1252">1</span>,<span class="mxinfo" id="T1:U1253">3</span>)</span>*<span class="var type1" id="S29T1U1474">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">            <span class="mxinfo" id="T1:U1255"><span class="var type1" id="S34T1U1477">av</span> = <span class="mxinfo" id="T1:U1257"><span class="mxinfo" id="T1:U1258"><span class="mxinfo" id="T1:U1259"><span class="mxinfo" id="T1:U1260"><span class="var type1" id="S23T5U1482">K</span>(<span class="mxinfo" id="T1:U1262">2</span>,<span class="mxinfo" id="T1:U1263">1</span>)</span>*<span class="var type1" id="S27T1U1485">B1</span></span> + <span class="mxinfo" id="T1:U1265"><span class="mxinfo" id="T1:U1266"><span class="var type1" id="S23T5U1488">K</span>(<span class="mxinfo" id="T1:U1268">2</span>,<span class="mxinfo" id="T1:U1269">2</span>)</span>*<span class="var type1" id="S28T1U1491">B2</span></span></span> + <span class="mxinfo" id="T1:U1271"><span class="mxinfo" id="T1:U1272"><span class="var type1" id="S23T5U1494">K</span>(<span class="mxinfo" id="T1:U1274">2</span>,<span class="mxinfo" id="T1:U1275">3</span>)</span>*<span class="var type1" id="S29T1U1497">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">            <span class="mxinfo" id="T17:U1277"><span class="var type1" id="S35T17U1500">dB_zeros</span> = <span class="mxinfo" id="T17:U1279">[0 0 0]</span></span>;               </span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="mxinfo" id="T18:U1280"><span class="var type1" id="S36T18U1508">dB1_q</span> = <span class="mxinfo" id="T18:U1282">[<span class="mxinfo" id="T1:U1283"><span class="mxinfo" id="T1:U1284">2</span>*(<span class="mxinfo" id="T1:U1285"><span class="mxinfo" id="T1:U1286"><span class="mxinfo" id="T1:U1287"><span class="mxinfo" id="T1:U1288"><span class="var type1" id="S14T9U1518">qwp</span>(<span class="mxinfo" id="T1:U1290">1</span>)</span>*<span class="var type1" id="S24T1U1520">X</span></span> - <span class="mxinfo" id="T1:U1292"><span class="mxinfo" id="T1:U1293"><span class="var type1" id="S14T9U1523">qwp</span>(<span class="mxinfo" id="T1:U1295">4</span>)</span>*<span class="var type1" id="S25T1U1525">Y</span></span></span> + <span class="mxinfo" id="T1:U1297"><span class="mxinfo" id="T1:U1298"><span class="var type1" id="S14T9U1528">qwp</span>(<span class="mxinfo" id="T1:U1300">3</span>)</span>*<span class="var type1" id="S26T1U1530">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1302"><span class="mxinfo" id="T1:U1303">2</span>*(<span class="mxinfo" id="T1:U1304"><span class="mxinfo" id="T1:U1305"><span class="mxinfo" id="T1:U1306"><span class="mxinfo" id="T1:U1307"><span class="var type1" id="S14T9U1538">qwp</span>(<span class="mxinfo" id="T1:U1309">2</span>)</span>*<span class="var type1" id="S24T1U1540">X</span></span> + <span class="mxinfo" id="T1:U1311"><span class="mxinfo" id="T1:U1312"><span class="var type1" id="S14T9U1543">qwp</span>(<span class="mxinfo" id="T1:U1314">3</span>)</span>*<span class="var type1" id="S25T1U1545">Y</span></span></span> + <span class="mxinfo" id="T1:U1316"><span class="mxinfo" id="T1:U1317"><span class="var type1" id="S14T9U1548">qwp</span>(<span class="mxinfo" id="T1:U1319">4</span>)</span>*<span class="var type1" id="S26T1U1550">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"><span class="mxinfo" id="T18:U1280"><span class="mxinfo" id="T18:U1282">                    <span class="mxinfo" id="T1:U1321"><span class="mxinfo" id="T1:U1322">2</span>*(<span class="mxinfo" id="T1:U1323"><span class="mxinfo" id="T1:U1324"><span class="mxinfo" id="T1:U1325"><span class="mxinfo" id="T1:U1326">-<span class="mxinfo" id="T1:U1327"><span class="var type1" id="S14T9U1559">qwp</span>(<span class="mxinfo" id="T1:U1329">3</span>)</span></span>*<span class="var type1" id="S24T1U1561">X</span></span> + <span class="mxinfo" id="T1:U1331"><span class="mxinfo" id="T1:U1332"><span class="var type1" id="S14T9U1564">qwp</span>(<span class="mxinfo" id="T1:U1334">2</span>)</span>*<span class="var type1" id="S25T1U1566">Y</span></span></span> + <span class="mxinfo" id="T1:U1336"><span class="mxinfo" id="T1:U1337"><span class="var type1" id="S14T9U1569">qwp</span>(<span class="mxinfo" id="T1:U1339">1</span>)</span>*<span class="var type1" id="S26T1U1571">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1341"><span class="mxinfo" id="T1:U1342">2</span>*(<span class="mxinfo" id="T1:U1343"><span class="mxinfo" id="T1:U1344"><span class="mxinfo" id="T1:U1345"><span class="mxinfo" id="T1:U1346">-<span class="mxinfo" id="T1:U1347"><span class="var type1" id="S14T9U1580">qwp</span>(<span class="mxinfo" id="T1:U1349">4</span>)</span></span>*<span class="var type1" id="S24T1U1582">X</span></span> - <span class="mxinfo" id="T1:U1351"><span class="mxinfo" id="T1:U1352"><span class="var type1" id="S14T9U1585">qwp</span>(<span class="mxinfo" id="T1:U1354">1</span>)</span>*<span class="var type1" id="S25T1U1587">Y</span></span></span> + <span class="mxinfo" id="T1:U1356"><span class="mxinfo" id="T1:U1357"><span class="var type1" id="S14T9U1590">qwp</span>(<span class="mxinfo" id="T1:U1359">2</span>)</span>*<span class="var type1" id="S26T1U1592">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">            <span class="mxinfo" id="T18:U1361"><span class="var type1" id="S37T18U1595">dB2_q</span> = <span class="mxinfo" id="T18:U1363">[<span class="mxinfo" id="T1:U1364"><span class="mxinfo" id="T1:U1365">2</span>*(<span class="mxinfo" id="T1:U1366"><span class="mxinfo" id="T1:U1367"><span class="mxinfo" id="T1:U1368"><span class="mxinfo" id="T1:U1369"><span class="var type1" id="S14T9U1605">qwp</span>(<span class="mxinfo" id="T1:U1371">4</span>)</span>*<span class="var type1" id="S24T1U1607">X</span></span> + <span class="mxinfo" id="T1:U1373"><span class="mxinfo" id="T1:U1374"><span class="var type1" id="S14T9U1610">qwp</span>(<span class="mxinfo" id="T1:U1376">1</span>)</span>*<span class="var type1" id="S25T1U1612">Y</span></span></span> - <span class="mxinfo" id="T1:U1378"><span class="mxinfo" id="T1:U1379"><span class="var type1" id="S14T9U1615">qwp</span>(<span class="mxinfo" id="T1:U1381">2</span>)</span>*<span class="var type1" id="S26T1U1617">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1383"><span class="mxinfo" id="T1:U1384">2</span>*(<span class="mxinfo" id="T1:U1385"><span class="mxinfo" id="T1:U1386"><span class="mxinfo" id="T1:U1387"><span class="mxinfo" id="T1:U1388"><span class="var type1" id="S14T9U1625">qwp</span>(<span class="mxinfo" id="T1:U1390">3</span>)</span>*<span class="var type1" id="S24T1U1627">X</span></span> - <span class="mxinfo" id="T1:U1392"><span class="mxinfo" id="T1:U1393"><span class="var type1" id="S14T9U1630">qwp</span>(<span class="mxinfo" id="T1:U1395">2</span>)</span>*<span class="var type1" id="S25T1U1632">Y</span></span></span> - <span class="mxinfo" id="T1:U1397"><span class="mxinfo" id="T1:U1398"><span class="var type1" id="S14T9U1635">qwp</span>(<span class="mxinfo" id="T1:U1400">1</span>)</span>*<span class="var type1" id="S26T1U1637">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="mxinfo" id="T18:U1361"><span class="mxinfo" id="T18:U1363">                    <span class="mxinfo" id="T1:U1402"><span class="mxinfo" id="T1:U1403">2</span>*(<span class="mxinfo" id="T1:U1404"><span class="mxinfo" id="T1:U1405"><span class="mxinfo" id="T1:U1406"><span class="mxinfo" id="T1:U1407"><span class="var type1" id="S14T9U1645">qwp</span>(<span class="mxinfo" id="T1:U1409">2</span>)</span>*<span class="var type1" id="S24T1U1647">X</span></span> + <span class="mxinfo" id="T1:U1411"><span class="mxinfo" id="T1:U1412"><span class="var type1" id="S14T9U1650">qwp</span>(<span class="mxinfo" id="T1:U1414">3</span>)</span>*<span class="var type1" id="S25T1U1652">Y</span></span></span> + <span class="mxinfo" id="T1:U1416"><span class="mxinfo" id="T1:U1417"><span class="var type1" id="S14T9U1655">qwp</span>(<span class="mxinfo" id="T1:U1419">4</span>)</span>*<span class="var type1" id="S26T1U1657">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1421"><span class="mxinfo" id="T1:U1422">2</span>*(<span class="mxinfo" id="T1:U1423"><span class="mxinfo" id="T1:U1424"><span class="mxinfo" id="T1:U1425"><span class="mxinfo" id="T1:U1426"><span class="var type1" id="S14T9U1665">qwp</span>(<span class="mxinfo" id="T1:U1428">1</span>)</span>*<span class="var type1" id="S24T1U1667">X</span></span> - <span class="mxinfo" id="T1:U1430"><span class="mxinfo" id="T1:U1431"><span class="var type1" id="S14T9U1670">qwp</span>(<span class="mxinfo" id="T1:U1433">4</span>)</span>*<span class="var type1" id="S25T1U1672">Y</span></span></span> + <span class="mxinfo" id="T1:U1435"><span class="mxinfo" id="T1:U1436"><span class="var type1" id="S14T9U1675">qwp</span>(<span class="mxinfo" id="T1:U1438">3</span>)</span>*<span class="var type1" id="S26T1U1677">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">            <span class="mxinfo" id="T18:U1440"><span class="var type1" id="S38T18U1680">dB3_q</span> = <span class="mxinfo" id="T18:U1442">[<span class="mxinfo" id="T1:U1443"><span class="mxinfo" id="T1:U1444">2</span>*(<span class="mxinfo" id="T1:U1445"><span class="mxinfo" id="T1:U1446"><span class="mxinfo" id="T1:U1447"><span class="mxinfo" id="T1:U1448">-<span class="mxinfo" id="T1:U1449"><span class="var type1" id="S14T9U1691">qwp</span>(<span class="mxinfo" id="T1:U1451">3</span>)</span></span>*<span class="var type1" id="S24T1U1693">X</span></span> + <span class="mxinfo" id="T1:U1453"><span class="mxinfo" id="T1:U1454"><span class="var type1" id="S14T9U1696">qwp</span>(<span class="mxinfo" id="T1:U1456">2</span>)</span>*<span class="var type1" id="S25T1U1698">Y</span></span></span> + <span class="mxinfo" id="T1:U1458"><span class="mxinfo" id="T1:U1459"><span class="var type1" id="S14T9U1701">qwp</span>(<span class="mxinfo" id="T1:U1461">1</span>)</span>*<span class="var type1" id="S26T1U1703">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1463"><span class="mxinfo" id="T1:U1464">2</span>*(<span class="mxinfo" id="T1:U1465"><span class="mxinfo" id="T1:U1466"><span class="mxinfo" id="T1:U1467"><span class="mxinfo" id="T1:U1468"><span class="var type1" id="S14T9U1711">qwp</span>(<span class="mxinfo" id="T1:U1470">4</span>)</span>*<span class="var type1" id="S24T1U1713">X</span></span> + <span class="mxinfo" id="T1:U1472"><span class="mxinfo" id="T1:U1473"><span class="var type1" id="S14T9U1716">qwp</span>(<span class="mxinfo" id="T1:U1475">1</span>)</span>*<span class="var type1" id="S25T1U1718">Y</span></span></span> - <span class="mxinfo" id="T1:U1477"><span class="mxinfo" id="T1:U1478"><span class="var type1" id="S14T9U1721">qwp</span>(<span class="mxinfo" id="T1:U1480">2</span>)</span>*<span class="var type1" id="S26T1U1723">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="mxinfo" id="T18:U1440"><span class="mxinfo" id="T18:U1442">                    <span class="mxinfo" id="T1:U1482"><span class="mxinfo" id="T1:U1483">2</span>*(<span class="mxinfo" id="T1:U1484"><span class="mxinfo" id="T1:U1485"><span class="mxinfo" id="T1:U1486"><span class="mxinfo" id="T1:U1487">-<span class="mxinfo" id="T1:U1488"><span class="var type1" id="S14T9U1732">qwp</span>(<span class="mxinfo" id="T1:U1490">1</span>)</span></span>*<span class="var type1" id="S24T1U1734">X</span></span> + <span class="mxinfo" id="T1:U1492"><span class="mxinfo" id="T1:U1493"><span class="var type1" id="S14T9U1737">qwp</span>(<span class="mxinfo" id="T1:U1495">4</span>)</span>*<span class="var type1" id="S25T1U1739">Y</span></span></span> - <span class="mxinfo" id="T1:U1497"><span class="mxinfo" id="T1:U1498"><span class="var type1" id="S14T9U1742">qwp</span>(<span class="mxinfo" id="T1:U1500">3</span>)</span>*<span class="var type1" id="S26T1U1744">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U1502"><span class="mxinfo" id="T1:U1503">2</span>*(<span class="mxinfo" id="T1:U1504"><span class="mxinfo" id="T1:U1505"><span class="mxinfo" id="T1:U1506"><span class="mxinfo" id="T1:U1507"><span class="var type1" id="S14T9U1752">qwp</span>(<span class="mxinfo" id="T1:U1509">2</span>)</span>*<span class="var type1" id="S24T1U1754">X</span></span> + <span class="mxinfo" id="T1:U1511"><span class="mxinfo" id="T1:U1512"><span class="var type1" id="S14T9U1757">qwp</span>(<span class="mxinfo" id="T1:U1514">3</span>)</span>*<span class="var type1" id="S25T1U1759">Y</span></span></span> + <span class="mxinfo" id="T1:U1516"><span class="mxinfo" id="T1:U1517"><span class="var type1" id="S14T9U1762">qwp</span>(<span class="mxinfo" id="T1:U1519">4</span>)</span>*<span class="var type1" id="S26T1U1764">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">            <span class="mxinfo" id="T19:U1521"><span class="var type1" id="S39T19U1767">dB1_x</span> = <span class="mxinfo" id="T19:U1523">[<span class="mxinfo" id="T1:U1524">1</span> <span class="mxinfo" id="T1:U1525">0</span> <span class="mxinfo" id="T1:U1526">0</span> <span class="var type1" id="S35T17U1773">dB_zeros</span> <span class="var type1" id="S36T18U1774">dB1_q</span> <span class="var type1" id="S35T17U1775">dB_zeros</span> <span class="var type1" id="S35T17U1776">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">            <span class="mxinfo" id="T19:U1531"><span class="var type1" id="S40T19U1779">dB2_x</span> = <span class="mxinfo" id="T19:U1533">[<span class="mxinfo" id="T1:U1534">0</span> <span class="mxinfo" id="T1:U1535">1</span> <span class="mxinfo" id="T1:U1536">0</span> <span class="var type1" id="S35T17U1785">dB_zeros</span> <span class="var type1" id="S37T18U1786">dB2_q</span> <span class="var type1" id="S35T17U1787">dB_zeros</span> <span class="var type1" id="S35T17U1788">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">            <span class="mxinfo" id="T19:U1541"><span class="var type1" id="S41T19U1791">dB3_x</span> = <span class="mxinfo" id="T19:U1543">[<span class="mxinfo" id="T1:U1544">0</span> <span class="mxinfo" id="T1:U1545">0</span> <span class="mxinfo" id="T1:U1546">1</span> <span class="var type1" id="S35T17U1797">dB_zeros</span> <span class="var type1" id="S38T18U1798">dB3_q</span> <span class="var type1" id="S35T17U1799">dB_zeros</span> <span class="var type1" id="S35T17U1800">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">            <span class="mxinfo" id="T19:U1551"><span class="var type1" id="S42T19U1803">au_prime</span> = <span class="mxinfo" id="T19:U1553"><span class="mxinfo" id="T19:U1554"><span class="mxinfo" id="T19:U1555"><span class="mxinfo" id="T1:U1556"><span class="var type1" id="S23T5U1808">K</span>(<span class="mxinfo" id="T1:U1558">1</span>,<span class="mxinfo" id="T1:U1559">1</span>)</span>*<span class="var type1" id="S39T19U1811">dB1_x</span></span> + <span class="mxinfo" id="T19:U1561"><span class="mxinfo" id="T1:U1562"><span class="var type1" id="S23T5U1814">K</span>(<span class="mxinfo" id="T1:U1564">1</span>,<span class="mxinfo" id="T1:U1565">2</span>)</span>*<span class="var type1" id="S40T19U1817">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U1567"><span class="mxinfo" id="T1:U1568"><span class="var type1" id="S23T5U1820">K</span>(<span class="mxinfo" id="T1:U1570">1</span>,<span class="mxinfo" id="T1:U1571">3</span>)</span>*<span class="var type1" id="S41T19U1823">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">            <span class="mxinfo" id="T19:U1573"><span class="var type1" id="S43T19U1826">av_prime</span> = <span class="mxinfo" id="T19:U1575"><span class="mxinfo" id="T19:U1576"><span class="mxinfo" id="T19:U1577"><span class="mxinfo" id="T1:U1578"><span class="var type1" id="S23T5U1831">K</span>(<span class="mxinfo" id="T1:U1580">2</span>,<span class="mxinfo" id="T1:U1581">1</span>)</span>*<span class="var type1" id="S39T19U1834">dB1_x</span></span> + <span class="mxinfo" id="T19:U1583"><span class="mxinfo" id="T1:U1584"><span class="var type1" id="S23T5U1837">K</span>(<span class="mxinfo" id="T1:U1586">2</span>,<span class="mxinfo" id="T1:U1587">2</span>)</span>*<span class="var type1" id="S40T19U1840">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U1589"><span class="mxinfo" id="T1:U1590"><span class="var type1" id="S23T5U1843">K</span>(<span class="mxinfo" id="T1:U1592">2</span>,<span class="mxinfo" id="T1:U1593">3</span>)</span>*<span class="var type1" id="S41T19U1846">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            <span class="mxinfo" id="T19:U1595"><span class="var type1" id="S44T19U1849">b_prime</span> = <span class="mxinfo" id="T19:U1597"><span class="mxinfo" id="T19:U1598"><span class="mxinfo" id="T19:U1599"><span class="mxinfo" id="T1:U1600"><span class="var type1" id="S23T5U1854">K</span>(<span class="mxinfo" id="T1:U1602">3</span>,<span class="mxinfo" id="T1:U1603">1</span>)</span>*<span class="var type1" id="S39T19U1857">dB1_x</span></span> + <span class="mxinfo" id="T19:U1605"><span class="mxinfo" id="T1:U1606"><span class="var type1" id="S23T5U1860">K</span>(<span class="mxinfo" id="T1:U1608">3</span>,<span class="mxinfo" id="T1:U1609">2</span>)</span>*<span class="var type1" id="S40T19U1863">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U1611"><span class="mxinfo" id="T1:U1612"><span class="var type1" id="S23T5U1866">K</span>(<span class="mxinfo" id="T1:U1614">3</span>,<span class="mxinfo" id="T1:U1615">3</span>)</span>*<span class="var type1" id="S41T19U1869">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">            <span class="mxinfo" id="T19:U1617"><span class="var type1" id="S45T19U1872">bu_prime</span> = <span class="var type1" id="S44T19U1873">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">            <span class="mxinfo" id="T19:U1620"><span class="var type1" id="S46T19U1876">bv_prime</span> = <span class="var type1" id="S44T19U1877">b_prime</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">            <span class="mxinfo" id="T1:U1623"><span class="var type1" id="S47T1U1880">b_sq</span> = <span class="mxinfo" id="T1:U1625"><span class="var type1" id="S30T1U1882">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">            <span class="mxinfo" id="T19:U1627"><span class="var type1" id="S48T19U1886">du_dx</span> = <span class="mxinfo" id="T19:U1629">(<span class="mxinfo" id="T19:U1630"><span class="mxinfo" id="T19:U1631"><span class="var type1" id="S42T19U1891">au_prime</span>*<span class="var type1" id="S31T1U1892">bu</span></span> - <span class="mxinfo" id="T19:U1634"><span class="var type1" id="S33T1U1894">au</span>*<span class="var type1" id="S45T19U1895">bu_prime</span></span></span>)/<span class="var type1" id="S47T1U1896">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">            <span class="mxinfo" id="T19:U1638"><span class="var type1" id="S49T19U1899">dv_dx</span> = <span class="mxinfo" id="T19:U1640">(<span class="mxinfo" id="T19:U1641"><span class="mxinfo" id="T19:U1642"><span class="var type1" id="S43T19U1904">av_prime</span>*<span class="var type1" id="S32T1U1905">bv</span></span> - <span class="mxinfo" id="T19:U1645"><span class="var type1" id="S34T1U1907">av</span>*<span class="var type1" id="S46T19U1908">bv_prime</span></span></span>)/<span class="var type1" id="S47T1U1909">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">            <span class="mxinfo" id="T54:U1649"><span class="mxinfo" id="T54:U1650"><span class="var type1" id="S11T20U1913">H</span>(<span class="mxinfo" id="T16:U1652"><span class="var type1" id="S17T1U1915">k</span>:<span class="mxinfo" id="T1:U1654"><span class="var type1" id="S17T1U1917">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T54:U1656">[<span class="var type1" id="S48T19U1922">du_dx</span>;<span class="var type1" id="S49T19U1924">dv_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">            <span class="mxinfo" id="T1:U1659"><span class="mxinfo" id="T1:U1660"><span class="var type1" id="S16T34U1928">z_meas</span>(<span class="var type1" id="S17T1U1929">k</span>,<span class="mxinfo" id="T1:U1663">1</span>)</span> = <span class="mxinfo" id="T1:U1664"><span class="mxinfo" id="T3:U1665"><span class="mxinfo" id="T53:U1666"><span class="var type1" id="S5T2U1934">z</span>(<span class="mxinfo" id="T1:U1668">1</span>,<span class="var type1" id="S10T1U1936">i</span>)</span>.green_data</span>(<span class="mxinfo" id="T1:U1670">1</span>,<span class="mxinfo" id="T1:U1671">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">            <span class="mxinfo" id="T1:U1672"><span class="mxinfo" id="T1:U1673"><span class="var type1" id="S16T34U1943">z_meas</span>(<span class="mxinfo" id="T1:U1675"><span class="var type1" id="S17T1U1945">k</span>+<span class="mxinfo" id="T1:U1677">1</span></span>,<span class="mxinfo" id="T1:U1678">1</span>)</span> = <span class="mxinfo" id="T1:U1679"><span class="mxinfo" id="T3:U1680"><span class="mxinfo" id="T53:U1681"><span class="var type1" id="S5T2U1951">z</span>(<span class="mxinfo" id="T1:U1683">1</span>,<span class="var type1" id="S10T1U1953">i</span>)</span>.green_data</span>(<span class="mxinfo" id="T1:U1685">1</span>,<span class="mxinfo" id="T1:U1686">2</span>)</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">            <span class="mxinfo" id="T1:U1687"><span class="var type1" id="S17T1U1959">k</span> = <span class="mxinfo" id="T1:U1689"><span class="var type1" id="S17T1U1961">k</span> + <span class="mxinfo" id="T1:U1691">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">        <span class="comment">% blue blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T8:U1692"><span class="mxinfo" id="T1:U1693"><span class="mxinfo" id="T53:U1694"><span class="var type1" id="S5T2U1969">z</span>(<span class="mxinfo" id="T1:U1696">1</span>,<span class="var type1" id="S10T1U1971">i</span>)</span>.number_blue</span> == <span class="mxinfo" id="T1:U1698">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">            <span class="mxinfo" id="T5:U1699"><span class="var type1" id="S18T5U1976">A</span> = <span class="mxinfo" id="T5:U1701"><span class="mxinfo" id="T5:U1702"><span class="mxinfo" id="T4:U1703"><span class="mxinfo" id="T53:U1704"><span class="var type1" id="S5T2U1981">z</span>(<span class="mxinfo" id="T1:U1706">1</span>,<span class="var type1" id="S10T1U1983">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*<span class="mxinfo" id="T1:U1708">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">            <span class="mxinfo" id="T5:U1709"><span class="var type1" id="S19T5U1989">Rcw</span> = <span class="mxinfo" id="T5:U1711"><span class="mxinfo" id="T4:U1712"><span class="mxinfo" id="T53:U1713"><span class="var type1" id="S5T2U1993">z</span>(<span class="mxinfo" id="T1:U1715">1</span>,<span class="var type1" id="S10T1U1995">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">            <span class="mxinfo" id="T6:U1717"><span class="var type1" id="S20T6U2000">Tcw</span> = <span class="mxinfo" id="T6:U1719"><span class="mxinfo" id="T6:U1720"><span class="mxinfo" id="T4:U1721"><span class="mxinfo" id="T53:U1722"><span class="var type1" id="S5T2U2005">z</span>(<span class="mxinfo" id="T1:U1724">1</span>,<span class="var type1" id="S10T1U2007">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U1726">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">            <span class="mxinfo" id="T16:U1727"><span class="var type1" id="S21T16U2013">u</span> = <span class="mxinfo" id="T16:U1729"><span class="fcn" id="F55N4:B2015">project2_2D</span>(<span class="var type1" id="S18T5U2016">A</span>,<span class="var type1" id="S19T5U2017">Rcw</span>,<span class="var type1" id="S20T6U2018">Tcw</span>,<span class="var type1" id="S13T6U2019">Twp</span>,<span class="var type1" id="S14T9U2020">qwp</span>,<span class="mxinfo" id="T6:U1735"><span class="mxinfo" id="T6:U1736"><span class="var type1" id="S7T5U2023">object_points</span>(:,<span class="mxinfo" id="T1:U1738">3</span>)</span>/<span class="mxinfo" id="T1:U1739">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">            <span class="mxinfo" id="T16:U1740"><span class="mxinfo" id="T16:U1741"><span class="var type1" id="S15T34U2030">z_est</span>(<span class="mxinfo" id="T16:U1743"><span class="var type1" id="S17T1U2032">k</span>:<span class="mxinfo" id="T1:U1745"><span class="var type1" id="S17T1U2034">k</span>+1</span></span>,<span class="mxinfo" id="T1:U1747">1</span>)</span> = <span class="var type1" id="S21T16U2037">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">            <span class="mxinfo" id="T5:U1749"><span class="var type1" id="S23T5U2040">K</span> = <span class="mxinfo" id="T5:U1751"><span class="var type1" id="S18T5U2042">A</span>*<span class="var type1" id="S19T5U2043">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">            <span class="mxinfo" id="T1:U1754"><span class="var type1" id="S24T1U2046">X</span> = <span class="mxinfo" id="T1:U1756"><span class="mxinfo" id="T1:U1757"><span class="var type1" id="S7T5U2049">object_points</span>(<span class="mxinfo" id="T1:U1759">1</span>,<span class="mxinfo" id="T1:U1760">3</span>)</span>/<span class="mxinfo" id="T1:U1761">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">            <span class="mxinfo" id="T1:U1762"><span class="var type1" id="S25T1U2055">Y</span> = <span class="mxinfo" id="T1:U1764"><span class="mxinfo" id="T1:U1765"><span class="var type1" id="S7T5U2058">object_points</span>(<span class="mxinfo" id="T1:U1767">2</span>,<span class="mxinfo" id="T1:U1768">3</span>)</span>/<span class="mxinfo" id="T1:U1769">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">            <span class="mxinfo" id="T1:U1770"><span class="var type1" id="S26T1U2064">Z</span> = <span class="mxinfo" id="T1:U1772"><span class="mxinfo" id="T1:U1773"><span class="var type1" id="S7T5U2067">object_points</span>(<span class="mxinfo" id="T1:U1775">3</span>,<span class="mxinfo" id="T1:U1776">3</span>)</span>/<span class="mxinfo" id="T1:U1777">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">            <span class="mxinfo" id="T1:U1778"><span class="var type1" id="S27T1U2073">B1</span> = <span class="mxinfo" id="T1:U1780"><span class="mxinfo" id="T1:U1781"><span class="mxinfo" id="T1:U1782"><span class="mxinfo" id="T1:U1783"><span class="mxinfo" id="T1:U1784">(<span class="mxinfo" id="T1:U1785"><span class="mxinfo" id="T1:U1786"><span class="mxinfo" id="T1:U1787"><span class="mxinfo" id="T1:U1788"><span class="mxinfo" id="T1:U1789"><span class="var type1" id="S14T9U2085">qwp</span>(<span class="mxinfo" id="T1:U1791">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U1792"><span class="mxinfo" id="T1:U1793"><span class="var type1" id="S14T9U2090">qwp</span>(<span class="mxinfo" id="T1:U1795">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1796"><span class="mxinfo" id="T1:U1797"><span class="var type1" id="S14T9U2095">qwp</span>(<span class="mxinfo" id="T1:U1799">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1800"><span class="mxinfo" id="T1:U1801"><span class="var type1" id="S14T9U2100">qwp</span>(<span class="mxinfo" id="T1:U1803">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U2103">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="mxinfo" id="T1:U1778"><span class="mxinfo" id="T1:U1780"><span class="mxinfo" id="T1:U1781"><span class="mxinfo" id="T1:U1782"><span class="mxinfo" id="T1:U1783">                <span class="mxinfo" id="T1:U1805"><span class="mxinfo" id="T1:U1806"><span class="mxinfo" id="T1:U1807">+ 2</span>*(<span class="mxinfo" id="T1:U1808"><span class="mxinfo" id="T1:U1809"><span class="mxinfo" id="T1:U1810"><span class="var type1" id="S14T9U2112">qwp</span>(<span class="mxinfo" id="T1:U1812">2</span>)</span>*<span class="mxinfo" id="T1:U1813"><span class="var type1" id="S14T9U2115">qwp</span>(<span class="mxinfo" id="T1:U1815">3</span>)</span></span> - <span class="mxinfo" id="T1:U1816"><span class="mxinfo" id="T1:U1817"><span class="var type1" id="S14T9U2119">qwp</span>(<span class="mxinfo" id="T1:U1819">1</span>)</span>*<span class="mxinfo" id="T1:U1820"><span class="var type1" id="S14T9U2122">qwp</span>(<span class="mxinfo" id="T1:U1822">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U2124">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="mxinfo" id="T1:U1778"><span class="mxinfo" id="T1:U1780"><span class="mxinfo" id="T1:U1781"><span class="mxinfo" id="T1:U1782">                <span class="mxinfo" id="T1:U1824"><span class="mxinfo" id="T1:U1825"><span class="mxinfo" id="T1:U1826">+ 2</span>*(<span class="mxinfo" id="T1:U1827"><span class="mxinfo" id="T1:U1828"><span class="mxinfo" id="T1:U1829"><span class="var type1" id="S14T9U2133">qwp</span>(<span class="mxinfo" id="T1:U1831">2</span>)</span>*<span class="mxinfo" id="T1:U1832"><span class="var type1" id="S14T9U2136">qwp</span>(<span class="mxinfo" id="T1:U1834">4</span>)</span></span> + <span class="mxinfo" id="T1:U1835"><span class="mxinfo" id="T1:U1836"><span class="var type1" id="S14T9U2140">qwp</span>(<span class="mxinfo" id="T1:U1838">1</span>)</span>*<span class="mxinfo" id="T1:U1839"><span class="var type1" id="S14T9U2143">qwp</span>(<span class="mxinfo" id="T1:U1841">3</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U2145">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="mxinfo" id="T1:U1778"><span class="mxinfo" id="T1:U1780"><span class="mxinfo" id="T1:U1781">                + <span class="mxinfo" id="T1:U1843"><span class="var type1" id="S13T6U2148">Twp</span>(<span class="mxinfo" id="T1:U1845">1</span>)</span></span> - <span class="mxinfo" id="T1:U1846"><span class="mxinfo" id="T1:U1847"><span class="mxinfo" id="T6:U1848"><span class="mxinfo" id="T4:U1849"><span class="mxinfo" id="T53:U1850"><span class="var type1" id="S5T2U2155">z</span>(<span class="mxinfo" id="T1:U1852">1</span>,<span class="var type1" id="S10T1U2157">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1854">1</span>)</span>/<span class="mxinfo" id="T1:U1855">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">            <span class="mxinfo" id="T1:U1856"><span class="var type1" id="S28T1U2164">B2</span> = <span class="mxinfo" id="T1:U1858"><span class="mxinfo" id="T1:U1859"><span class="mxinfo" id="T1:U1860"><span class="mxinfo" id="T1:U1861"><span class="mxinfo" id="T1:U1862"><span class="mxinfo" id="T1:U1863"><span class="mxinfo" id="T1:U1864">2</span>*(<span class="mxinfo" id="T1:U1865"><span class="mxinfo" id="T1:U1866"><span class="mxinfo" id="T1:U1867"><span class="var type1" id="S14T9U2176">qwp</span>(<span class="mxinfo" id="T1:U1869">2</span>)</span>*<span class="mxinfo" id="T1:U1870"><span class="var type1" id="S14T9U2179">qwp</span>(<span class="mxinfo" id="T1:U1872">3</span>)</span></span> + <span class="mxinfo" id="T1:U1873"><span class="mxinfo" id="T1:U1874"><span class="var type1" id="S14T9U2183">qwp</span>(<span class="mxinfo" id="T1:U1876">1</span>)</span>*<span class="mxinfo" id="T1:U1877"><span class="var type1" id="S14T9U2186">qwp</span>(<span class="mxinfo" id="T1:U1879">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U2188">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="mxinfo" id="T1:U1856"><span class="mxinfo" id="T1:U1858"><span class="mxinfo" id="T1:U1859"><span class="mxinfo" id="T1:U1860"><span class="mxinfo" id="T1:U1861">                <span class="mxinfo" id="T1:U1881">+ (<span class="mxinfo" id="T1:U1882"><span class="mxinfo" id="T1:U1883"><span class="mxinfo" id="T1:U1884"><span class="mxinfo" id="T1:U1885"><span class="mxinfo" id="T1:U1886"><span class="var type1" id="S14T9U2197">qwp</span>(<span class="mxinfo" id="T1:U1888">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U1889"><span class="mxinfo" id="T1:U1890"><span class="var type1" id="S14T9U2202">qwp</span>(<span class="mxinfo" id="T1:U1892">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U1893"><span class="mxinfo" id="T1:U1894"><span class="var type1" id="S14T9U2207">qwp</span>(<span class="mxinfo" id="T1:U1896">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1897"><span class="mxinfo" id="T1:U1898"><span class="var type1" id="S14T9U2212">qwp</span>(<span class="mxinfo" id="T1:U1900">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U2215">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="mxinfo" id="T1:U1856"><span class="mxinfo" id="T1:U1858"><span class="mxinfo" id="T1:U1859"><span class="mxinfo" id="T1:U1860">                <span class="mxinfo" id="T1:U1902"><span class="mxinfo" id="T1:U1903"><span class="mxinfo" id="T1:U1904">+ 2</span>*(<span class="mxinfo" id="T1:U1905"><span class="mxinfo" id="T1:U1906"><span class="mxinfo" id="T1:U1907"><span class="var type1" id="S14T9U2224">qwp</span>(<span class="mxinfo" id="T1:U1909">3</span>)</span>*<span class="mxinfo" id="T1:U1910"><span class="var type1" id="S14T9U2227">qwp</span>(<span class="mxinfo" id="T1:U1912">4</span>)</span></span> - <span class="mxinfo" id="T1:U1913"><span class="mxinfo" id="T1:U1914"><span class="var type1" id="S14T9U2231">qwp</span>(<span class="mxinfo" id="T1:U1916">1</span>)</span>*<span class="mxinfo" id="T1:U1917"><span class="var type1" id="S14T9U2234">qwp</span>(<span class="mxinfo" id="T1:U1919">2</span>)</span></span></span>)</span>*<span class="var type1" id="S26T1U2236">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo" id="T1:U1856"><span class="mxinfo" id="T1:U1858"><span class="mxinfo" id="T1:U1859">                + <span class="mxinfo" id="T1:U1921"><span class="var type1" id="S13T6U2239">Twp</span>(<span class="mxinfo" id="T1:U1923">2</span>)</span></span> - <span class="mxinfo" id="T1:U1924"><span class="mxinfo" id="T1:U1925"><span class="mxinfo" id="T6:U1926"><span class="mxinfo" id="T4:U1927"><span class="mxinfo" id="T53:U1928"><span class="var type1" id="S5T2U2246">z</span>(<span class="mxinfo" id="T1:U1930">1</span>,<span class="var type1" id="S10T1U2248">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1932">2</span>)</span>/<span class="mxinfo" id="T1:U1933">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">            <span class="mxinfo" id="T1:U1934"><span class="var type1" id="S29T1U2255">B3</span> = <span class="mxinfo" id="T1:U1936"><span class="mxinfo" id="T1:U1937"><span class="mxinfo" id="T1:U1938"><span class="mxinfo" id="T1:U1939"><span class="mxinfo" id="T1:U1940"><span class="mxinfo" id="T1:U1941"><span class="mxinfo" id="T1:U1942">2</span>*(<span class="mxinfo" id="T1:U1943"><span class="mxinfo" id="T1:U1944"><span class="mxinfo" id="T1:U1945"><span class="var type1" id="S14T9U2267">qwp</span>(<span class="mxinfo" id="T1:U1947">2</span>)</span>*<span class="mxinfo" id="T1:U1948"><span class="var type1" id="S14T9U2270">qwp</span>(<span class="mxinfo" id="T1:U1950">4</span>)</span></span> - <span class="mxinfo" id="T1:U1951"><span class="mxinfo" id="T1:U1952"><span class="var type1" id="S14T9U2274">qwp</span>(<span class="mxinfo" id="T1:U1954">1</span>)</span>*<span class="mxinfo" id="T1:U1955"><span class="var type1" id="S14T9U2277">qwp</span>(<span class="mxinfo" id="T1:U1957">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U2279">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo" id="T1:U1934"><span class="mxinfo" id="T1:U1936"><span class="mxinfo" id="T1:U1937"><span class="mxinfo" id="T1:U1938"><span class="mxinfo" id="T1:U1939">                <span class="mxinfo" id="T1:U1959"><span class="mxinfo" id="T1:U1960"><span class="mxinfo" id="T1:U1961">+ 2</span>*(<span class="mxinfo" id="T1:U1962"><span class="mxinfo" id="T1:U1963"><span class="mxinfo" id="T1:U1964"><span class="var type1" id="S14T9U2288">qwp</span>(<span class="mxinfo" id="T1:U1966">3</span>)</span>*<span class="mxinfo" id="T1:U1967"><span class="var type1" id="S14T9U2291">qwp</span>(<span class="mxinfo" id="T1:U1969">4</span>)</span></span> + <span class="mxinfo" id="T1:U1970"><span class="mxinfo" id="T1:U1971"><span class="var type1" id="S14T9U2295">qwp</span>(<span class="mxinfo" id="T1:U1973">1</span>)</span>*<span class="mxinfo" id="T1:U1974"><span class="var type1" id="S14T9U2298">qwp</span>(<span class="mxinfo" id="T1:U1976">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U2300">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo" id="T1:U1934"><span class="mxinfo" id="T1:U1936"><span class="mxinfo" id="T1:U1937"><span class="mxinfo" id="T1:U1938">                <span class="mxinfo" id="T1:U1978">+ (<span class="mxinfo" id="T1:U1979"><span class="mxinfo" id="T1:U1980"><span class="mxinfo" id="T1:U1981"><span class="mxinfo" id="T1:U1982"><span class="mxinfo" id="T1:U1983"><span class="var type1" id="S14T9U2309">qwp</span>(<span class="mxinfo" id="T1:U1985">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U1986"><span class="mxinfo" id="T1:U1987"><span class="var type1" id="S14T9U2314">qwp</span>(<span class="mxinfo" id="T1:U1989">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1990"><span class="mxinfo" id="T1:U1991"><span class="var type1" id="S14T9U2319">qwp</span>(<span class="mxinfo" id="T1:U1993">3</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U1994"><span class="mxinfo" id="T1:U1995"><span class="var type1" id="S14T9U2324">qwp</span>(<span class="mxinfo" id="T1:U1997">4</span>)</span>^2</span></span>)*<span class="var type1" id="S26T1U2327">Z</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo" id="T1:U1934"><span class="mxinfo" id="T1:U1936"><span class="mxinfo" id="T1:U1937">                + <span class="mxinfo" id="T1:U1999"><span class="var type1" id="S13T6U2330">Twp</span>(<span class="mxinfo" id="T1:U2001">3</span>)</span></span> - <span class="mxinfo" id="T1:U2002"><span class="mxinfo" id="T1:U2003"><span class="mxinfo" id="T6:U2004"><span class="mxinfo" id="T4:U2005"><span class="mxinfo" id="T53:U2006"><span class="var type1" id="S5T2U2337">z</span>(<span class="mxinfo" id="T1:U2008">1</span>,<span class="var type1" id="S10T1U2339">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U2010">3</span>)</span>/<span class="mxinfo" id="T1:U2011">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m            </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">            <span class="mxinfo" id="T1:U2012"><span class="var type1" id="S30T1U2346">b</span> = <span class="mxinfo" id="T1:U2014"><span class="mxinfo" id="T1:U2015"><span class="mxinfo" id="T1:U2016"><span class="mxinfo" id="T1:U2017"><span class="var type1" id="S23T5U2351">K</span>(<span class="mxinfo" id="T1:U2019">3</span>,<span class="mxinfo" id="T1:U2020">1</span>)</span>*<span class="var type1" id="S27T1U2354">B1</span></span> + <span class="mxinfo" id="T1:U2022"><span class="mxinfo" id="T1:U2023"><span class="var type1" id="S23T5U2357">K</span>(<span class="mxinfo" id="T1:U2025">3</span>,<span class="mxinfo" id="T1:U2026">2</span>)</span>*<span class="var type1" id="S28T1U2360">B2</span></span></span> + <span class="mxinfo" id="T1:U2028"><span class="mxinfo" id="T1:U2029"><span class="var type1" id="S23T5U2363">K</span>(<span class="mxinfo" id="T1:U2031">3</span>,<span class="mxinfo" id="T1:U2032">3</span>)</span>*<span class="var type1" id="S29T1U2366">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">            <span class="mxinfo" id="T1:U2034"><span class="var type1" id="S31T1U2369">bu</span> = <span class="var type1" id="S30T1U2370">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">            <span class="mxinfo" id="T1:U2037"><span class="var type1" id="S32T1U2373">bv</span> = <span class="var type1" id="S30T1U2374">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">            <span class="mxinfo" id="T1:U2040"><span class="var type1" id="S33T1U2377">au</span> = <span class="mxinfo" id="T1:U2042"><span class="mxinfo" id="T1:U2043"><span class="mxinfo" id="T1:U2044"><span class="mxinfo" id="T1:U2045"><span class="var type1" id="S23T5U2382">K</span>(<span class="mxinfo" id="T1:U2047">1</span>,<span class="mxinfo" id="T1:U2048">1</span>)</span>*<span class="var type1" id="S27T1U2385">B1</span></span> + <span class="mxinfo" id="T1:U2050"><span class="mxinfo" id="T1:U2051"><span class="var type1" id="S23T5U2388">K</span>(<span class="mxinfo" id="T1:U2053">1</span>,<span class="mxinfo" id="T1:U2054">2</span>)</span>*<span class="var type1" id="S28T1U2391">B2</span></span></span> + <span class="mxinfo" id="T1:U2056"><span class="mxinfo" id="T1:U2057"><span class="var type1" id="S23T5U2394">K</span>(<span class="mxinfo" id="T1:U2059">1</span>,<span class="mxinfo" id="T1:U2060">3</span>)</span>*<span class="var type1" id="S29T1U2397">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">            <span class="mxinfo" id="T1:U2062"><span class="var type1" id="S34T1U2400">av</span> = <span class="mxinfo" id="T1:U2064"><span class="mxinfo" id="T1:U2065"><span class="mxinfo" id="T1:U2066"><span class="mxinfo" id="T1:U2067"><span class="var type1" id="S23T5U2405">K</span>(<span class="mxinfo" id="T1:U2069">2</span>,<span class="mxinfo" id="T1:U2070">1</span>)</span>*<span class="var type1" id="S27T1U2408">B1</span></span> + <span class="mxinfo" id="T1:U2072"><span class="mxinfo" id="T1:U2073"><span class="var type1" id="S23T5U2411">K</span>(<span class="mxinfo" id="T1:U2075">2</span>,<span class="mxinfo" id="T1:U2076">2</span>)</span>*<span class="var type1" id="S28T1U2414">B2</span></span></span> + <span class="mxinfo" id="T1:U2078"><span class="mxinfo" id="T1:U2079"><span class="var type1" id="S23T5U2417">K</span>(<span class="mxinfo" id="T1:U2081">2</span>,<span class="mxinfo" id="T1:U2082">3</span>)</span>*<span class="var type1" id="S29T1U2420">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">            <span class="mxinfo" id="T17:U2084"><span class="var type1" id="S35T17U2423">dB_zeros</span> = <span class="mxinfo" id="T17:U2086">[0 0 0]</span></span>;               </span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">            <span class="mxinfo" id="T18:U2087"><span class="var type1" id="S36T18U2431">dB1_q</span> = <span class="mxinfo" id="T18:U2089">[<span class="mxinfo" id="T1:U2090"><span class="mxinfo" id="T1:U2091">2</span>*(<span class="mxinfo" id="T1:U2092"><span class="mxinfo" id="T1:U2093"><span class="mxinfo" id="T1:U2094"><span class="mxinfo" id="T1:U2095"><span class="var type1" id="S14T9U2441">qwp</span>(<span class="mxinfo" id="T1:U2097">1</span>)</span>*<span class="var type1" id="S24T1U2443">X</span></span> - <span class="mxinfo" id="T1:U2099"><span class="mxinfo" id="T1:U2100"><span class="var type1" id="S14T9U2446">qwp</span>(<span class="mxinfo" id="T1:U2102">4</span>)</span>*<span class="var type1" id="S25T1U2448">Y</span></span></span> + <span class="mxinfo" id="T1:U2104"><span class="mxinfo" id="T1:U2105"><span class="var type1" id="S14T9U2451">qwp</span>(<span class="mxinfo" id="T1:U2107">3</span>)</span>*<span class="var type1" id="S26T1U2453">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2109"><span class="mxinfo" id="T1:U2110">2</span>*(<span class="mxinfo" id="T1:U2111"><span class="mxinfo" id="T1:U2112"><span class="mxinfo" id="T1:U2113"><span class="mxinfo" id="T1:U2114"><span class="var type1" id="S14T9U2461">qwp</span>(<span class="mxinfo" id="T1:U2116">2</span>)</span>*<span class="var type1" id="S24T1U2463">X</span></span> + <span class="mxinfo" id="T1:U2118"><span class="mxinfo" id="T1:U2119"><span class="var type1" id="S14T9U2466">qwp</span>(<span class="mxinfo" id="T1:U2121">3</span>)</span>*<span class="var type1" id="S25T1U2468">Y</span></span></span> + <span class="mxinfo" id="T1:U2123"><span class="mxinfo" id="T1:U2124"><span class="var type1" id="S14T9U2471">qwp</span>(<span class="mxinfo" id="T1:U2126">4</span>)</span>*<span class="var type1" id="S26T1U2473">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line"><span class="mxinfo" id="T18:U2087"><span class="mxinfo" id="T18:U2089">                    <span class="mxinfo" id="T1:U2128"><span class="mxinfo" id="T1:U2129">2</span>*(<span class="mxinfo" id="T1:U2130"><span class="mxinfo" id="T1:U2131"><span class="mxinfo" id="T1:U2132"><span class="mxinfo" id="T1:U2133">-<span class="mxinfo" id="T1:U2134"><span class="var type1" id="S14T9U2482">qwp</span>(<span class="mxinfo" id="T1:U2136">3</span>)</span></span>*<span class="var type1" id="S24T1U2484">X</span></span> + <span class="mxinfo" id="T1:U2138"><span class="mxinfo" id="T1:U2139"><span class="var type1" id="S14T9U2487">qwp</span>(<span class="mxinfo" id="T1:U2141">2</span>)</span>*<span class="var type1" id="S25T1U2489">Y</span></span></span> + <span class="mxinfo" id="T1:U2143"><span class="mxinfo" id="T1:U2144"><span class="var type1" id="S14T9U2492">qwp</span>(<span class="mxinfo" id="T1:U2146">1</span>)</span>*<span class="var type1" id="S26T1U2494">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2148"><span class="mxinfo" id="T1:U2149">2</span>*(<span class="mxinfo" id="T1:U2150"><span class="mxinfo" id="T1:U2151"><span class="mxinfo" id="T1:U2152"><span class="mxinfo" id="T1:U2153">-<span class="mxinfo" id="T1:U2154"><span class="var type1" id="S14T9U2503">qwp</span>(<span class="mxinfo" id="T1:U2156">4</span>)</span></span>*<span class="var type1" id="S24T1U2505">X</span></span> - <span class="mxinfo" id="T1:U2158"><span class="mxinfo" id="T1:U2159"><span class="var type1" id="S14T9U2508">qwp</span>(<span class="mxinfo" id="T1:U2161">1</span>)</span>*<span class="var type1" id="S25T1U2510">Y</span></span></span> + <span class="mxinfo" id="T1:U2163"><span class="mxinfo" id="T1:U2164"><span class="var type1" id="S14T9U2513">qwp</span>(<span class="mxinfo" id="T1:U2166">2</span>)</span>*<span class="var type1" id="S26T1U2515">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">            <span class="mxinfo" id="T18:U2168"><span class="var type1" id="S37T18U2518">dB2_q</span> = <span class="mxinfo" id="T18:U2170">[<span class="mxinfo" id="T1:U2171"><span class="mxinfo" id="T1:U2172">2</span>*(<span class="mxinfo" id="T1:U2173"><span class="mxinfo" id="T1:U2174"><span class="mxinfo" id="T1:U2175"><span class="mxinfo" id="T1:U2176"><span class="var type1" id="S14T9U2528">qwp</span>(<span class="mxinfo" id="T1:U2178">4</span>)</span>*<span class="var type1" id="S24T1U2530">X</span></span> + <span class="mxinfo" id="T1:U2180"><span class="mxinfo" id="T1:U2181"><span class="var type1" id="S14T9U2533">qwp</span>(<span class="mxinfo" id="T1:U2183">1</span>)</span>*<span class="var type1" id="S25T1U2535">Y</span></span></span> - <span class="mxinfo" id="T1:U2185"><span class="mxinfo" id="T1:U2186"><span class="var type1" id="S14T9U2538">qwp</span>(<span class="mxinfo" id="T1:U2188">2</span>)</span>*<span class="var type1" id="S26T1U2540">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2190"><span class="mxinfo" id="T1:U2191">2</span>*(<span class="mxinfo" id="T1:U2192"><span class="mxinfo" id="T1:U2193"><span class="mxinfo" id="T1:U2194"><span class="mxinfo" id="T1:U2195"><span class="var type1" id="S14T9U2548">qwp</span>(<span class="mxinfo" id="T1:U2197">3</span>)</span>*<span class="var type1" id="S24T1U2550">X</span></span> - <span class="mxinfo" id="T1:U2199"><span class="mxinfo" id="T1:U2200"><span class="var type1" id="S14T9U2553">qwp</span>(<span class="mxinfo" id="T1:U2202">2</span>)</span>*<span class="var type1" id="S25T1U2555">Y</span></span></span> - <span class="mxinfo" id="T1:U2204"><span class="mxinfo" id="T1:U2205"><span class="var type1" id="S14T9U2558">qwp</span>(<span class="mxinfo" id="T1:U2207">1</span>)</span>*<span class="var type1" id="S26T1U2560">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line"><span class="mxinfo" id="T18:U2168"><span class="mxinfo" id="T18:U2170">                    <span class="mxinfo" id="T1:U2209"><span class="mxinfo" id="T1:U2210">2</span>*(<span class="mxinfo" id="T1:U2211"><span class="mxinfo" id="T1:U2212"><span class="mxinfo" id="T1:U2213"><span class="mxinfo" id="T1:U2214"><span class="var type1" id="S14T9U2568">qwp</span>(<span class="mxinfo" id="T1:U2216">2</span>)</span>*<span class="var type1" id="S24T1U2570">X</span></span> + <span class="mxinfo" id="T1:U2218"><span class="mxinfo" id="T1:U2219"><span class="var type1" id="S14T9U2573">qwp</span>(<span class="mxinfo" id="T1:U2221">3</span>)</span>*<span class="var type1" id="S25T1U2575">Y</span></span></span> + <span class="mxinfo" id="T1:U2223"><span class="mxinfo" id="T1:U2224"><span class="var type1" id="S14T9U2578">qwp</span>(<span class="mxinfo" id="T1:U2226">4</span>)</span>*<span class="var type1" id="S26T1U2580">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2228"><span class="mxinfo" id="T1:U2229">2</span>*(<span class="mxinfo" id="T1:U2230"><span class="mxinfo" id="T1:U2231"><span class="mxinfo" id="T1:U2232"><span class="mxinfo" id="T1:U2233"><span class="var type1" id="S14T9U2588">qwp</span>(<span class="mxinfo" id="T1:U2235">1</span>)</span>*<span class="var type1" id="S24T1U2590">X</span></span> - <span class="mxinfo" id="T1:U2237"><span class="mxinfo" id="T1:U2238"><span class="var type1" id="S14T9U2593">qwp</span>(<span class="mxinfo" id="T1:U2240">4</span>)</span>*<span class="var type1" id="S25T1U2595">Y</span></span></span> + <span class="mxinfo" id="T1:U2242"><span class="mxinfo" id="T1:U2243"><span class="var type1" id="S14T9U2598">qwp</span>(<span class="mxinfo" id="T1:U2245">3</span>)</span>*<span class="var type1" id="S26T1U2600">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">            <span class="mxinfo" id="T18:U2247"><span class="var type1" id="S38T18U2603">dB3_q</span> = <span class="mxinfo" id="T18:U2249">[<span class="mxinfo" id="T1:U2250"><span class="mxinfo" id="T1:U2251">2</span>*(<span class="mxinfo" id="T1:U2252"><span class="mxinfo" id="T1:U2253"><span class="mxinfo" id="T1:U2254"><span class="mxinfo" id="T1:U2255">-<span class="mxinfo" id="T1:U2256"><span class="var type1" id="S14T9U2614">qwp</span>(<span class="mxinfo" id="T1:U2258">3</span>)</span></span>*<span class="var type1" id="S24T1U2616">X</span></span> + <span class="mxinfo" id="T1:U2260"><span class="mxinfo" id="T1:U2261"><span class="var type1" id="S14T9U2619">qwp</span>(<span class="mxinfo" id="T1:U2263">2</span>)</span>*<span class="var type1" id="S25T1U2621">Y</span></span></span> + <span class="mxinfo" id="T1:U2265"><span class="mxinfo" id="T1:U2266"><span class="var type1" id="S14T9U2624">qwp</span>(<span class="mxinfo" id="T1:U2268">1</span>)</span>*<span class="var type1" id="S26T1U2626">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2270"><span class="mxinfo" id="T1:U2271">2</span>*(<span class="mxinfo" id="T1:U2272"><span class="mxinfo" id="T1:U2273"><span class="mxinfo" id="T1:U2274"><span class="mxinfo" id="T1:U2275"><span class="var type1" id="S14T9U2634">qwp</span>(<span class="mxinfo" id="T1:U2277">4</span>)</span>*<span class="var type1" id="S24T1U2636">X</span></span> + <span class="mxinfo" id="T1:U2279"><span class="mxinfo" id="T1:U2280"><span class="var type1" id="S14T9U2639">qwp</span>(<span class="mxinfo" id="T1:U2282">1</span>)</span>*<span class="var type1" id="S25T1U2641">Y</span></span></span> - <span class="mxinfo" id="T1:U2284"><span class="mxinfo" id="T1:U2285"><span class="var type1" id="S14T9U2644">qwp</span>(<span class="mxinfo" id="T1:U2287">2</span>)</span>*<span class="var type1" id="S26T1U2646">Z</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line"><span class="mxinfo" id="T18:U2247"><span class="mxinfo" id="T18:U2249">                    <span class="mxinfo" id="T1:U2289"><span class="mxinfo" id="T1:U2290">2</span>*(<span class="mxinfo" id="T1:U2291"><span class="mxinfo" id="T1:U2292"><span class="mxinfo" id="T1:U2293"><span class="mxinfo" id="T1:U2294">-<span class="mxinfo" id="T1:U2295"><span class="var type1" id="S14T9U2655">qwp</span>(<span class="mxinfo" id="T1:U2297">1</span>)</span></span>*<span class="var type1" id="S24T1U2657">X</span></span> + <span class="mxinfo" id="T1:U2299"><span class="mxinfo" id="T1:U2300"><span class="var type1" id="S14T9U2660">qwp</span>(<span class="mxinfo" id="T1:U2302">4</span>)</span>*<span class="var type1" id="S25T1U2662">Y</span></span></span> - <span class="mxinfo" id="T1:U2304"><span class="mxinfo" id="T1:U2305"><span class="var type1" id="S14T9U2665">qwp</span>(<span class="mxinfo" id="T1:U2307">3</span>)</span>*<span class="var type1" id="S26T1U2667">Z</span></span></span>)</span>,<span class="mxinfo" id="T1:U2309"><span class="mxinfo" id="T1:U2310">2</span>*(<span class="mxinfo" id="T1:U2311"><span class="mxinfo" id="T1:U2312"><span class="mxinfo" id="T1:U2313"><span class="mxinfo" id="T1:U2314"><span class="var type1" id="S14T9U2675">qwp</span>(<span class="mxinfo" id="T1:U2316">2</span>)</span>*<span class="var type1" id="S24T1U2677">X</span></span> + <span class="mxinfo" id="T1:U2318"><span class="mxinfo" id="T1:U2319"><span class="var type1" id="S14T9U2680">qwp</span>(<span class="mxinfo" id="T1:U2321">3</span>)</span>*<span class="var type1" id="S25T1U2682">Y</span></span></span> + <span class="mxinfo" id="T1:U2323"><span class="mxinfo" id="T1:U2324"><span class="var type1" id="S14T9U2685">qwp</span>(<span class="mxinfo" id="T1:U2326">4</span>)</span>*<span class="var type1" id="S26T1U2687">Z</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">            <span class="mxinfo" id="T19:U2328"><span class="var type1" id="S39T19U2690">dB1_x</span> = <span class="mxinfo" id="T19:U2330">[<span class="mxinfo" id="T1:U2331">1</span> <span class="mxinfo" id="T1:U2332">0</span> <span class="mxinfo" id="T1:U2333">0</span> <span class="var type1" id="S35T17U2696">dB_zeros</span> <span class="var type1" id="S36T18U2697">dB1_q</span> <span class="var type1" id="S35T17U2698">dB_zeros</span> <span class="var type1" id="S35T17U2699">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">            <span class="mxinfo" id="T19:U2338"><span class="var type1" id="S40T19U2702">dB2_x</span> = <span class="mxinfo" id="T19:U2340">[<span class="mxinfo" id="T1:U2341">0</span> <span class="mxinfo" id="T1:U2342">1</span> <span class="mxinfo" id="T1:U2343">0</span> <span class="var type1" id="S35T17U2708">dB_zeros</span> <span class="var type1" id="S37T18U2709">dB2_q</span> <span class="var type1" id="S35T17U2710">dB_zeros</span> <span class="var type1" id="S35T17U2711">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">            <span class="mxinfo" id="T19:U2348"><span class="var type1" id="S41T19U2714">dB3_x</span> = <span class="mxinfo" id="T19:U2350">[<span class="mxinfo" id="T1:U2351">0</span> <span class="mxinfo" id="T1:U2352">0</span> <span class="mxinfo" id="T1:U2353">1</span> <span class="var type1" id="S35T17U2720">dB_zeros</span> <span class="var type1" id="S38T18U2721">dB3_q</span> <span class="var type1" id="S35T17U2722">dB_zeros</span> <span class="var type1" id="S35T17U2723">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">            <span class="mxinfo" id="T19:U2358"><span class="var type1" id="S42T19U2726">au_prime</span> = <span class="mxinfo" id="T19:U2360"><span class="mxinfo" id="T19:U2361"><span class="mxinfo" id="T19:U2362"><span class="mxinfo" id="T1:U2363"><span class="var type1" id="S23T5U2731">K</span>(<span class="mxinfo" id="T1:U2365">1</span>,<span class="mxinfo" id="T1:U2366">1</span>)</span>*<span class="var type1" id="S39T19U2734">dB1_x</span></span> + <span class="mxinfo" id="T19:U2368"><span class="mxinfo" id="T1:U2369"><span class="var type1" id="S23T5U2737">K</span>(<span class="mxinfo" id="T1:U2371">1</span>,<span class="mxinfo" id="T1:U2372">2</span>)</span>*<span class="var type1" id="S40T19U2740">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U2374"><span class="mxinfo" id="T1:U2375"><span class="var type1" id="S23T5U2743">K</span>(<span class="mxinfo" id="T1:U2377">1</span>,<span class="mxinfo" id="T1:U2378">3</span>)</span>*<span class="var type1" id="S41T19U2746">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">            <span class="mxinfo" id="T19:U2380"><span class="var type1" id="S43T19U2749">av_prime</span> = <span class="mxinfo" id="T19:U2382"><span class="mxinfo" id="T19:U2383"><span class="mxinfo" id="T19:U2384"><span class="mxinfo" id="T1:U2385"><span class="var type1" id="S23T5U2754">K</span>(<span class="mxinfo" id="T1:U2387">2</span>,<span class="mxinfo" id="T1:U2388">1</span>)</span>*<span class="var type1" id="S39T19U2757">dB1_x</span></span> + <span class="mxinfo" id="T19:U2390"><span class="mxinfo" id="T1:U2391"><span class="var type1" id="S23T5U2760">K</span>(<span class="mxinfo" id="T1:U2393">2</span>,<span class="mxinfo" id="T1:U2394">2</span>)</span>*<span class="var type1" id="S40T19U2763">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U2396"><span class="mxinfo" id="T1:U2397"><span class="var type1" id="S23T5U2766">K</span>(<span class="mxinfo" id="T1:U2399">2</span>,<span class="mxinfo" id="T1:U2400">3</span>)</span>*<span class="var type1" id="S41T19U2769">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">            <span class="mxinfo" id="T19:U2402"><span class="var type1" id="S44T19U2772">b_prime</span> = <span class="mxinfo" id="T19:U2404"><span class="mxinfo" id="T19:U2405"><span class="mxinfo" id="T19:U2406"><span class="mxinfo" id="T1:U2407"><span class="var type1" id="S23T5U2777">K</span>(<span class="mxinfo" id="T1:U2409">3</span>,<span class="mxinfo" id="T1:U2410">1</span>)</span>*<span class="var type1" id="S39T19U2780">dB1_x</span></span> + <span class="mxinfo" id="T19:U2412"><span class="mxinfo" id="T1:U2413"><span class="var type1" id="S23T5U2783">K</span>(<span class="mxinfo" id="T1:U2415">3</span>,<span class="mxinfo" id="T1:U2416">2</span>)</span>*<span class="var type1" id="S40T19U2786">dB2_x</span></span></span> + <span class="mxinfo" id="T19:U2418"><span class="mxinfo" id="T1:U2419"><span class="var type1" id="S23T5U2789">K</span>(<span class="mxinfo" id="T1:U2421">3</span>,<span class="mxinfo" id="T1:U2422">3</span>)</span>*<span class="var type1" id="S41T19U2792">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">            <span class="mxinfo" id="T19:U2424"><span class="var type1" id="S45T19U2795">bu_prime</span> = <span class="var type1" id="S44T19U2796">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">            <span class="mxinfo" id="T19:U2427"><span class="var type1" id="S46T19U2799">bv_prime</span> = <span class="var type1" id="S44T19U2800">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">            <span class="mxinfo" id="T1:U2430"><span class="var type1" id="S47T1U2803">b_sq</span> = <span class="mxinfo" id="T1:U2432"><span class="var type1" id="S30T1U2805">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">            <span class="mxinfo" id="T19:U2434"><span class="var type1" id="S48T19U2809">du_dx</span> = <span class="mxinfo" id="T19:U2436">(<span class="mxinfo" id="T19:U2437"><span class="mxinfo" id="T19:U2438"><span class="var type1" id="S42T19U2814">au_prime</span>*<span class="var type1" id="S31T1U2815">bu</span></span> - <span class="mxinfo" id="T19:U2441"><span class="var type1" id="S33T1U2817">au</span>*<span class="var type1" id="S45T19U2818">bu_prime</span></span></span>)/<span class="var type1" id="S47T1U2819">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">            <span class="mxinfo" id="T19:U2445"><span class="var type1" id="S49T19U2822">dv_dx</span> = <span class="mxinfo" id="T19:U2447">(<span class="mxinfo" id="T19:U2448"><span class="mxinfo" id="T19:U2449"><span class="var type1" id="S43T19U2827">av_prime</span>*<span class="var type1" id="S32T1U2828">bv</span></span> - <span class="mxinfo" id="T19:U2452"><span class="var type1" id="S34T1U2830">av</span>*<span class="var type1" id="S46T19U2831">bv_prime</span></span></span>)/<span class="var type1" id="S47T1U2832">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">            <span class="mxinfo" id="T54:U2456"><span class="mxinfo" id="T54:U2457"><span class="var type1" id="S11T20U2836">H</span>(<span class="mxinfo" id="T16:U2459"><span class="var type1" id="S17T1U2838">k</span>:<span class="mxinfo" id="T1:U2461"><span class="var type1" id="S17T1U2840">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T54:U2463">[<span class="var type1" id="S48T19U2845">du_dx</span>;<span class="var type1" id="S49T19U2847">dv_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">            <span class="mxinfo" id="T1:U2466"><span class="mxinfo" id="T1:U2467"><span class="var type1" id="S16T34U2851">z_meas</span>(<span class="var type1" id="S17T1U2852">k</span>,<span class="mxinfo" id="T1:U2470">1</span>)</span> = <span class="mxinfo" id="T1:U2471"><span class="mxinfo" id="T3:U2472"><span class="mxinfo" id="T53:U2473"><span class="var type1" id="S5T2U2857">z</span>(<span class="mxinfo" id="T1:U2475">1</span>,<span class="var type1" id="S10T1U2859">i</span>)</span>.blue_data</span>(<span class="mxinfo" id="T1:U2477">1</span>,<span class="mxinfo" id="T1:U2478">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">            <span class="mxinfo" id="T1:U2479"><span class="mxinfo" id="T1:U2480"><span class="var type1" id="S16T34U2866">z_meas</span>(<span class="mxinfo" id="T1:U2482"><span class="var type1" id="S17T1U2868">k</span>+<span class="mxinfo" id="T1:U2484">1</span></span>,<span class="mxinfo" id="T1:U2485">1</span>)</span> = <span class="mxinfo" id="T1:U2486"><span class="mxinfo" id="T3:U2487"><span class="mxinfo" id="T53:U2488"><span class="var type1" id="S5T2U2874">z</span>(<span class="mxinfo" id="T1:U2490">1</span>,<span class="var type1" id="S10T1U2876">i</span>)</span>.blue_data</span>(<span class="mxinfo" id="T1:U2492">1</span>,<span class="mxinfo" id="T1:U2493">2</span>)</span></span>;                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">            <span class="mxinfo" id="T1:U2494"><span class="var type1" id="S17T1U2882">k</span> = <span class="mxinfo" id="T1:U2496"><span class="var type1" id="S17T1U2884">k</span> + <span class="mxinfo" id="T1:U2498">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line">    <span class="comment">% pixel noise goes additively</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line">    <span class="mxinfo" id="T1:U2499">[<span class="var type1" id="S50T1U2889">row_H</span>,<span class="mxinfo" id="T1:U2501"><span class="var type1" id="S51T1U2890">col_H</span></span>] = size(<span class="var type1" id="S11T20U2893">H</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,226" id="srcline226">226</a></span><span class="line">    <span class="mxinfo" id="T28:U2504"><span class="var type1" id="S53T28U2896">R</span> = <span class="mxinfo" id="T28:U2506"><span class="mxinfo" id="T28:U2507">eye(<span class="var type1" id="S50T1U2900">row_H</span>)</span>*<span class="var type1" id="S8T1U2901">Measurement_noise</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,227" id="srcline227">227</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,228" id="srcline228">228</a></span><span class="line">    <span class="comment">% Compute Kalman gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,229" id="srcline229">229</a></span><span class="line">    <span class="mxinfo" id="T30:U2510"><span class="var type1" id="S55T30U2904">Kalman</span> = <span class="mxinfo" id="T30:U2512"><span class="mxinfo" id="T30:U2513"><span class="var type1" id="S6T29U2907">P</span>*<span class="mxinfo" id="T30:U2515"><span class="var type1" id="S11T20U2909">H</span>'</span></span>*(<span class="mxinfo" id="T28:U2517">(<span class="mxinfo" id="T28:U2518"><span class="mxinfo" id="T28:U2519"><span class="mxinfo" id="T20:U2520"><span class="var type1" id="S11T20U2916">H</span>*<span class="var type1" id="S6T29U2917">P</span></span>*<span class="mxinfo" id="T30:U2523"><span class="var type1" id="S11T20U2919">H</span>'</span></span> + <span class="var type1" id="S53T28U2920">R</span></span>)^-1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,230" id="srcline230">230</a></span><span class="line">    <span class="mxinfo" id="T7:U2526"><span class="var type1" id="S2T7U2925">xCorr</span> = <span class="mxinfo" id="T7:U2528"><span class="var type1" id="S4T7U2927">x</span> + <span class="mxinfo" id="T7:U2530"><span class="var type1" id="S55T30U2929">Kalman</span>*(<span class="mxinfo" id="T34:U2532"><span class="var type1" id="S16T34U2932">z_meas</span> - <span class="var type1" id="S15T34U2933">z_est</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,231" id="srcline231">231</a></span><span class="line">    <span class="mxinfo" id="T29:U2535"><span class="var type1" id="S3T29U2936">PCorr</span> = <span class="mxinfo" id="T29:U2537">(<span class="mxinfo" id="T29:U2538"><span class="mxinfo" id="T29:U2539">eye(16)</span> - <span class="mxinfo" id="T29:U2540"><span class="var type1" id="S55T30U2944">Kalman</span>*<span class="var type1" id="S11T20U2945">H</span></span></span>)*<span class="var type1" id="S6T29U2946">P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,232" id="srcline232">232</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,233" id="srcline233">233</a></span><span class="line"></span></span>
</pre>
