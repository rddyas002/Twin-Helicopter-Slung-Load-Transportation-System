<pre class="code">
<span class="srcline"><span class="lineno"><a href="71,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">mean</span>,<span class="var type1" id="S3T29U4">Cov</span>] = projectStateAndCov(<span class="var type1" id="S4T7U7">x</span>,<span class="var type1" id="S5T29U8">P</span>,<span class="var type1" id="S6T35U9">u</span>,<span class="var type1" id="S7T44U10">Q</span>,<span class="var type1" id="S8T1U11">dt</span>,<span class="var type1" id="S9T6U12">static_acceleration_earth</span>)<span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% implements state prediction phase of KF</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,4" id="srcline4">  4</a></span><span class="line">    <span class="comment">% state order</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,5" id="srcline5">  5</a></span><span class="line">    <span class="comment">% x = [p v q w a]^T;</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">% p = x[1:3]: platform position w.r.t. room</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,7" id="srcline7">  7</a></span><span class="line">    <span class="comment">% v = x[4:6]: platform velocity w.r.t. room</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,8" id="srcline8">  8</a></span><span class="line">    <span class="comment">% q = x[7:10]: quaternion representing attitude between room and platform</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,9" id="srcline9">  9</a></span><span class="line">    <span class="comment">% w = x[11:13]: gyro bias</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">% a = x[14:16]: accelerometer bais</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,11" id="srcline11"> 11</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo" id="T6:U9"><span class="var type1" id="S10T6U15">w_bias</span> = <span class="mxinfo" id="T6:U11"><span class="var type1" id="S4T7U17">x</span>(<span class="mxinfo" id="T17:U13"><span class="mxinfo" id="T1:U14">11</span>:<span class="mxinfo" id="T1:U15">13</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo" id="T6:U16"><span class="var type1" id="S11T6U23">a_bias</span> = <span class="mxinfo" id="T6:U18"><span class="var type1" id="S4T7U25">x</span>(<span class="mxinfo" id="T17:U20"><span class="mxinfo" id="T1:U21">14</span>:<span class="mxinfo" id="T1:U22">16</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,15" id="srcline15"> 15</a></span><span class="line">    <span class="comment">% implement state-difference equation</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,16" id="srcline16"> 16</a></span><span class="line">    <span class="mxinfo" id="T7:U23"><span class="var type1" id="S2T7U31">mean</span> = <span class="mxinfo" id="T7:U25"><span class="fcn" id="F325N9:B33">projectState</span>(<span class="var type1" id="S4T7U34">x</span>,<span class="var type1" id="S6T35U35">u</span>,<span class="var type1" id="S8T1U36">dt</span>,<span class="var type1" id="S9T6U37">static_acceleration_earth</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%     % calculate the second order term from papoulis</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%     accl = [u(4) - a_bias(1);u(5) - a_bias(2);u(6) - a_bias(3)];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%     df2 = zeros(16,16);</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%     dr2q1 = 2*[1 0 0;0 1 0;0 0 1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%     dr2q2 = 2*[1 0 0;0 -1 0;0 0 -1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%     dr2q3 = 2*[-1 0 0;0 1 0;0 0 -1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%     dr2q4 = 2*[-1 0 0;0 -1 0;0 0 1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%     df2(4:6,7:10) = dt*[dr2q1*accl,dr2q2*accl,dr2q3*accl,dr2q4*accl];</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%     mean = mean + (1/2)*trace(df2*P);</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,26" id="srcline26"> 26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo" id="T9:U30"><span class="var type1" id="S13T9U40">q</span> = <span class="mxinfo" id="T9:U32"><span class="var type1" id="S4T7U42">x</span>(<span class="mxinfo" id="T18:U34"><span class="mxinfo" id="T1:U35">7</span>:<span class="mxinfo" id="T1:U36">10</span></span>)</span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="71,28" id="srcline28"> 28</a></span><span class="line">    <span class="mxinfo" id="T1:U37"><span class="var type1" id="S14T1U48">q1</span> = <span class="mxinfo" id="T1:U39"><span class="var type1" id="S13T9U50">q</span>(<span class="mxinfo" id="T1:U41">1</span>)</span></span>; <span class="mxinfo" id="T1:U42"><span class="var type1" id="S15T1U54">q2</span> = <span class="mxinfo" id="T1:U44"><span class="var type1" id="S13T9U56">q</span>(<span class="mxinfo" id="T1:U46">2</span>)</span></span>; <span class="mxinfo" id="T1:U47"><span class="var type1" id="S16T1U60">q3</span> = <span class="mxinfo" id="T1:U49"><span class="var type1" id="S13T9U62">q</span>(<span class="mxinfo" id="T1:U51">3</span>)</span></span>; <span class="mxinfo" id="T1:U52"><span class="var type1" id="S17T1U66">q4</span> = <span class="mxinfo" id="T1:U54"><span class="var type1" id="S13T9U68">q</span>(<span class="mxinfo" id="T1:U56">4</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="71,29" id="srcline29"> 29</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="71,30" id="srcline30"> 30</a></span><span class="line">    <span class="comment">% partial derivative of f w.r.t. the states</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,31" id="srcline31"> 31</a></span><span class="line">    <span class="mxinfo" id="T29:U57"><span class="var type1" id="S18T29U72">A</span> = <span class="mxinfo" id="T29:U59">zeros(<span class="mxinfo" id="T1:U60">16</span>,<span class="mxinfo" id="T1:U61">16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,32" id="srcline32"> 32</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo" id="T39:U62"><span class="var type1" id="S20T39U79">dp_dx</span> = <span class="mxinfo" id="T39:U64">[<span class="mxinfo" id="T5:U65">eye(3)</span>,<span class="mxinfo" id="T5:U66"><span class="mxinfo" id="T5:U67">eye(3)</span>*<span class="var type1" id="S8T1U89">dt</span></span>,<span class="mxinfo" id="T36:U69">zeros(<span class="mxinfo" id="T1:U70">3</span>,<span class="mxinfo" id="T1:U71">4</span>)</span>,<span class="mxinfo" id="T5:U72">zeros(<span class="mxinfo" id="T1:U73">3</span>,<span class="mxinfo" id="T1:U74">3</span>)</span>,<span class="mxinfo" id="T5:U75">zeros(<span class="mxinfo" id="T1:U76">3</span>,<span class="mxinfo" id="T1:U77">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,34" id="srcline34"> 34</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo" id="T5:U78"><span class="var type1" id="S22T5U104">dR_dq1</span> = <span class="mxinfo" id="T5:U80"><span class="mxinfo" id="T1:U81">2</span>*<span class="mxinfo" id="T5:U82">[<span class="mxinfo" id="T17:U83"><span class="var type1" id="S14T1U109">q1</span> <span class="mxinfo" id="T1:U85">-<span class="var type1" id="S17T1U111">q4</span></span> <span class="var type1" id="S16T1U112">q3</span></span>;</span></span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="71,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T5:U78"><span class="mxinfo" id="T5:U80"><span class="mxinfo" id="T5:U82">                <span class="mxinfo" id="T17:U88"><span class="var type1" id="S17T1U114">q4</span> <span class="var type1" id="S14T1U115">q1</span> <span class="mxinfo" id="T1:U91">-<span class="var type1" id="S15T1U117">q2</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T5:U78"><span class="mxinfo" id="T5:U80"><span class="mxinfo" id="T5:U82">                <span class="mxinfo" id="T17:U93"><span class="mxinfo" id="T1:U94">-<span class="var type1" id="S16T1U120">q3</span></span> <span class="var type1" id="S15T1U121">q2</span> <span class="var type1" id="S14T1U122">q1</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo" id="T5:U98"><span class="var type1" id="S23T5U125">dR_dq2</span> = <span class="mxinfo" id="T5:U100"><span class="mxinfo" id="T1:U101">2</span>*<span class="mxinfo" id="T5:U102">[<span class="mxinfo" id="T17:U103"><span class="var type1" id="S15T1U130">q2</span> <span class="var type1" id="S16T1U131">q3</span> <span class="var type1" id="S17T1U132">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo" id="T5:U98"><span class="mxinfo" id="T5:U100"><span class="mxinfo" id="T5:U102">                <span class="mxinfo" id="T17:U107"><span class="var type1" id="S16T1U134">q3</span> <span class="mxinfo" id="T1:U109">-<span class="var type1" id="S15T1U136">q2</span></span> <span class="mxinfo" id="T1:U111">-<span class="var type1" id="S14T1U138">q1</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T5:U98"><span class="mxinfo" id="T5:U100"><span class="mxinfo" id="T5:U102">                <span class="mxinfo" id="T17:U113"><span class="var type1" id="S17T1U140">q4</span> <span class="var type1" id="S14T1U141">q1</span> <span class="mxinfo" id="T1:U116">-<span class="var type1" id="S15T1U143">q2</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo" id="T5:U118"><span class="var type1" id="S24T5U146">dR_dq3</span> = <span class="mxinfo" id="T5:U120"><span class="mxinfo" id="T1:U121">2</span>*<span class="mxinfo" id="T5:U122">[<span class="mxinfo" id="T17:U123"><span class="mxinfo" id="T1:U124">-<span class="var type1" id="S16T1U152">q3</span></span> <span class="var type1" id="S15T1U153">q2</span> <span class="var type1" id="S14T1U154">q1</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T5:U118"><span class="mxinfo" id="T5:U120"><span class="mxinfo" id="T5:U122">                <span class="mxinfo" id="T17:U128"><span class="var type1" id="S15T1U156">q2</span> <span class="var type1" id="S16T1U157">q3</span> <span class="var type1" id="S17T1U158">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T5:U118"><span class="mxinfo" id="T5:U120"><span class="mxinfo" id="T5:U122">                <span class="mxinfo" id="T17:U132"><span class="mxinfo" id="T1:U133">-<span class="var type1" id="S14T1U161">q1</span></span> <span class="var type1" id="S17T1U162">q4</span> <span class="mxinfo" id="T1:U136">-<span class="var type1" id="S16T1U164">q3</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo" id="T5:U138"><span class="var type1" id="S25T5U167">dR_dq4</span> = <span class="mxinfo" id="T5:U140"><span class="mxinfo" id="T1:U141">2</span>*<span class="mxinfo" id="T5:U142">[<span class="mxinfo" id="T17:U143"><span class="mxinfo" id="T1:U144">-<span class="var type1" id="S17T1U173">q4</span></span> <span class="mxinfo" id="T1:U146">-<span class="var type1" id="S14T1U175">q1</span></span> <span class="var type1" id="S15T1U176">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo" id="T5:U138"><span class="mxinfo" id="T5:U140"><span class="mxinfo" id="T5:U142">                <span class="mxinfo" id="T17:U149"><span class="var type1" id="S14T1U178">q1</span> <span class="mxinfo" id="T1:U151">-<span class="var type1" id="S17T1U180">q4</span></span> <span class="var type1" id="S16T1U181">q3</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T5:U138"><span class="mxinfo" id="T5:U140"><span class="mxinfo" id="T5:U142">                <span class="mxinfo" id="T17:U154"><span class="var type1" id="S15T1U183">q2</span> <span class="var type1" id="S16T1U184">q3</span> <span class="var type1" id="S17T1U185">q4</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,47" id="srcline47"> 47</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="71,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo" id="T6:U158"><span class="var type1" id="S26T6U188">a_bar</span> = <span class="mxinfo" id="T6:U160"><span class="mxinfo" id="T6:U161"><span class="var type1" id="S6T35U191">u</span>(<span class="mxinfo" id="T17:U163"><span class="mxinfo" id="T1:U164">4</span>:<span class="mxinfo" id="T1:U165">6</span></span>)</span> - <span class="var type1" id="S11T6U195">a_bias</span></span></span>;   <span class="comment">% bias removed</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo" id="T36:U167"><span class="var type1" id="S27T36U198">da_dq</span> = <span class="mxinfo" id="T36:U169">[<span class="mxinfo" id="T6:U170"><span class="var type1" id="S22T5U202">dR_dq1</span>*<span class="var type1" id="S26T6U203">a_bar</span></span>,<span class="mxinfo" id="T6:U173"><span class="var type1" id="S23T5U205">dR_dq2</span>*<span class="var type1" id="S26T6U206">a_bar</span></span>,<span class="mxinfo" id="T6:U176"><span class="var type1" id="S24T5U208">dR_dq3</span>*<span class="var type1" id="S26T6U209">a_bar</span></span>,<span class="mxinfo" id="T6:U179"><span class="var type1" id="S25T5U211">dR_dq4</span>*<span class="var type1" id="S26T6U212">a_bar</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo" id="T1:U182"><span class="var type1" id="S28T1U215">rq11</span> = <span class="mxinfo" id="T1:U184"><span class="mxinfo" id="T1:U185"><span class="mxinfo" id="T1:U186"><span class="mxinfo" id="T1:U187"><span class="var type1" id="S14T1U220">q1</span>^2</span> + <span class="mxinfo" id="T1:U189"><span class="var type1" id="S15T1U223">q2</span>^2</span></span> - <span class="mxinfo" id="T1:U191"><span class="var type1" id="S16T1U226">q3</span>^2</span></span> - <span class="mxinfo" id="T1:U193"><span class="var type1" id="S17T1U229">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T1:U195"><span class="var type1" id="S29T1U233">rq12</span> = <span class="mxinfo" id="T1:U197"><span class="mxinfo" id="T1:U198">2</span>*(<span class="mxinfo" id="T1:U199"><span class="mxinfo" id="T1:U200"><span class="var type1" id="S15T1U239">q2</span>*<span class="var type1" id="S16T1U240">q3</span></span> - <span class="mxinfo" id="T1:U203"><span class="var type1" id="S14T1U242">q1</span>*<span class="var type1" id="S17T1U243">q4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T1:U206"><span class="var type1" id="S30T1U246">rq13</span> = <span class="mxinfo" id="T1:U208"><span class="mxinfo" id="T1:U209">2</span>*(<span class="mxinfo" id="T1:U210"><span class="mxinfo" id="T1:U211"><span class="var type1" id="S15T1U252">q2</span>*<span class="var type1" id="S17T1U253">q4</span></span> + <span class="mxinfo" id="T1:U214"><span class="var type1" id="S14T1U255">q1</span>*<span class="var type1" id="S16T1U256">q3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T1:U217"><span class="var type1" id="S31T1U259">rq21</span> = <span class="mxinfo" id="T1:U219"><span class="mxinfo" id="T1:U220">2</span>*(<span class="mxinfo" id="T1:U221"><span class="mxinfo" id="T1:U222"><span class="var type1" id="S15T1U265">q2</span>*<span class="var type1" id="S16T1U266">q3</span></span> + <span class="mxinfo" id="T1:U225"><span class="var type1" id="S14T1U268">q1</span>*<span class="var type1" id="S17T1U269">q4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo" id="T1:U228"><span class="var type1" id="S32T1U272">rq22</span> = <span class="mxinfo" id="T1:U230"><span class="mxinfo" id="T1:U231"><span class="mxinfo" id="T1:U232"><span class="mxinfo" id="T1:U233"><span class="var type1" id="S14T1U277">q1</span>^2</span> - <span class="mxinfo" id="T1:U235"><span class="var type1" id="S15T1U280">q2</span>^2</span></span> + <span class="mxinfo" id="T1:U237"><span class="var type1" id="S16T1U283">q3</span>^2</span></span> - <span class="mxinfo" id="T1:U239"><span class="var type1" id="S17T1U286">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T1:U241"><span class="var type1" id="S33T1U290">rq23</span> = <span class="mxinfo" id="T1:U243"><span class="mxinfo" id="T1:U244">2</span>*(<span class="mxinfo" id="T1:U245"><span class="mxinfo" id="T1:U246"><span class="var type1" id="S16T1U296">q3</span>*<span class="var type1" id="S17T1U297">q4</span></span> - <span class="mxinfo" id="T1:U249"><span class="var type1" id="S14T1U299">q1</span>*<span class="var type1" id="S15T1U300">q2</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo" id="T1:U252"><span class="var type1" id="S34T1U303">rq31</span> = <span class="mxinfo" id="T1:U254"><span class="mxinfo" id="T1:U255">2</span>*(<span class="mxinfo" id="T1:U256"><span class="mxinfo" id="T1:U257"><span class="var type1" id="S15T1U309">q2</span>*<span class="var type1" id="S17T1U310">q4</span></span> - <span class="mxinfo" id="T1:U260"><span class="var type1" id="S14T1U312">q1</span>*<span class="var type1" id="S16T1U313">q3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo" id="T1:U263"><span class="var type1" id="S35T1U316">rq32</span> = <span class="mxinfo" id="T1:U265"><span class="mxinfo" id="T1:U266">2</span>*(<span class="mxinfo" id="T1:U267"><span class="mxinfo" id="T1:U268"><span class="var type1" id="S16T1U322">q3</span>*<span class="var type1" id="S17T1U323">q4</span></span> + <span class="mxinfo" id="T1:U271"><span class="var type1" id="S14T1U325">q1</span>*<span class="var type1" id="S15T1U326">q2</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo" id="T1:U274"><span class="var type1" id="S36T1U329">rq33</span> = <span class="mxinfo" id="T1:U276"><span class="mxinfo" id="T1:U277"><span class="mxinfo" id="T1:U278"><span class="mxinfo" id="T1:U279"><span class="var type1" id="S14T1U334">q1</span>^2</span> - <span class="mxinfo" id="T1:U281"><span class="var type1" id="S15T1U337">q2</span>^2</span></span> - <span class="mxinfo" id="T1:U283"><span class="var type1" id="S16T1U340">q3</span>^2</span></span> + <span class="mxinfo" id="T1:U285"><span class="var type1" id="S17T1U343">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo" id="T5:U287"><span class="var type1" id="S37T5U347">Rq</span> = <span class="mxinfo" id="T5:U289">[<span class="mxinfo" id="T17:U290"><span class="var type1" id="S28T1U350">rq11</span> <span class="var type1" id="S29T1U351">rq12</span> <span class="var type1" id="S30T1U352">rq13</span></span>; <span class="mxinfo" id="T17:U294"><span class="var type1" id="S31T1U354">rq21</span> <span class="var type1" id="S32T1U355">rq22</span> <span class="var type1" id="S33T1U356">rq23</span></span>; <span class="mxinfo" id="T17:U298"><span class="var type1" id="S34T1U358">rq31</span> <span class="var type1" id="S35T1U359">rq32</span> <span class="var type1" id="S36T1U360">rq33</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,62" id="srcline62"> 62</a></span><span class="line">    <span class="mxinfo" id="T5:U302"><span class="var type1" id="S38T5U363">da_dab</span> = <span class="mxinfo" id="T5:U304">-<span class="var type1" id="S37T5U365">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo" id="T39:U306"><span class="var type1" id="S39T39U368">dv_dx</span> = <span class="mxinfo" id="T39:U308">[<span class="mxinfo" id="T5:U309">zeros(<span class="mxinfo" id="T1:U310">3</span>,<span class="mxinfo" id="T1:U311">3</span>)</span>,<span class="mxinfo" id="T5:U312">eye(3)</span>,<span class="mxinfo" id="T36:U313"><span class="var type1" id="S8T1U379">dt</span>*<span class="var type1" id="S27T36U380">da_dq</span></span>,<span class="mxinfo" id="T5:U316">zeros(<span class="mxinfo" id="T1:U317">3</span>,<span class="mxinfo" id="T1:U318">3</span>)</span>,<span class="mxinfo" id="T5:U319"><span class="var type1" id="S8T1U386">dt</span>*<span class="var type1" id="S38T5U387">da_dab</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,64" id="srcline64"> 64</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo" id="T6:U322"><span class="var type1" id="S40T6U390">w_bar</span> = <span class="mxinfo" id="T6:U324"><span class="mxinfo" id="T6:U325"><span class="var type1" id="S6T35U393">u</span>(<span class="mxinfo" id="T17:U327"><span class="mxinfo" id="T1:U328">1</span>:<span class="mxinfo" id="T1:U329">3</span></span>)</span> - <span class="var type1" id="S10T6U397">w_bias</span></span></span>;   <span class="comment">% bias removed</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo" id="T1:U331"><span class="var type1" id="S41T1U400">w_bar_x</span> = <span class="mxinfo" id="T1:U333"><span class="var type1" id="S40T6U402">w_bar</span>(<span class="mxinfo" id="T1:U335">1</span>)</span></span>;<span class="mxinfo" id="T1:U336"><span class="var type1" id="S42T1U406">w_bar_y</span> = <span class="mxinfo" id="T1:U338"><span class="var type1" id="S40T6U408">w_bar</span>(<span class="mxinfo" id="T1:U340">2</span>)</span></span>;<span class="mxinfo" id="T1:U341"><span class="var type1" id="S43T1U412">w_bar_z</span> = <span class="mxinfo" id="T1:U343"><span class="var type1" id="S40T6U414">w_bar</span>(<span class="mxinfo" id="T1:U345">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo" id="T38:U346"><span class="var type1" id="S44T38U418">dq_dq</span> = <span class="mxinfo" id="T38:U348">[<span class="mxinfo" id="T18:U349"><span class="mxinfo" id="T1:U350">1</span> <span class="mxinfo" id="T1:U351"><span class="mxinfo" id="T1:U352"><span class="mxinfo" id="T1:U353">-<span class="var type1" id="S41T1U425">w_bar_x</span></span>*<span class="var type1" id="S8T1U426">dt</span></span>/<span class="mxinfo" id="T1:U356">2</span></span> <span class="mxinfo" id="T1:U357"><span class="mxinfo" id="T1:U358"><span class="mxinfo" id="T1:U359">-<span class="var type1" id="S42T1U431">w_bar_y</span></span>*<span class="var type1" id="S8T1U432">dt</span></span>/<span class="mxinfo" id="T1:U362">2</span></span> <span class="mxinfo" id="T1:U363"><span class="mxinfo" id="T1:U364"><span class="mxinfo" id="T1:U365">-<span class="var type1" id="S43T1U437">w_bar_z</span></span>*<span class="var type1" id="S8T1U438">dt</span></span>/<span class="mxinfo" id="T1:U368">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T38:U346"><span class="mxinfo" id="T38:U348">        <span class="mxinfo" id="T18:U369"><span class="mxinfo" id="T1:U370"><span class="mxinfo" id="T1:U371"><span class="var type1" id="S41T1U443">w_bar_x</span>*<span class="var type1" id="S8T1U444">dt</span></span>/<span class="mxinfo" id="T1:U374">2</span></span> <span class="mxinfo" id="T1:U375">1</span> <span class="mxinfo" id="T1:U376"><span class="mxinfo" id="T1:U377"><span class="var type1" id="S43T1U449">w_bar_z</span>*<span class="var type1" id="S8T1U450">dt</span></span>/<span class="mxinfo" id="T1:U380">2</span></span> <span class="mxinfo" id="T1:U381"><span class="mxinfo" id="T1:U382"><span class="mxinfo" id="T1:U383">-<span class="var type1" id="S42T1U455">w_bar_y</span></span>*<span class="var type1" id="S8T1U456">dt</span></span>/<span class="mxinfo" id="T1:U386">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T38:U346"><span class="mxinfo" id="T38:U348">        <span class="mxinfo" id="T18:U387"><span class="mxinfo" id="T1:U388"><span class="mxinfo" id="T1:U389"><span class="var type1" id="S42T1U461">w_bar_y</span>*<span class="var type1" id="S8T1U462">dt</span></span>/<span class="mxinfo" id="T1:U392">2</span></span> <span class="mxinfo" id="T1:U393"><span class="mxinfo" id="T1:U394"><span class="mxinfo" id="T1:U395">-<span class="var type1" id="S43T1U467">w_bar_z</span></span>*<span class="var type1" id="S8T1U468">dt</span></span>/<span class="mxinfo" id="T1:U398">2</span></span> <span class="mxinfo" id="T1:U399">1</span> <span class="mxinfo" id="T1:U400"><span class="mxinfo" id="T1:U401"><span class="var type1" id="S41T1U473">w_bar_x</span>*<span class="var type1" id="S8T1U474">dt</span></span>/<span class="mxinfo" id="T1:U404">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo" id="T38:U346"><span class="mxinfo" id="T38:U348">        <span class="mxinfo" id="T18:U405"><span class="mxinfo" id="T1:U406"><span class="mxinfo" id="T1:U407"><span class="var type1" id="S43T1U479">w_bar_z</span>*<span class="var type1" id="S8T1U480">dt</span></span>/<span class="mxinfo" id="T1:U410">2</span></span> <span class="mxinfo" id="T1:U411"><span class="mxinfo" id="T1:U412"><span class="var type1" id="S42T1U484">w_bar_y</span>*<span class="var type1" id="S8T1U485">dt</span></span>/<span class="mxinfo" id="T1:U415">2</span></span> <span class="mxinfo" id="T1:U416"><span class="mxinfo" id="T1:U417"><span class="mxinfo" id="T1:U418">-<span class="var type1" id="S41T1U490">w_bar_x</span></span>*<span class="var type1" id="S8T1U491">dt</span></span>/<span class="mxinfo" id="T1:U421">2</span></span> <span class="mxinfo" id="T1:U422">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,71" id="srcline71"> 71</a></span><span class="line">    <span class="mxinfo" id="T37:U423"><span class="var type1" id="S45T37U496">dq_dw</span> = <span class="mxinfo" id="T37:U425"><span class="mxinfo" id="T1:U426"><span class="var type1" id="S8T1U499">dt</span>/<span class="mxinfo" id="T1:U428">2</span></span>*<span class="mxinfo" id="T37:U429">[<span class="mxinfo" id="T17:U430"><span class="var type1" id="S15T1U503">q2</span> <span class="var type1" id="S16T1U504">q3</span> <span class="var type1" id="S17T1U505">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo" id="T37:U423"><span class="mxinfo" id="T37:U425"><span class="mxinfo" id="T37:U429">        <span class="mxinfo" id="T17:U434"><span class="mxinfo" id="T1:U435">-<span class="var type1" id="S14T1U508">q1</span></span> <span class="var type1" id="S17T1U509">q4</span> <span class="mxinfo" id="T1:U438">-<span class="var type1" id="S16T1U511">q3</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T37:U423"><span class="mxinfo" id="T37:U425"><span class="mxinfo" id="T37:U429">        <span class="mxinfo" id="T17:U440"><span class="mxinfo" id="T1:U441">-<span class="var type1" id="S17T1U514">q4</span></span> <span class="mxinfo" id="T1:U443">-<span class="var type1" id="S14T1U516">q1</span></span> <span class="var type1" id="S15T1U517">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo" id="T37:U423"><span class="mxinfo" id="T37:U425"><span class="mxinfo" id="T37:U429">        <span class="mxinfo" id="T17:U446"><span class="var type1" id="S16T1U519">q3</span> <span class="mxinfo" id="T1:U448">-<span class="var type1" id="S15T1U521">q2</span></span> <span class="mxinfo" id="T1:U450">-<span class="var type1" id="S14T1U523">q1</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,75" id="srcline75"> 75</a></span><span class="line">    <span class="mxinfo" id="T40:U452"><span class="var type1" id="S46T40U526">dq_dx</span> = <span class="mxinfo" id="T40:U454">[<span class="mxinfo" id="T37:U455">zeros(<span class="mxinfo" id="T1:U456">4</span>,<span class="mxinfo" id="T1:U457">3</span>)</span>,<span class="mxinfo" id="T37:U458">zeros(<span class="mxinfo" id="T1:U459">4</span>,<span class="mxinfo" id="T1:U460">3</span>)</span>,<span class="var type1" id="S44T38U537">dq_dq</span>,<span class="var type1" id="S45T37U538">dq_dw</span>,<span class="mxinfo" id="T37:U463">zeros(<span class="mxinfo" id="T1:U464">4</span>,<span class="mxinfo" id="T1:U465">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo" id="T39:U466"><span class="var type1" id="S47T39U545">dwb_dx</span> = <span class="mxinfo" id="T39:U468">[<span class="mxinfo" id="T5:U469">zeros(<span class="mxinfo" id="T1:U470">3</span>,<span class="mxinfo" id="T1:U471">3</span>)</span>,<span class="mxinfo" id="T5:U472">zeros(<span class="mxinfo" id="T1:U473">3</span>,<span class="mxinfo" id="T1:U474">3</span>)</span>,<span class="mxinfo" id="T36:U475">zeros(<span class="mxinfo" id="T1:U476">3</span>,<span class="mxinfo" id="T1:U477">4</span>)</span>,<span class="mxinfo" id="T5:U478">eye(3)</span>,<span class="mxinfo" id="T5:U479">zeros(<span class="mxinfo" id="T1:U480">3</span>,<span class="mxinfo" id="T1:U481">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T39:U482"><span class="var type1" id="S48T39U569">dab_dx</span> = <span class="mxinfo" id="T39:U484">[<span class="mxinfo" id="T5:U485">zeros(<span class="mxinfo" id="T1:U486">3</span>,<span class="mxinfo" id="T1:U487">3</span>)</span>,<span class="mxinfo" id="T5:U488">zeros(<span class="mxinfo" id="T1:U489">3</span>,<span class="mxinfo" id="T1:U490">3</span>)</span>,<span class="mxinfo" id="T36:U491">zeros(<span class="mxinfo" id="T1:U492">3</span>,<span class="mxinfo" id="T1:U493">4</span>)</span>,<span class="mxinfo" id="T5:U494">zeros(<span class="mxinfo" id="T1:U495">3</span>,<span class="mxinfo" id="T1:U496">3</span>)</span>,<span class="mxinfo" id="T5:U497">eye(3)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo" id="T29:U498"><span class="var type1" id="S18T29U593">A</span> = <span class="mxinfo" id="T29:U500">[<span class="var type1" id="S20T39U596">dp_dx</span>;<span class="var type1" id="S39T39U598">dv_dx</span>;<span class="var type1" id="S46T40U600">dq_dx</span>;<span class="var type1" id="S47T39U602">dwb_dx</span>;<span class="var type1" id="S48T39U604">dab_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,79" id="srcline79"> 79</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo" id="T43:U506"><span class="var type1" id="S49T43U607">W</span> = <span class="mxinfo" id="T43:U508">zeros(<span class="mxinfo" id="T1:U509">16</span>,<span class="mxinfo" id="T1:U510">18</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,81" id="srcline81"> 81</a></span><span class="line">    <span class="mxinfo" id="T41:U511"><span class="var type1" id="S50T41U614">dfp_de</span> = <span class="mxinfo" id="T41:U513">[eye(3),zeros(3,3),zeros(3,3),zeros(3,3),zeros(3,3),zeros(3,3)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,82" id="srcline82"> 82</a></span><span class="line">    <span class="mxinfo" id="T5:U514"><span class="var type1" id="S51T5U642">dfv_dea</span> = <span class="mxinfo" id="T5:U516"><span class="var type1" id="S8T1U644">dt</span>*<span class="var type1" id="S37T5U645">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,83" id="srcline83"> 83</a></span><span class="line">    <span class="mxinfo" id="T5:U519"><span class="var type1" id="S52T5U648">dfv_deab</span> = <span class="mxinfo" id="T5:U521"><span class="mxinfo" id="T1:U522">-<span class="var type1" id="S8T1U651">dt</span></span>*<span class="var type1" id="S37T5U652">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo" id="T41:U525"><span class="var type1" id="S53T41U655">dfv_de</span> = <span class="mxinfo" id="T41:U527">[<span class="mxinfo" id="T5:U528">zeros(<span class="mxinfo" id="T1:U529">3</span>,<span class="mxinfo" id="T1:U530">3</span>)</span>,<span class="mxinfo" id="T5:U531">eye(3,3)</span>,<span class="var type1" id="S51T5U666">dfv_dea</span>,<span class="mxinfo" id="T5:U533">zeros(<span class="mxinfo" id="T1:U534">3</span>,<span class="mxinfo" id="T1:U535">3</span>)</span>,<span class="mxinfo" id="T5:U536">zeros(<span class="mxinfo" id="T1:U537">3</span>,<span class="mxinfo" id="T1:U538">3</span>)</span>,<span class="var type1" id="S52T5U675">dfv_deab</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo" id="T37:U540"><span class="var type1" id="S54T37U678">dfq_dew</span> = <span class="mxinfo" id="T37:U542"><span class="mxinfo" id="T1:U543"><span class="mxinfo" id="T1:U544">0.5</span>*<span class="var type1" id="S8T1U682">dt</span></span>*<span class="mxinfo" id="T37:U546">[<span class="mxinfo" id="T17:U547"><span class="mxinfo" id="T1:U548">-<span class="var type1" id="S15T1U686">q2</span></span> <span class="mxinfo" id="T1:U550">-<span class="var type1" id="S16T1U688">q3</span></span> <span class="mxinfo" id="T1:U552">-<span class="var type1" id="S17T1U690">q4</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo" id="T37:U540"><span class="mxinfo" id="T37:U542"><span class="mxinfo" id="T37:U546">        <span class="mxinfo" id="T17:U554"><span class="var type1" id="S14T1U692">q1</span> <span class="mxinfo" id="T1:U556">-<span class="var type1" id="S17T1U694">q4</span></span> <span class="var type1" id="S16T1U695">q3</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T37:U540"><span class="mxinfo" id="T37:U542"><span class="mxinfo" id="T37:U546">        <span class="mxinfo" id="T17:U559"><span class="var type1" id="S17T1U697">q4</span> <span class="var type1" id="S14T1U698">q1</span> <span class="mxinfo" id="T1:U562">-<span class="var type1" id="S15T1U700">q2</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,88" id="srcline88"> 88</a></span><span class="line"><span class="mxinfo" id="T37:U540"><span class="mxinfo" id="T37:U542"><span class="mxinfo" id="T37:U546">        <span class="mxinfo" id="T17:U564"><span class="mxinfo" id="T1:U565">-<span class="var type1" id="S16T1U703">q3</span></span> <span class="var type1" id="S15T1U704">q2</span> <span class="var type1" id="S14T1U705">q1</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo" id="T37:U569"><span class="var type1" id="S55T37U708">dfq_dewb</span> = <span class="mxinfo" id="T37:U571"><span class="mxinfo" id="T1:U572"><span class="mxinfo" id="T1:U573">0.5</span>*<span class="var type1" id="S8T1U712">dt</span></span>*<span class="mxinfo" id="T37:U575">[<span class="mxinfo" id="T17:U576"><span class="var type1" id="S15T1U715">q2</span> <span class="var type1" id="S16T1U716">q3</span> <span class="var type1" id="S17T1U717">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo" id="T37:U569"><span class="mxinfo" id="T37:U571"><span class="mxinfo" id="T37:U575">        <span class="mxinfo" id="T17:U580"><span class="mxinfo" id="T1:U581">-<span class="var type1" id="S14T1U720">q1</span></span> <span class="var type1" id="S17T1U721">q4</span> <span class="mxinfo" id="T1:U584">-<span class="var type1" id="S16T1U723">q3</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo" id="T37:U569"><span class="mxinfo" id="T37:U571"><span class="mxinfo" id="T37:U575">        <span class="mxinfo" id="T17:U586"><span class="mxinfo" id="T1:U587">-<span class="var type1" id="S17T1U726">q4</span></span> <span class="mxinfo" id="T1:U589">-<span class="var type1" id="S14T1U728">q1</span></span> <span class="var type1" id="S15T1U729">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="71,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T37:U569"><span class="mxinfo" id="T37:U571"><span class="mxinfo" id="T37:U575">        <span class="mxinfo" id="T17:U592"><span class="var type1" id="S16T1U731">q3</span> <span class="mxinfo" id="T1:U594">-<span class="var type1" id="S15T1U733">q2</span></span> <span class="mxinfo" id="T1:U596">-<span class="var type1" id="S14T1U735">q1</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T42:U598"><span class="var type1" id="S56T42U738">dfq_de</span> = <span class="mxinfo" id="T42:U600">[<span class="mxinfo" id="T37:U601">zeros(<span class="mxinfo" id="T1:U602">4</span>,<span class="mxinfo" id="T1:U603">3</span>)</span>,<span class="mxinfo" id="T37:U604">zeros(<span class="mxinfo" id="T1:U605">4</span>,<span class="mxinfo" id="T1:U606">3</span>)</span>,<span class="mxinfo" id="T37:U607">zeros(<span class="mxinfo" id="T1:U608">4</span>,<span class="mxinfo" id="T1:U609">3</span>)</span>,<span class="var type1" id="S54T37U753">dfq_dew</span>,<span class="var type1" id="S55T37U754">dfq_dewb</span>,<span class="mxinfo" id="T37:U612">zeros(<span class="mxinfo" id="T1:U613">4</span>,<span class="mxinfo" id="T1:U614">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,94" id="srcline94"> 94</a></span><span class="line">    <span class="mxinfo" id="T41:U615"><span class="var type1" id="S57T41U761">dfwb_de</span> = <span class="mxinfo" id="T41:U617">[<span class="mxinfo" id="T5:U618">zeros(<span class="mxinfo" id="T1:U619">3</span>,<span class="mxinfo" id="T1:U620">3</span>)</span>,<span class="mxinfo" id="T5:U621">zeros(<span class="mxinfo" id="T1:U622">3</span>,<span class="mxinfo" id="T1:U623">3</span>)</span>,<span class="mxinfo" id="T5:U624">zeros(<span class="mxinfo" id="T1:U625">3</span>,<span class="mxinfo" id="T1:U626">3</span>)</span>,<span class="mxinfo" id="T5:U627">zeros(<span class="mxinfo" id="T1:U628">3</span>,<span class="mxinfo" id="T1:U629">3</span>)</span>,<span class="mxinfo" id="T5:U630"><span class="var type1" id="S8T1U781">dt</span>*<span class="mxinfo" id="T5:U632">eye(3)</span></span>,<span class="mxinfo" id="T5:U633">zeros(<span class="mxinfo" id="T1:U634">3</span>,<span class="mxinfo" id="T1:U635">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo" id="T41:U636"><span class="var type1" id="S58T41U791">dfab_de</span> = <span class="mxinfo" id="T41:U638">[<span class="mxinfo" id="T5:U639">zeros(<span class="mxinfo" id="T1:U640">3</span>,<span class="mxinfo" id="T1:U641">3</span>)</span>,<span class="mxinfo" id="T5:U642">zeros(<span class="mxinfo" id="T1:U643">3</span>,<span class="mxinfo" id="T1:U644">3</span>)</span>,<span class="mxinfo" id="T5:U645">zeros(<span class="mxinfo" id="T1:U646">3</span>,<span class="mxinfo" id="T1:U647">3</span>)</span>,<span class="mxinfo" id="T5:U648">zeros(<span class="mxinfo" id="T1:U649">3</span>,<span class="mxinfo" id="T1:U650">3</span>)</span>,<span class="mxinfo" id="T5:U651">zeros(<span class="mxinfo" id="T1:U652">3</span>,<span class="mxinfo" id="T1:U653">3</span>)</span>,<span class="mxinfo" id="T5:U654"><span class="var type1" id="S8T1U815">dt</span>*<span class="mxinfo" id="T5:U656">eye(3)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo" id="T43:U657"><span class="var type1" id="S49T43U821">W</span> = <span class="mxinfo" id="T43:U659">[<span class="var type1" id="S50T41U824">dfp_de</span>;<span class="var type1" id="S53T41U826">dfv_de</span>;<span class="var type1" id="S56T42U828">dfq_de</span>;<span class="var type1" id="S57T41U830">dfwb_de</span>;<span class="var type1" id="S58T41U832">dfab_de</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,97" id="srcline97"> 97</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="71,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo" id="T29:U665"><span class="var type1" id="S3T29U835">Cov</span> = <span class="mxinfo" id="T29:U667"><span class="mxinfo" id="T29:U668"><span class="mxinfo" id="T29:U669"><span class="var type1" id="S18T29U839">A</span>*<span class="var type1" id="S5T29U840">P</span></span>*<span class="mxinfo" id="T29:U672"><span class="var type1" id="S18T29U842">A</span>'</span></span> + <span class="mxinfo" id="T29:U674"><span class="mxinfo" id="T43:U675"><span class="var type1" id="S49T43U845">W</span>*<span class="var type1" id="S7T44U846">Q</span></span>*<span class="mxinfo" id="T45:U678"><span class="var type1" id="S49T43U848">W</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="71,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">%     CovAug = (-1/4)*df2^2*P^2;</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,100" id="srcline100">100</a></span><span class="line"><span class="comment">%     Cov = Cov + CovAug;</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,101" id="srcline101">101</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="71,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="71,103" id="srcline103">103</a></span><span class="line"><span class="comment">% implements discrete state differential step</span></span></span>
</pre>
