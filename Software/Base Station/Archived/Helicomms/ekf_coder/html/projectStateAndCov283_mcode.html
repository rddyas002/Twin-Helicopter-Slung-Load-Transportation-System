<pre class="code">
<span class="srcline"><span class="lineno"><a href="69,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">mean</span>,<span class="var type1" id="S3T27U4">Cov</span>] = projectStateAndCov(<span class="var type1" id="S4T7U7">x</span>,<span class="var type1" id="S5T27U8">P</span>,<span class="var type1" id="S6T37U9">u</span>,<span class="var type1" id="S7T46U10">Q</span>,<span class="var type1" id="S8T1U11">dt</span>,<span class="var type1" id="S9T6U12">static_acceleration_earth</span>)<span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% implements state prediction phase of KF</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,3" id="srcline3">  3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="69,4" id="srcline4">  4</a></span><span class="line">    <span class="comment">% state order</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,5" id="srcline5">  5</a></span><span class="line">    <span class="comment">% x = [p v q w a]^T;</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">% p = x[1:3]: platform position w.r.t. room</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,7" id="srcline7">  7</a></span><span class="line">    <span class="comment">% v = x[4:6]: platform velocity w.r.t. room</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,8" id="srcline8">  8</a></span><span class="line">    <span class="comment">% q = x[7:10]: quaternion representing attitude between room and platform</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,9" id="srcline9">  9</a></span><span class="line">    <span class="comment">% w = x[11:13]: gyro bias</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">% a = x[14:16]: accelerometer bais</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,11" id="srcline11"> 11</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,12" id="srcline12"> 12</a></span><span class="line">    <span class="mxinfo" id="T6:U9"><span class="var type1" id="S10T6U15">w_bias</span> = <span class="mxinfo" id="T6:U11"><span class="var type1" id="S4T7U17">x</span>(<span class="mxinfo" id="T6:U13"><span class="mxinfo" id="T1:U14">11</span>:<span class="mxinfo" id="T1:U15">13</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo" id="T6:U16"><span class="var type1" id="S11T6U23">a_bias</span> = <span class="mxinfo" id="T6:U18"><span class="var type1" id="S4T7U25">x</span>(<span class="mxinfo" id="T6:U20"><span class="mxinfo" id="T1:U21">14</span>:<span class="mxinfo" id="T1:U22">16</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="69,15" id="srcline15"> 15</a></span><span class="line">    <span class="comment">% implement state-difference equation</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,16" id="srcline16"> 16</a></span><span class="line">    <span class="mxinfo" id="T7:U23"><span class="var type1" id="S2T7U31">mean</span> = <span class="mxinfo" id="T7:U25"><span class="fcn" id="F297N8:B33">projectState</span>(<span class="var type1" id="S4T7U34">x</span>,<span class="var type1" id="S6T37U35">u</span>,<span class="var type1" id="S8T1U36">dt</span>,<span class="var type1" id="S9T6U37">static_acceleration_earth</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%     % calculate the second order term from papoulis</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%     accl = [u(4) - a_bias(1);u(5) - a_bias(2);u(6) - a_bias(3)];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%     df2 = zeros(16,16);</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%     dr2q1 = 2*[1 0 0;0 1 0;0 0 1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%     dr2q2 = 2*[1 0 0;0 -1 0;0 0 -1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%     dr2q3 = 2*[-1 0 0;0 1 0;0 0 -1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%     dr2q4 = 2*[-1 0 0;0 -1 0;0 0 1];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%     df2(4:6,7:10) = dt*[dr2q1*accl,dr2q2*accl,dr2q3*accl,dr2q4*accl];</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%     mean = mean + (1/2)*trace(df2*P);</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,26" id="srcline26"> 26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo" id="T8:U30"><span class="var type1" id="S13T8U40">q</span> = <span class="mxinfo" id="T8:U32"><span class="var type1" id="S4T7U42">x</span>(<span class="mxinfo" id="T8:U34"><span class="mxinfo" id="T1:U35">7</span>:<span class="mxinfo" id="T1:U36">10</span></span>)</span></span>;      </span></span>
<span class="srcline"><span class="lineno"><a href="69,28" id="srcline28"> 28</a></span><span class="line">    <span class="mxinfo" id="T1:U37"><span class="var type1" id="S14T1U48">q1</span> = <span class="mxinfo" id="T1:U39"><span class="var type1" id="S13T8U50">q</span>(<span class="mxinfo" id="T1:U41">1</span>)</span></span>; <span class="mxinfo" id="T1:U42"><span class="var type1" id="S15T1U54">q2</span> = <span class="mxinfo" id="T1:U44"><span class="var type1" id="S13T8U56">q</span>(<span class="mxinfo" id="T1:U46">2</span>)</span></span>; <span class="mxinfo" id="T1:U47"><span class="var type1" id="S16T1U60">q3</span> = <span class="mxinfo" id="T1:U49"><span class="var type1" id="S13T8U62">q</span>(<span class="mxinfo" id="T1:U51">3</span>)</span></span>; <span class="mxinfo" id="T1:U52"><span class="var type1" id="S17T1U66">q4</span> = <span class="mxinfo" id="T1:U54"><span class="var type1" id="S13T8U68">q</span>(<span class="mxinfo" id="T1:U56">4</span>)</span></span>;          </span></span>
<span class="srcline"><span class="lineno"><a href="69,29" id="srcline29"> 29</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="69,30" id="srcline30"> 30</a></span><span class="line">    <span class="comment">% partial derivative of f w.r.t. the states</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,31" id="srcline31"> 31</a></span><span class="line">    <span class="mxinfo" id="T27:U57"><span class="var type1" id="S18T27U72">A</span> = <span class="mxinfo" id="T27:U59">zeros(<span class="mxinfo" id="T1:U60">16</span>,<span class="mxinfo" id="T1:U61">16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,32" id="srcline32"> 32</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo" id="T41:U62"><span class="var type1" id="S20T41U79">dp_dx</span> = <span class="mxinfo" id="T41:U64">[<span class="mxinfo" id="T5:U65">eye(3)</span>,<span class="mxinfo" id="T5:U66">eye(3)*<span class="var type1" id="S8T1U89">dt</span></span>,<span class="mxinfo" id="T38:U68">zeros(<span class="mxinfo" id="T1:U69">3</span>,<span class="mxinfo" id="T1:U70">4</span>)</span>,<span class="mxinfo" id="T5:U71">zeros(<span class="mxinfo" id="T1:U72">3</span>,<span class="mxinfo" id="T1:U73">3</span>)</span>,<span class="mxinfo" id="T5:U74">zeros(<span class="mxinfo" id="T1:U75">3</span>,<span class="mxinfo" id="T1:U76">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,34" id="srcline34"> 34</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo" id="T5:U77"><span class="var type1" id="S22T5U104">dR_dq1</span> = <span class="mxinfo" id="T5:U79">2*<span class="mxinfo" id="T5:U80">[<span class="mxinfo" id="T18:U81"><span class="var type1" id="S14T1U109">q1</span> <span class="mxinfo" id="T1:U83">-<span class="var type1" id="S17T1U111">q4</span></span> <span class="var type1" id="S16T1U112">q3</span></span>;</span></span></span> </span></span>
<span class="srcline"><span class="lineno"><a href="69,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T5:U77"><span class="mxinfo" id="T5:U79"><span class="mxinfo" id="T5:U80">                <span class="mxinfo" id="T18:U86"><span class="var type1" id="S17T1U114">q4</span> <span class="var type1" id="S14T1U115">q1</span> <span class="mxinfo" id="T1:U89">-<span class="var type1" id="S15T1U117">q2</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T5:U77"><span class="mxinfo" id="T5:U79"><span class="mxinfo" id="T5:U80">                <span class="mxinfo" id="T18:U91"><span class="mxinfo" id="T1:U92">-<span class="var type1" id="S16T1U120">q3</span></span> <span class="var type1" id="S15T1U121">q2</span> <span class="var type1" id="S14T1U122">q1</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo" id="T5:U96"><span class="var type1" id="S23T5U125">dR_dq2</span> = <span class="mxinfo" id="T5:U98">2*<span class="mxinfo" id="T5:U99">[<span class="mxinfo" id="T18:U100"><span class="var type1" id="S15T1U130">q2</span> <span class="var type1" id="S16T1U131">q3</span> <span class="var type1" id="S17T1U132">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo" id="T5:U96"><span class="mxinfo" id="T5:U98"><span class="mxinfo" id="T5:U99">                <span class="mxinfo" id="T18:U104"><span class="var type1" id="S16T1U134">q3</span> <span class="mxinfo" id="T1:U106">-<span class="var type1" id="S15T1U136">q2</span></span> <span class="mxinfo" id="T1:U108">-<span class="var type1" id="S14T1U138">q1</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo" id="T5:U96"><span class="mxinfo" id="T5:U98"><span class="mxinfo" id="T5:U99">                <span class="mxinfo" id="T18:U110"><span class="var type1" id="S17T1U140">q4</span> <span class="var type1" id="S14T1U141">q1</span> <span class="mxinfo" id="T1:U113">-<span class="var type1" id="S15T1U143">q2</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,41" id="srcline41"> 41</a></span><span class="line">    <span class="mxinfo" id="T5:U115"><span class="var type1" id="S24T5U146">dR_dq3</span> = <span class="mxinfo" id="T5:U117">2*<span class="mxinfo" id="T5:U118">[<span class="mxinfo" id="T18:U119"><span class="mxinfo" id="T1:U120">-<span class="var type1" id="S16T1U152">q3</span></span> <span class="var type1" id="S15T1U153">q2</span> <span class="var type1" id="S14T1U154">q1</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo" id="T5:U115"><span class="mxinfo" id="T5:U117"><span class="mxinfo" id="T5:U118">                <span class="mxinfo" id="T18:U124"><span class="var type1" id="S15T1U156">q2</span> <span class="var type1" id="S16T1U157">q3</span> <span class="var type1" id="S17T1U158">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T5:U115"><span class="mxinfo" id="T5:U117"><span class="mxinfo" id="T5:U118">                <span class="mxinfo" id="T18:U128"><span class="mxinfo" id="T1:U129">-<span class="var type1" id="S14T1U161">q1</span></span> <span class="var type1" id="S17T1U162">q4</span> <span class="mxinfo" id="T1:U132">-<span class="var type1" id="S16T1U164">q3</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo" id="T5:U134"><span class="var type1" id="S25T5U167">dR_dq4</span> = <span class="mxinfo" id="T5:U136">2*<span class="mxinfo" id="T5:U137">[<span class="mxinfo" id="T18:U138"><span class="mxinfo" id="T1:U139">-<span class="var type1" id="S17T1U173">q4</span></span> <span class="mxinfo" id="T1:U141">-<span class="var type1" id="S14T1U175">q1</span></span> <span class="var type1" id="S15T1U176">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo" id="T5:U134"><span class="mxinfo" id="T5:U136"><span class="mxinfo" id="T5:U137">                <span class="mxinfo" id="T18:U144"><span class="var type1" id="S14T1U178">q1</span> <span class="mxinfo" id="T1:U146">-<span class="var type1" id="S17T1U180">q4</span></span> <span class="var type1" id="S16T1U181">q3</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo" id="T5:U134"><span class="mxinfo" id="T5:U136"><span class="mxinfo" id="T5:U137">                <span class="mxinfo" id="T18:U149"><span class="var type1" id="S15T1U183">q2</span> <span class="var type1" id="S16T1U184">q3</span> <span class="var type1" id="S17T1U185">q4</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,47" id="srcline47"> 47</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="69,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo" id="T6:U153"><span class="var type1" id="S26T6U188">a_bar</span> = <span class="mxinfo" id="T6:U155"><span class="mxinfo" id="T6:U156"><span class="var type1" id="S6T37U191">u</span>(<span class="mxinfo" id="T6:U158"><span class="mxinfo" id="T1:U159">4</span>:<span class="mxinfo" id="T1:U160">6</span></span>)</span> - <span class="var type1" id="S11T6U195">a_bias</span></span></span>;   <span class="comment">% bias removed</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo" id="T38:U162"><span class="var type1" id="S27T38U198">da_dq</span> = <span class="mxinfo" id="T38:U164">[<span class="mxinfo" id="T6:U165"><span class="var type1" id="S22T5U202">dR_dq1</span>*<span class="var type1" id="S26T6U203">a_bar</span></span>,<span class="mxinfo" id="T6:U168"><span class="var type1" id="S23T5U205">dR_dq2</span>*<span class="var type1" id="S26T6U206">a_bar</span></span>,<span class="mxinfo" id="T6:U171"><span class="var type1" id="S24T5U208">dR_dq3</span>*<span class="var type1" id="S26T6U209">a_bar</span></span>,<span class="mxinfo" id="T6:U174"><span class="var type1" id="S25T5U211">dR_dq4</span>*<span class="var type1" id="S26T6U212">a_bar</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="69,51" id="srcline51"> 51</a></span><span class="line">    <span class="mxinfo" id="T1:U177"><span class="var type1" id="S28T1U215">rq11</span> = <span class="mxinfo" id="T1:U179"><span class="mxinfo" id="T1:U180"><span class="mxinfo" id="T1:U181"><span class="mxinfo" id="T1:U182"><span class="var type1" id="S14T1U220">q1</span>^2</span> + <span class="mxinfo" id="T1:U184"><span class="var type1" id="S15T1U223">q2</span>^2</span></span> - <span class="mxinfo" id="T1:U186"><span class="var type1" id="S16T1U226">q3</span>^2</span></span> - <span class="mxinfo" id="T1:U188"><span class="var type1" id="S17T1U229">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T1:U190"><span class="var type1" id="S29T1U233">rq12</span> = <span class="mxinfo" id="T1:U192"><span class="mxinfo" id="T1:U193">2</span>*(<span class="mxinfo" id="T1:U194"><span class="mxinfo" id="T1:U195"><span class="var type1" id="S15T1U239">q2</span>*<span class="var type1" id="S16T1U240">q3</span></span> - <span class="mxinfo" id="T1:U198"><span class="var type1" id="S14T1U242">q1</span>*<span class="var type1" id="S17T1U243">q4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T1:U201"><span class="var type1" id="S30T1U246">rq13</span> = <span class="mxinfo" id="T1:U203"><span class="mxinfo" id="T1:U204">2</span>*(<span class="mxinfo" id="T1:U205"><span class="mxinfo" id="T1:U206"><span class="var type1" id="S15T1U252">q2</span>*<span class="var type1" id="S17T1U253">q4</span></span> + <span class="mxinfo" id="T1:U209"><span class="var type1" id="S14T1U255">q1</span>*<span class="var type1" id="S16T1U256">q3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T1:U212"><span class="var type1" id="S31T1U259">rq21</span> = <span class="mxinfo" id="T1:U214"><span class="mxinfo" id="T1:U215">2</span>*(<span class="mxinfo" id="T1:U216"><span class="mxinfo" id="T1:U217"><span class="var type1" id="S15T1U265">q2</span>*<span class="var type1" id="S16T1U266">q3</span></span> + <span class="mxinfo" id="T1:U220"><span class="var type1" id="S14T1U268">q1</span>*<span class="var type1" id="S17T1U269">q4</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo" id="T1:U223"><span class="var type1" id="S32T1U272">rq22</span> = <span class="mxinfo" id="T1:U225"><span class="mxinfo" id="T1:U226"><span class="mxinfo" id="T1:U227"><span class="mxinfo" id="T1:U228"><span class="var type1" id="S14T1U277">q1</span>^2</span> - <span class="mxinfo" id="T1:U230"><span class="var type1" id="S15T1U280">q2</span>^2</span></span> + <span class="mxinfo" id="T1:U232"><span class="var type1" id="S16T1U283">q3</span>^2</span></span> - <span class="mxinfo" id="T1:U234"><span class="var type1" id="S17T1U286">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,56" id="srcline56"> 56</a></span><span class="line">    <span class="mxinfo" id="T1:U236"><span class="var type1" id="S33T1U290">rq23</span> = <span class="mxinfo" id="T1:U238"><span class="mxinfo" id="T1:U239">2</span>*(<span class="mxinfo" id="T1:U240"><span class="mxinfo" id="T1:U241"><span class="var type1" id="S16T1U296">q3</span>*<span class="var type1" id="S17T1U297">q4</span></span> - <span class="mxinfo" id="T1:U244"><span class="var type1" id="S14T1U299">q1</span>*<span class="var type1" id="S15T1U300">q2</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo" id="T1:U247"><span class="var type1" id="S34T1U303">rq31</span> = <span class="mxinfo" id="T1:U249"><span class="mxinfo" id="T1:U250">2</span>*(<span class="mxinfo" id="T1:U251"><span class="mxinfo" id="T1:U252"><span class="var type1" id="S15T1U309">q2</span>*<span class="var type1" id="S17T1U310">q4</span></span> - <span class="mxinfo" id="T1:U255"><span class="var type1" id="S14T1U312">q1</span>*<span class="var type1" id="S16T1U313">q3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo" id="T1:U258"><span class="var type1" id="S35T1U316">rq32</span> = <span class="mxinfo" id="T1:U260"><span class="mxinfo" id="T1:U261">2</span>*(<span class="mxinfo" id="T1:U262"><span class="mxinfo" id="T1:U263"><span class="var type1" id="S16T1U322">q3</span>*<span class="var type1" id="S17T1U323">q4</span></span> + <span class="mxinfo" id="T1:U266"><span class="var type1" id="S14T1U325">q1</span>*<span class="var type1" id="S15T1U326">q2</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo" id="T1:U269"><span class="var type1" id="S36T1U329">rq33</span> = <span class="mxinfo" id="T1:U271"><span class="mxinfo" id="T1:U272"><span class="mxinfo" id="T1:U273"><span class="mxinfo" id="T1:U274"><span class="var type1" id="S14T1U334">q1</span>^2</span> - <span class="mxinfo" id="T1:U276"><span class="var type1" id="S15T1U337">q2</span>^2</span></span> - <span class="mxinfo" id="T1:U278"><span class="var type1" id="S16T1U340">q3</span>^2</span></span> + <span class="mxinfo" id="T1:U280"><span class="var type1" id="S17T1U343">q4</span>^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,60" id="srcline60"> 60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="69,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo" id="T5:U282"><span class="var type1" id="S37T5U347">Rq</span> = <span class="mxinfo" id="T5:U284">[<span class="mxinfo" id="T18:U285"><span class="var type1" id="S28T1U350">rq11</span> <span class="var type1" id="S29T1U351">rq12</span> <span class="var type1" id="S30T1U352">rq13</span></span>; <span class="mxinfo" id="T18:U289"><span class="var type1" id="S31T1U354">rq21</span> <span class="var type1" id="S32T1U355">rq22</span> <span class="var type1" id="S33T1U356">rq23</span></span>; <span class="mxinfo" id="T18:U293"><span class="var type1" id="S34T1U358">rq31</span> <span class="var type1" id="S35T1U359">rq32</span> <span class="var type1" id="S36T1U360">rq33</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,62" id="srcline62"> 62</a></span><span class="line">    <span class="mxinfo" id="T5:U297"><span class="var type1" id="S38T5U363">da_dab</span> = <span class="mxinfo" id="T5:U299">-<span class="var type1" id="S37T5U365">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo" id="T41:U301"><span class="var type1" id="S39T41U368">dv_dx</span> = <span class="mxinfo" id="T41:U303">[<span class="mxinfo" id="T5:U304">zeros(<span class="mxinfo" id="T1:U305">3</span>,<span class="mxinfo" id="T1:U306">3</span>)</span>,<span class="mxinfo" id="T5:U307">eye(3)</span>,<span class="mxinfo" id="T38:U308"><span class="var type1" id="S8T1U379">dt</span>*<span class="var type1" id="S27T38U380">da_dq</span></span>,<span class="mxinfo" id="T5:U311">zeros(<span class="mxinfo" id="T1:U312">3</span>,<span class="mxinfo" id="T1:U313">3</span>)</span>,<span class="mxinfo" id="T5:U314"><span class="var type1" id="S8T1U386">dt</span>*<span class="var type1" id="S38T5U387">da_dab</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,64" id="srcline64"> 64</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo" id="T6:U317"><span class="var type1" id="S40T6U390">w_bar</span> = <span class="mxinfo" id="T6:U319"><span class="mxinfo" id="T6:U320"><span class="var type1" id="S6T37U393">u</span>(<span class="mxinfo" id="T6:U322"><span class="mxinfo" id="T1:U323">1</span>:<span class="mxinfo" id="T1:U324">3</span></span>)</span> - <span class="var type1" id="S10T6U397">w_bias</span></span></span>;   <span class="comment">% bias removed</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo" id="T1:U326"><span class="var type1" id="S41T1U400">w_bar_x</span> = <span class="mxinfo" id="T1:U328"><span class="var type1" id="S40T6U402">w_bar</span>(<span class="mxinfo" id="T1:U330">1</span>)</span></span>;<span class="mxinfo" id="T1:U331"><span class="var type1" id="S42T1U406">w_bar_y</span> = <span class="mxinfo" id="T1:U333"><span class="var type1" id="S40T6U408">w_bar</span>(<span class="mxinfo" id="T1:U335">2</span>)</span></span>;<span class="mxinfo" id="T1:U336"><span class="var type1" id="S43T1U412">w_bar_z</span> = <span class="mxinfo" id="T1:U338"><span class="var type1" id="S40T6U414">w_bar</span>(<span class="mxinfo" id="T1:U340">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,67" id="srcline67"> 67</a></span><span class="line">    <span class="mxinfo" id="T40:U341"><span class="var type1" id="S44T40U418">dq_dq</span> = <span class="mxinfo" id="T40:U343">[<span class="mxinfo" id="T19:U344"><span class="mxinfo" id="T1:U345">1</span> <span class="mxinfo" id="T1:U346"><span class="mxinfo" id="T1:U347"><span class="mxinfo" id="T1:U348">-<span class="var type1" id="S41T1U425">w_bar_x</span></span>*<span class="var type1" id="S8T1U426">dt</span></span>/<span class="mxinfo" id="T1:U351">2</span></span> <span class="mxinfo" id="T1:U352"><span class="mxinfo" id="T1:U353"><span class="mxinfo" id="T1:U354">-<span class="var type1" id="S42T1U431">w_bar_y</span></span>*<span class="var type1" id="S8T1U432">dt</span></span>/<span class="mxinfo" id="T1:U357">2</span></span> <span class="mxinfo" id="T1:U358"><span class="mxinfo" id="T1:U359"><span class="mxinfo" id="T1:U360">-<span class="var type1" id="S43T1U437">w_bar_z</span></span>*<span class="var type1" id="S8T1U438">dt</span></span>/<span class="mxinfo" id="T1:U363">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,68" id="srcline68"> 68</a></span><span class="line"><span class="mxinfo" id="T40:U341"><span class="mxinfo" id="T40:U343">        <span class="mxinfo" id="T19:U364"><span class="mxinfo" id="T1:U365"><span class="mxinfo" id="T1:U366"><span class="var type1" id="S41T1U443">w_bar_x</span>*<span class="var type1" id="S8T1U444">dt</span></span>/<span class="mxinfo" id="T1:U369">2</span></span> <span class="mxinfo" id="T1:U370">1</span> <span class="mxinfo" id="T1:U371"><span class="mxinfo" id="T1:U372"><span class="var type1" id="S43T1U449">w_bar_z</span>*<span class="var type1" id="S8T1U450">dt</span></span>/<span class="mxinfo" id="T1:U375">2</span></span> <span class="mxinfo" id="T1:U376"><span class="mxinfo" id="T1:U377"><span class="mxinfo" id="T1:U378">-<span class="var type1" id="S42T1U455">w_bar_y</span></span>*<span class="var type1" id="S8T1U456">dt</span></span>/<span class="mxinfo" id="T1:U381">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo" id="T40:U341"><span class="mxinfo" id="T40:U343">        <span class="mxinfo" id="T19:U382"><span class="mxinfo" id="T1:U383"><span class="mxinfo" id="T1:U384"><span class="var type1" id="S42T1U461">w_bar_y</span>*<span class="var type1" id="S8T1U462">dt</span></span>/<span class="mxinfo" id="T1:U387">2</span></span> <span class="mxinfo" id="T1:U388"><span class="mxinfo" id="T1:U389"><span class="mxinfo" id="T1:U390">-<span class="var type1" id="S43T1U467">w_bar_z</span></span>*<span class="var type1" id="S8T1U468">dt</span></span>/<span class="mxinfo" id="T1:U393">2</span></span> <span class="mxinfo" id="T1:U394">1</span> <span class="mxinfo" id="T1:U395"><span class="mxinfo" id="T1:U396"><span class="var type1" id="S41T1U473">w_bar_x</span>*<span class="var type1" id="S8T1U474">dt</span></span>/<span class="mxinfo" id="T1:U399">2</span></span></span>;</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,70" id="srcline70"> 70</a></span><span class="line"><span class="mxinfo" id="T40:U341"><span class="mxinfo" id="T40:U343">        <span class="mxinfo" id="T19:U400"><span class="mxinfo" id="T1:U401"><span class="mxinfo" id="T1:U402"><span class="var type1" id="S43T1U479">w_bar_z</span>*<span class="var type1" id="S8T1U480">dt</span></span>/<span class="mxinfo" id="T1:U405">2</span></span> <span class="mxinfo" id="T1:U406"><span class="mxinfo" id="T1:U407"><span class="var type1" id="S42T1U484">w_bar_y</span>*<span class="var type1" id="S8T1U485">dt</span></span>/<span class="mxinfo" id="T1:U410">2</span></span> <span class="mxinfo" id="T1:U411"><span class="mxinfo" id="T1:U412"><span class="mxinfo" id="T1:U413">-<span class="var type1" id="S41T1U490">w_bar_x</span></span>*<span class="var type1" id="S8T1U491">dt</span></span>/<span class="mxinfo" id="T1:U416">2</span></span> <span class="mxinfo" id="T1:U417">1</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,71" id="srcline71"> 71</a></span><span class="line">    <span class="mxinfo" id="T39:U418"><span class="var type1" id="S45T39U496">dq_dw</span> = <span class="mxinfo" id="T39:U420"><span class="mxinfo" id="T1:U421"><span class="var type1" id="S8T1U499">dt</span>/<span class="mxinfo" id="T1:U423">2</span></span>*<span class="mxinfo" id="T39:U424">[<span class="mxinfo" id="T18:U425"><span class="var type1" id="S15T1U503">q2</span> <span class="var type1" id="S16T1U504">q3</span> <span class="var type1" id="S17T1U505">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo" id="T39:U418"><span class="mxinfo" id="T39:U420"><span class="mxinfo" id="T39:U424">        <span class="mxinfo" id="T18:U429"><span class="mxinfo" id="T1:U430">-<span class="var type1" id="S14T1U508">q1</span></span> <span class="var type1" id="S17T1U509">q4</span> <span class="mxinfo" id="T1:U433">-<span class="var type1" id="S16T1U511">q3</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T39:U418"><span class="mxinfo" id="T39:U420"><span class="mxinfo" id="T39:U424">        <span class="mxinfo" id="T18:U435"><span class="mxinfo" id="T1:U436">-<span class="var type1" id="S17T1U514">q4</span></span> <span class="mxinfo" id="T1:U438">-<span class="var type1" id="S14T1U516">q1</span></span> <span class="var type1" id="S15T1U517">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo" id="T39:U418"><span class="mxinfo" id="T39:U420"><span class="mxinfo" id="T39:U424">        <span class="mxinfo" id="T18:U441"><span class="var type1" id="S16T1U519">q3</span> <span class="mxinfo" id="T1:U443">-<span class="var type1" id="S15T1U521">q2</span></span> <span class="mxinfo" id="T1:U445">-<span class="var type1" id="S14T1U523">q1</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,75" id="srcline75"> 75</a></span><span class="line">    <span class="mxinfo" id="T42:U447"><span class="var type1" id="S46T42U526">dq_dx</span> = <span class="mxinfo" id="T42:U449">[<span class="mxinfo" id="T39:U450">zeros(<span class="mxinfo" id="T1:U451">4</span>,<span class="mxinfo" id="T1:U452">3</span>)</span>,<span class="mxinfo" id="T39:U453">zeros(<span class="mxinfo" id="T1:U454">4</span>,<span class="mxinfo" id="T1:U455">3</span>)</span>,<span class="var type1" id="S44T40U537">dq_dq</span>,<span class="var type1" id="S45T39U538">dq_dw</span>,<span class="mxinfo" id="T39:U458">zeros(<span class="mxinfo" id="T1:U459">4</span>,<span class="mxinfo" id="T1:U460">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,76" id="srcline76"> 76</a></span><span class="line">    <span class="mxinfo" id="T41:U461"><span class="var type1" id="S47T41U545">dwb_dx</span> = <span class="mxinfo" id="T41:U463">[<span class="mxinfo" id="T5:U464">zeros(<span class="mxinfo" id="T1:U465">3</span>,<span class="mxinfo" id="T1:U466">3</span>)</span>,<span class="mxinfo" id="T5:U467">zeros(<span class="mxinfo" id="T1:U468">3</span>,<span class="mxinfo" id="T1:U469">3</span>)</span>,<span class="mxinfo" id="T38:U470">zeros(<span class="mxinfo" id="T1:U471">3</span>,<span class="mxinfo" id="T1:U472">4</span>)</span>,<span class="mxinfo" id="T5:U473">eye(3)</span>,<span class="mxinfo" id="T5:U474">zeros(<span class="mxinfo" id="T1:U475">3</span>,<span class="mxinfo" id="T1:U476">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo" id="T41:U477"><span class="var type1" id="S48T41U569">dab_dx</span> = <span class="mxinfo" id="T41:U479">[<span class="mxinfo" id="T5:U480">zeros(<span class="mxinfo" id="T1:U481">3</span>,<span class="mxinfo" id="T1:U482">3</span>)</span>,<span class="mxinfo" id="T5:U483">zeros(<span class="mxinfo" id="T1:U484">3</span>,<span class="mxinfo" id="T1:U485">3</span>)</span>,<span class="mxinfo" id="T38:U486">zeros(<span class="mxinfo" id="T1:U487">3</span>,<span class="mxinfo" id="T1:U488">4</span>)</span>,<span class="mxinfo" id="T5:U489">zeros(<span class="mxinfo" id="T1:U490">3</span>,<span class="mxinfo" id="T1:U491">3</span>)</span>,<span class="mxinfo" id="T5:U492">eye(3)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo" id="T27:U493"><span class="var type1" id="S18T27U593">A</span> = <span class="mxinfo" id="T27:U495">[<span class="var type1" id="S20T41U596">dp_dx</span>;<span class="var type1" id="S39T41U598">dv_dx</span>;<span class="var type1" id="S46T42U600">dq_dx</span>;<span class="var type1" id="S47T41U602">dwb_dx</span>;<span class="var type1" id="S48T41U604">dab_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,79" id="srcline79"> 79</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo" id="T45:U501"><span class="var type1" id="S49T45U607">W</span> = <span class="mxinfo" id="T45:U503">zeros(<span class="mxinfo" id="T1:U504">16</span>,<span class="mxinfo" id="T1:U505">18</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,81" id="srcline81"> 81</a></span><span class="line">    <span class="mxinfo" id="T43:U506"><span class="var type1" id="S50T43U614">dfp_de</span> = <span class="mxinfo" id="T43:U508">[eye(3),zeros(3,3),zeros(3,3),zeros(3,3),zeros(3,3),zeros(3,3)]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,82" id="srcline82"> 82</a></span><span class="line">    <span class="mxinfo" id="T5:U509"><span class="var type1" id="S51T5U642">dfv_dea</span> = <span class="mxinfo" id="T5:U511"><span class="var type1" id="S8T1U644">dt</span>*<span class="var type1" id="S37T5U645">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,83" id="srcline83"> 83</a></span><span class="line">    <span class="mxinfo" id="T5:U514"><span class="var type1" id="S52T5U648">dfv_deab</span> = <span class="mxinfo" id="T5:U516"><span class="mxinfo" id="T1:U517">-<span class="var type1" id="S8T1U651">dt</span></span>*<span class="var type1" id="S37T5U652">Rq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo" id="T43:U520"><span class="var type1" id="S53T43U655">dfv_de</span> = <span class="mxinfo" id="T43:U522">[<span class="mxinfo" id="T5:U523">zeros(<span class="mxinfo" id="T1:U524">3</span>,<span class="mxinfo" id="T1:U525">3</span>)</span>,<span class="mxinfo" id="T5:U526">eye(3,3)</span>,<span class="var type1" id="S51T5U666">dfv_dea</span>,<span class="mxinfo" id="T5:U528">zeros(<span class="mxinfo" id="T1:U529">3</span>,<span class="mxinfo" id="T1:U530">3</span>)</span>,<span class="mxinfo" id="T5:U531">zeros(<span class="mxinfo" id="T1:U532">3</span>,<span class="mxinfo" id="T1:U533">3</span>)</span>,<span class="var type1" id="S52T5U675">dfv_deab</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo" id="T39:U535"><span class="var type1" id="S54T39U678">dfq_dew</span> = <span class="mxinfo" id="T39:U537"><span class="mxinfo" id="T1:U538"><span class="mxinfo" id="T1:U539">0.5</span>*<span class="var type1" id="S8T1U682">dt</span></span>*<span class="mxinfo" id="T39:U541">[<span class="mxinfo" id="T18:U542"><span class="mxinfo" id="T1:U543">-<span class="var type1" id="S15T1U686">q2</span></span> <span class="mxinfo" id="T1:U545">-<span class="var type1" id="S16T1U688">q3</span></span> <span class="mxinfo" id="T1:U547">-<span class="var type1" id="S17T1U690">q4</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,86" id="srcline86"> 86</a></span><span class="line"><span class="mxinfo" id="T39:U535"><span class="mxinfo" id="T39:U537"><span class="mxinfo" id="T39:U541">        <span class="mxinfo" id="T18:U549"><span class="var type1" id="S14T1U692">q1</span> <span class="mxinfo" id="T1:U551">-<span class="var type1" id="S17T1U694">q4</span></span> <span class="var type1" id="S16T1U695">q3</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,87" id="srcline87"> 87</a></span><span class="line"><span class="mxinfo" id="T39:U535"><span class="mxinfo" id="T39:U537"><span class="mxinfo" id="T39:U541">        <span class="mxinfo" id="T18:U554"><span class="var type1" id="S17T1U697">q4</span> <span class="var type1" id="S14T1U698">q1</span> <span class="mxinfo" id="T1:U557">-<span class="var type1" id="S15T1U700">q2</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,88" id="srcline88"> 88</a></span><span class="line"><span class="mxinfo" id="T39:U535"><span class="mxinfo" id="T39:U537"><span class="mxinfo" id="T39:U541">        <span class="mxinfo" id="T18:U559"><span class="mxinfo" id="T1:U560">-<span class="var type1" id="S16T1U703">q3</span></span> <span class="var type1" id="S15T1U704">q2</span> <span class="var type1" id="S14T1U705">q1</span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo" id="T39:U564"><span class="var type1" id="S55T39U708">dfq_dewb</span> = <span class="mxinfo" id="T39:U566"><span class="mxinfo" id="T1:U567"><span class="mxinfo" id="T1:U568">0.5</span>*<span class="var type1" id="S8T1U712">dt</span></span>*<span class="mxinfo" id="T39:U570">[<span class="mxinfo" id="T18:U571"><span class="var type1" id="S15T1U715">q2</span> <span class="var type1" id="S16T1U716">q3</span> <span class="var type1" id="S17T1U717">q4</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo" id="T39:U564"><span class="mxinfo" id="T39:U566"><span class="mxinfo" id="T39:U570">        <span class="mxinfo" id="T18:U575"><span class="mxinfo" id="T1:U576">-<span class="var type1" id="S14T1U720">q1</span></span> <span class="var type1" id="S17T1U721">q4</span> <span class="mxinfo" id="T1:U579">-<span class="var type1" id="S16T1U723">q3</span></span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,91" id="srcline91"> 91</a></span><span class="line"><span class="mxinfo" id="T39:U564"><span class="mxinfo" id="T39:U566"><span class="mxinfo" id="T39:U570">        <span class="mxinfo" id="T18:U581"><span class="mxinfo" id="T1:U582">-<span class="var type1" id="S17T1U726">q4</span></span> <span class="mxinfo" id="T1:U584">-<span class="var type1" id="S14T1U728">q1</span></span> <span class="var type1" id="S15T1U729">q2</span></span>;</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="69,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo" id="T39:U564"><span class="mxinfo" id="T39:U566"><span class="mxinfo" id="T39:U570">        <span class="mxinfo" id="T18:U587"><span class="var type1" id="S16T1U731">q3</span> <span class="mxinfo" id="T1:U589">-<span class="var type1" id="S15T1U733">q2</span></span> <span class="mxinfo" id="T1:U591">-<span class="var type1" id="S14T1U735">q1</span></span></span>]</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T44:U593"><span class="var type1" id="S56T44U738">dfq_de</span> = <span class="mxinfo" id="T44:U595">[<span class="mxinfo" id="T39:U596">zeros(<span class="mxinfo" id="T1:U597">4</span>,<span class="mxinfo" id="T1:U598">3</span>)</span>,<span class="mxinfo" id="T39:U599">zeros(<span class="mxinfo" id="T1:U600">4</span>,<span class="mxinfo" id="T1:U601">3</span>)</span>,<span class="mxinfo" id="T39:U602">zeros(<span class="mxinfo" id="T1:U603">4</span>,<span class="mxinfo" id="T1:U604">3</span>)</span>,<span class="var type1" id="S54T39U753">dfq_dew</span>,<span class="var type1" id="S55T39U754">dfq_dewb</span>,<span class="mxinfo" id="T39:U607">zeros(<span class="mxinfo" id="T1:U608">4</span>,<span class="mxinfo" id="T1:U609">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,94" id="srcline94"> 94</a></span><span class="line">    <span class="mxinfo" id="T43:U610"><span class="var type1" id="S57T43U761">dfwb_de</span> = <span class="mxinfo" id="T43:U612">[<span class="mxinfo" id="T5:U613">zeros(<span class="mxinfo" id="T1:U614">3</span>,<span class="mxinfo" id="T1:U615">3</span>)</span>,<span class="mxinfo" id="T5:U616">zeros(<span class="mxinfo" id="T1:U617">3</span>,<span class="mxinfo" id="T1:U618">3</span>)</span>,<span class="mxinfo" id="T5:U619">zeros(<span class="mxinfo" id="T1:U620">3</span>,<span class="mxinfo" id="T1:U621">3</span>)</span>,<span class="mxinfo" id="T5:U622">zeros(<span class="mxinfo" id="T1:U623">3</span>,<span class="mxinfo" id="T1:U624">3</span>)</span>,<span class="mxinfo" id="T5:U625"><span class="var type1" id="S8T1U781">dt</span>*<span class="mxinfo" id="T5:U627">eye(3)</span></span>,<span class="mxinfo" id="T5:U628">zeros(<span class="mxinfo" id="T1:U629">3</span>,<span class="mxinfo" id="T1:U630">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo" id="T43:U631"><span class="var type1" id="S58T43U791">dfab_de</span> = <span class="mxinfo" id="T43:U633">[<span class="mxinfo" id="T5:U634">zeros(<span class="mxinfo" id="T1:U635">3</span>,<span class="mxinfo" id="T1:U636">3</span>)</span>,<span class="mxinfo" id="T5:U637">zeros(<span class="mxinfo" id="T1:U638">3</span>,<span class="mxinfo" id="T1:U639">3</span>)</span>,<span class="mxinfo" id="T5:U640">zeros(<span class="mxinfo" id="T1:U641">3</span>,<span class="mxinfo" id="T1:U642">3</span>)</span>,<span class="mxinfo" id="T5:U643">zeros(<span class="mxinfo" id="T1:U644">3</span>,<span class="mxinfo" id="T1:U645">3</span>)</span>,<span class="mxinfo" id="T5:U646">zeros(<span class="mxinfo" id="T1:U647">3</span>,<span class="mxinfo" id="T1:U648">3</span>)</span>,<span class="mxinfo" id="T5:U649"><span class="var type1" id="S8T1U815">dt</span>*<span class="mxinfo" id="T5:U651">eye(3)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo" id="T45:U652"><span class="var type1" id="S49T45U821">W</span> = <span class="mxinfo" id="T45:U654">[<span class="var type1" id="S50T43U824">dfp_de</span>;<span class="var type1" id="S53T43U826">dfv_de</span>;<span class="var type1" id="S56T44U828">dfq_de</span>;<span class="var type1" id="S57T43U830">dfwb_de</span>;<span class="var type1" id="S58T43U832">dfab_de</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,97" id="srcline97"> 97</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="69,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo" id="T27:U660"><span class="var type1" id="S3T27U835">Cov</span> = <span class="mxinfo" id="T27:U662"><span class="mxinfo" id="T27:U663"><span class="mxinfo" id="T27:U664"><span class="var type1" id="S18T27U839">A</span>*<span class="var type1" id="S5T27U840">P</span></span>*<span class="mxinfo" id="T27:U667"><span class="var type1" id="S18T27U842">A</span>'</span></span> + <span class="mxinfo" id="T27:U669"><span class="mxinfo" id="T45:U670"><span class="var type1" id="S49T45U845">W</span>*<span class="var type1" id="S7T46U846">Q</span></span>*<span class="mxinfo" id="T47:U673"><span class="var type1" id="S49T45U848">W</span>'</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="69,99" id="srcline99"> 99</a></span><span class="line"><span class="comment">%     CovAug = (-1/4)*df2^2*P^2;</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,100" id="srcline100">100</a></span><span class="line"><span class="comment">%     Cov = Cov + CovAug;</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,101" id="srcline101">101</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="69,102" id="srcline102">102</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="69,103" id="srcline103">103</a></span><span class="line"><span class="comment">% implements discrete state differential step</span></span></span>
</pre>
