<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T7U3">xCorr</span>,<span class="var type1" id="S3T27U4">PCorr</span>] = correctStateAndCov(<span class="var type1" id="S4T7U7">x</span>,<span class="var type1" id="S5T2U8">z</span>,<span class="var type1" id="S6T27U9">P</span>,<span class="var type1" id="S7T5U10">object_points</span>,<span class="var type1" id="S8T1U11">Measurement_noise</span>)<span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">    <span class="comment">% need to determine the number of rows of H</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">    <span class="comment">% 2 eqs per blob per camera --&gt; maximum of 24 equations</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line">    <span class="comment">% z is a 1x4 (column per camera) struct with the following field</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line">    <span class="comment">%     f1 = 'number_red';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="comment">%     f2 = 'number_green';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="comment">%     f3 = 'number_blue';   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="comment">%     f4 = 'red_data';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="comment">%     f5 = 'green_data';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    <span class="comment">%     f6 = 'blue_data';  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    <span class="comment">%     f7 = 'time';</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="mxinfo" id="T1:U8"><span class="var type1" id="S9T1U14">num_measurements</span> = <span class="mxinfo" id="T1:U10">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    <span class="comment">% only allow single blob detection for now</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S10T1U18">i</span> = <span class="mxinfo" id="T1:U12">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U13"><span class="mxinfo" id="T1:U14"><span class="mxinfo" id="T48:U15"><span class="var type1" id="S5T2U28">z</span>(<span class="var type1" id="S10T1U29">i</span>)</span>.number_red</span> == <span class="mxinfo" id="T1:U18">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line">            <span class="mxinfo" id="T1:U19"><span class="var type1" id="S9T1U34">num_measurements</span> = <span class="mxinfo" id="T1:U21"><span class="var type1" id="S9T1U36">num_measurements</span> + <span class="mxinfo" id="T1:U23">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U24"><span class="mxinfo" id="T1:U25"><span class="mxinfo" id="T48:U26"><span class="var type1" id="S5T2U44">z</span>(<span class="var type1" id="S10T1U45">i</span>)</span>.number_green</span> == <span class="mxinfo" id="T1:U29">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line">            <span class="mxinfo" id="T1:U30"><span class="var type1" id="S9T1U50">num_measurements</span> = <span class="mxinfo" id="T1:U32"><span class="var type1" id="S9T1U52">num_measurements</span> + <span class="mxinfo" id="T1:U34">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U35"><span class="mxinfo" id="T1:U36"><span class="mxinfo" id="T48:U37"><span class="var type1" id="S5T2U60">z</span>(<span class="var type1" id="S10T1U61">i</span>)</span>.number_blue</span> == <span class="mxinfo" id="T1:U40">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">            <span class="mxinfo" id="T1:U41"><span class="var type1" id="S9T1U66">num_measurements</span> = <span class="mxinfo" id="T1:U43"><span class="var type1" id="S9T1U68">num_measurements</span> + <span class="mxinfo" id="T1:U45">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line">        <span class="keyword">end</span>        </span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo" id="T21:U46"><span class="var type1" id="S11T21U72">H</span> = <span class="mxinfo" id="T21:U48">zeros(<span class="var type1" id="S9T1U75">num_measurements</span>,<span class="mxinfo" id="T1:U50">16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo" id="T6:U51"><span class="var type1" id="S13T6U79">Twp</span> = <span class="mxinfo" id="T6:U53"><span class="var type1" id="S4T7U81">x</span>(<span class="mxinfo" id="T6:U55"><span class="mxinfo" id="T1:U56">1</span>:<span class="mxinfo" id="T1:U57">3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    <span class="mxinfo" id="T8:U58"><span class="var type1" id="S14T8U87">qwp</span> = <span class="mxinfo" id="T8:U60"><span class="var type1" id="S4T7U89">x</span>(<span class="mxinfo" id="T8:U62"><span class="mxinfo" id="T1:U63">7</span>:<span class="mxinfo" id="T1:U64">10</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="mxinfo" id="T35:U65"><span class="var type1" id="S15T35U95">z_est</span> = <span class="mxinfo" id="T35:U67">zeros(<span class="var type1" id="S9T1U98">num_measurements</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo" id="T35:U69"><span class="var type1" id="S16T35U102">z_meas</span> = <span class="mxinfo" id="T35:U71">zeros(<span class="var type1" id="S9T1U105">num_measurements</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="comment">% calculate innovation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo" id="T1:U73"><span class="var type1" id="S17T1U109">k</span> = <span class="mxinfo" id="T1:U75">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S10T1U113">i</span> = <span class="mxinfo" id="T1:U77">1</span>:4</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">        <span class="comment">% red blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U78"><span class="mxinfo" id="T1:U79"><span class="mxinfo" id="T48:U80"><span class="var type1" id="S5T2U123">z</span>(<span class="mxinfo" id="T1:U82">1</span>,<span class="var type1" id="S10T1U125">i</span>)</span>.number_red</span> == <span class="mxinfo" id="T1:U84">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">            <span class="comment">% do measurement estimation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">            <span class="mxinfo" id="T5:U85"><span class="var type1" id="S18T5U130">A</span> = <span class="mxinfo" id="T5:U87"><span class="mxinfo" id="T5:U88"><span class="mxinfo" id="T4:U89"><span class="mxinfo" id="T48:U90"><span class="var type1" id="S5T2U135">z</span>(<span class="mxinfo" id="T1:U92">1</span>,<span class="var type1" id="S10T1U137">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*1000</span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">            <span class="mxinfo" id="T5:U94"><span class="var type1" id="S19T5U143">Rcw</span> = <span class="mxinfo" id="T5:U96"><span class="mxinfo" id="T4:U97"><span class="mxinfo" id="T48:U98"><span class="var type1" id="S5T2U147">z</span>(<span class="mxinfo" id="T1:U100">1</span>,<span class="var type1" id="S10T1U149">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">            <span class="mxinfo" id="T6:U102"><span class="var type1" id="S20T6U154">Tcw</span> = <span class="mxinfo" id="T6:U104"><span class="mxinfo" id="T6:U105"><span class="mxinfo" id="T4:U106"><span class="mxinfo" id="T48:U107"><span class="var type1" id="S5T2U159">z</span>(<span class="mxinfo" id="T1:U109">1</span>,<span class="var type1" id="S10T1U161">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U111">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">            <span class="mxinfo" id="T17:U112"><span class="var type1" id="S21T17U167">u</span> = <span class="mxinfo" id="T17:U114"><span class="fcn" id="F50N4:B169">project2_2D</span>(<span class="var type1" id="S18T5U170">A</span>,<span class="var type1" id="S19T5U171">Rcw</span>,<span class="var type1" id="S20T6U172">Tcw</span>,<span class="var type1" id="S13T6U173">Twp</span>,<span class="var type1" id="S14T8U174">qwp</span>,<span class="mxinfo" id="T6:U120"><span class="mxinfo" id="T6:U121"><span class="var type1" id="S7T5U177">object_points</span>(:,<span class="mxinfo" id="T1:U123">1</span>)</span>/<span class="mxinfo" id="T1:U124">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">            <span class="mxinfo" id="T17:U125"><span class="mxinfo" id="T17:U126"><span class="var type1" id="S15T35U184">z_est</span>(<span class="mxinfo" id="T17:U128"><span class="var type1" id="S17T1U186">k</span>:<span class="mxinfo" id="T1:U130"><span class="var type1" id="S17T1U188">k</span>+1</span></span>,<span class="mxinfo" id="T1:U132">1</span>)</span> = <span class="var type1" id="S21T17U191">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">            <span class="comment">% do jacobian calculation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">            <span class="mxinfo" id="T5:U134"><span class="var type1" id="S23T5U194">K</span> = <span class="mxinfo" id="T5:U136"><span class="var type1" id="S18T5U196">A</span>*<span class="var type1" id="S19T5U197">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">            <span class="mxinfo" id="T1:U139"><span class="var type1" id="S24T1U200">X</span> = <span class="mxinfo" id="T1:U141"><span class="mxinfo" id="T1:U142"><span class="var type1" id="S7T5U203">object_points</span>(<span class="mxinfo" id="T1:U144">1</span>,<span class="mxinfo" id="T1:U145">1</span>)</span>/<span class="mxinfo" id="T1:U146">1000</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">            <span class="mxinfo" id="T1:U147"><span class="var type1" id="S25T1U209">Y</span> = <span class="mxinfo" id="T1:U149"><span class="mxinfo" id="T1:U150"><span class="var type1" id="S7T5U212">object_points</span>(<span class="mxinfo" id="T1:U152">2</span>,<span class="mxinfo" id="T1:U153">1</span>)</span>/<span class="mxinfo" id="T1:U154">1000</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">            <span class="mxinfo" id="T1:U155"><span class="var type1" id="S26T1U218">B1</span> = <span class="mxinfo" id="T1:U157"><span class="mxinfo" id="T1:U158"><span class="mxinfo" id="T1:U159"><span class="mxinfo" id="T1:U160">(<span class="mxinfo" id="T1:U161"><span class="mxinfo" id="T1:U162"><span class="mxinfo" id="T1:U163"><span class="mxinfo" id="T1:U164"><span class="mxinfo" id="T1:U165"><span class="var type1" id="S14T8U229">qwp</span>(<span class="mxinfo" id="T1:U167">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U168"><span class="mxinfo" id="T1:U169"><span class="var type1" id="S14T8U234">qwp</span>(<span class="mxinfo" id="T1:U171">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U172"><span class="mxinfo" id="T1:U173"><span class="var type1" id="S14T8U239">qwp</span>(<span class="mxinfo" id="T1:U175">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U176"><span class="mxinfo" id="T1:U177"><span class="var type1" id="S14T8U244">qwp</span>(<span class="mxinfo" id="T1:U179">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U247">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo" id="T1:U155"><span class="mxinfo" id="T1:U157"><span class="mxinfo" id="T1:U158"><span class="mxinfo" id="T1:U159">                <span class="mxinfo" id="T1:U181"><span class="mxinfo" id="T1:U182"><span class="mxinfo" id="T1:U183">+ 2</span>*(<span class="mxinfo" id="T1:U184"><span class="mxinfo" id="T1:U185"><span class="mxinfo" id="T1:U186"><span class="var type1" id="S14T8U256">qwp</span>(<span class="mxinfo" id="T1:U188">2</span>)</span>*<span class="mxinfo" id="T1:U189"><span class="var type1" id="S14T8U259">qwp</span>(<span class="mxinfo" id="T1:U191">3</span>)</span></span> - <span class="mxinfo" id="T1:U192"><span class="mxinfo" id="T1:U193"><span class="var type1" id="S14T8U263">qwp</span>(<span class="mxinfo" id="T1:U195">1</span>)</span>*<span class="mxinfo" id="T1:U196"><span class="var type1" id="S14T8U266">qwp</span>(<span class="mxinfo" id="T1:U198">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U268">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo" id="T1:U155"><span class="mxinfo" id="T1:U157"><span class="mxinfo" id="T1:U158">                + <span class="mxinfo" id="T1:U200"><span class="var type1" id="S13T6U271">Twp</span>(<span class="mxinfo" id="T1:U202">1</span>)</span></span> - <span class="mxinfo" id="T1:U203"><span class="mxinfo" id="T1:U204"><span class="mxinfo" id="T6:U205"><span class="mxinfo" id="T4:U206"><span class="mxinfo" id="T48:U207"><span class="var type1" id="S5T2U278">z</span>(<span class="mxinfo" id="T1:U209">1</span>,<span class="var type1" id="S10T1U280">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U211">1</span>)</span>/<span class="mxinfo" id="T1:U212">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">            <span class="mxinfo" id="T1:U213"><span class="var type1" id="S27T1U287">B2</span> = <span class="mxinfo" id="T1:U215"><span class="mxinfo" id="T1:U216"><span class="mxinfo" id="T1:U217"><span class="mxinfo" id="T1:U218"><span class="mxinfo" id="T1:U219"><span class="mxinfo" id="T1:U220">2</span>*(<span class="mxinfo" id="T1:U221"><span class="mxinfo" id="T1:U222"><span class="mxinfo" id="T1:U223"><span class="var type1" id="S14T8U298">qwp</span>(<span class="mxinfo" id="T1:U225">2</span>)</span>*<span class="mxinfo" id="T1:U226"><span class="var type1" id="S14T8U301">qwp</span>(<span class="mxinfo" id="T1:U228">3</span>)</span></span> + <span class="mxinfo" id="T1:U229"><span class="mxinfo" id="T1:U230"><span class="var type1" id="S14T8U305">qwp</span>(<span class="mxinfo" id="T1:U232">1</span>)</span>*<span class="mxinfo" id="T1:U233"><span class="var type1" id="S14T8U308">qwp</span>(<span class="mxinfo" id="T1:U235">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U310">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo" id="T1:U213"><span class="mxinfo" id="T1:U215"><span class="mxinfo" id="T1:U216"><span class="mxinfo" id="T1:U217">                <span class="mxinfo" id="T1:U237">+ (<span class="mxinfo" id="T1:U238"><span class="mxinfo" id="T1:U239"><span class="mxinfo" id="T1:U240"><span class="mxinfo" id="T1:U241"><span class="mxinfo" id="T1:U242"><span class="var type1" id="S14T8U319">qwp</span>(<span class="mxinfo" id="T1:U244">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U245"><span class="mxinfo" id="T1:U246"><span class="var type1" id="S14T8U324">qwp</span>(<span class="mxinfo" id="T1:U248">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U249"><span class="mxinfo" id="T1:U250"><span class="var type1" id="S14T8U329">qwp</span>(<span class="mxinfo" id="T1:U252">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U253"><span class="mxinfo" id="T1:U254"><span class="var type1" id="S14T8U334">qwp</span>(<span class="mxinfo" id="T1:U256">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U337">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="mxinfo" id="T1:U213"><span class="mxinfo" id="T1:U215"><span class="mxinfo" id="T1:U216">                + <span class="mxinfo" id="T1:U258"><span class="var type1" id="S13T6U340">Twp</span>(<span class="mxinfo" id="T1:U260">2</span>)</span></span> - <span class="mxinfo" id="T1:U261"><span class="mxinfo" id="T1:U262"><span class="mxinfo" id="T6:U263"><span class="mxinfo" id="T4:U264"><span class="mxinfo" id="T48:U265"><span class="var type1" id="S5T2U347">z</span>(<span class="mxinfo" id="T1:U267">1</span>,<span class="var type1" id="S10T1U349">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U269">2</span>)</span>/<span class="mxinfo" id="T1:U270">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">            <span class="mxinfo" id="T1:U271"><span class="var type1" id="S28T1U356">B3</span> = <span class="mxinfo" id="T1:U273"><span class="mxinfo" id="T1:U274"><span class="mxinfo" id="T1:U275"><span class="mxinfo" id="T1:U276"><span class="mxinfo" id="T1:U277"><span class="mxinfo" id="T1:U278">2</span>*(<span class="mxinfo" id="T1:U279"><span class="mxinfo" id="T1:U280"><span class="mxinfo" id="T1:U281"><span class="var type1" id="S14T8U367">qwp</span>(<span class="mxinfo" id="T1:U283">2</span>)</span>*<span class="mxinfo" id="T1:U284"><span class="var type1" id="S14T8U370">qwp</span>(<span class="mxinfo" id="T1:U286">4</span>)</span></span> - <span class="mxinfo" id="T1:U287"><span class="mxinfo" id="T1:U288"><span class="var type1" id="S14T8U374">qwp</span>(<span class="mxinfo" id="T1:U290">1</span>)</span>*<span class="mxinfo" id="T1:U291"><span class="var type1" id="S14T8U377">qwp</span>(<span class="mxinfo" id="T1:U293">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U379">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo" id="T1:U271"><span class="mxinfo" id="T1:U273"><span class="mxinfo" id="T1:U274"><span class="mxinfo" id="T1:U275">                <span class="mxinfo" id="T1:U295"><span class="mxinfo" id="T1:U296"><span class="mxinfo" id="T1:U297">+ 2</span>*(<span class="mxinfo" id="T1:U298"><span class="mxinfo" id="T1:U299"><span class="mxinfo" id="T1:U300"><span class="var type1" id="S14T8U388">qwp</span>(<span class="mxinfo" id="T1:U302">3</span>)</span>*<span class="mxinfo" id="T1:U303"><span class="var type1" id="S14T8U391">qwp</span>(<span class="mxinfo" id="T1:U305">4</span>)</span></span> + <span class="mxinfo" id="T1:U306"><span class="mxinfo" id="T1:U307"><span class="var type1" id="S14T8U395">qwp</span>(<span class="mxinfo" id="T1:U309">1</span>)</span>*<span class="mxinfo" id="T1:U310"><span class="var type1" id="S14T8U398">qwp</span>(<span class="mxinfo" id="T1:U312">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U400">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo" id="T1:U271"><span class="mxinfo" id="T1:U273"><span class="mxinfo" id="T1:U274">                + <span class="mxinfo" id="T1:U314"><span class="var type1" id="S13T6U403">Twp</span>(<span class="mxinfo" id="T1:U316">3</span>)</span></span> - <span class="mxinfo" id="T1:U317"><span class="mxinfo" id="T1:U318"><span class="mxinfo" id="T6:U319"><span class="mxinfo" id="T4:U320"><span class="mxinfo" id="T48:U321"><span class="var type1" id="S5T2U410">z</span>(<span class="mxinfo" id="T1:U323">1</span>,<span class="var type1" id="S10T1U412">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U325">3</span>)</span>/<span class="mxinfo" id="T1:U326">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">            <span class="mxinfo" id="T1:U327"><span class="var type1" id="S29T1U419">b</span> = <span class="mxinfo" id="T1:U329"><span class="mxinfo" id="T1:U330"><span class="mxinfo" id="T1:U331"><span class="mxinfo" id="T1:U332"><span class="var type1" id="S23T5U424">K</span>(<span class="mxinfo" id="T1:U334">3</span>,<span class="mxinfo" id="T1:U335">1</span>)</span>*<span class="var type1" id="S26T1U427">B1</span></span> + <span class="mxinfo" id="T1:U337"><span class="mxinfo" id="T1:U338"><span class="var type1" id="S23T5U430">K</span>(<span class="mxinfo" id="T1:U340">3</span>,<span class="mxinfo" id="T1:U341">2</span>)</span>*<span class="var type1" id="S27T1U433">B2</span></span></span> + <span class="mxinfo" id="T1:U343"><span class="mxinfo" id="T1:U344"><span class="var type1" id="S23T5U436">K</span>(<span class="mxinfo" id="T1:U346">3</span>,<span class="mxinfo" id="T1:U347">3</span>)</span>*<span class="var type1" id="S28T1U439">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">            <span class="mxinfo" id="T1:U349"><span class="var type1" id="S30T1U442">bu</span> = <span class="var type1" id="S29T1U443">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">            <span class="mxinfo" id="T1:U352"><span class="var type1" id="S31T1U446">bv</span> = <span class="var type1" id="S29T1U447">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">            <span class="mxinfo" id="T1:U355"><span class="var type1" id="S32T1U450">au</span> = <span class="mxinfo" id="T1:U357"><span class="mxinfo" id="T1:U358"><span class="mxinfo" id="T1:U359"><span class="mxinfo" id="T1:U360"><span class="var type1" id="S23T5U455">K</span>(<span class="mxinfo" id="T1:U362">1</span>,<span class="mxinfo" id="T1:U363">1</span>)</span>*<span class="var type1" id="S26T1U458">B1</span></span> + <span class="mxinfo" id="T1:U365"><span class="mxinfo" id="T1:U366"><span class="var type1" id="S23T5U461">K</span>(<span class="mxinfo" id="T1:U368">1</span>,<span class="mxinfo" id="T1:U369">2</span>)</span>*<span class="var type1" id="S27T1U464">B2</span></span></span> + <span class="mxinfo" id="T1:U371"><span class="mxinfo" id="T1:U372"><span class="var type1" id="S23T5U467">K</span>(<span class="mxinfo" id="T1:U374">1</span>,<span class="mxinfo" id="T1:U375">3</span>)</span>*<span class="var type1" id="S28T1U470">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">            <span class="mxinfo" id="T1:U377"><span class="var type1" id="S33T1U473">av</span> = <span class="mxinfo" id="T1:U379"><span class="mxinfo" id="T1:U380"><span class="mxinfo" id="T1:U381"><span class="mxinfo" id="T1:U382"><span class="var type1" id="S23T5U478">K</span>(<span class="mxinfo" id="T1:U384">2</span>,<span class="mxinfo" id="T1:U385">1</span>)</span>*<span class="var type1" id="S26T1U481">B1</span></span> + <span class="mxinfo" id="T1:U387"><span class="mxinfo" id="T1:U388"><span class="var type1" id="S23T5U484">K</span>(<span class="mxinfo" id="T1:U390">2</span>,<span class="mxinfo" id="T1:U391">2</span>)</span>*<span class="var type1" id="S27T1U487">B2</span></span></span> + <span class="mxinfo" id="T1:U393"><span class="mxinfo" id="T1:U394"><span class="var type1" id="S23T5U490">K</span>(<span class="mxinfo" id="T1:U396">2</span>,<span class="mxinfo" id="T1:U397">3</span>)</span>*<span class="var type1" id="S28T1U493">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">            <span class="mxinfo" id="T18:U399"><span class="var type1" id="S34T18U496">dB_zeros</span> = <span class="mxinfo" id="T18:U401">[0 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">            <span class="mxinfo" id="T19:U402"><span class="var type1" id="S35T19U504">dB1_q</span> = <span class="mxinfo" id="T19:U404">[<span class="mxinfo" id="T1:U405"><span class="mxinfo" id="T1:U406">2</span>*(<span class="mxinfo" id="T1:U407"><span class="mxinfo" id="T1:U408"><span class="mxinfo" id="T1:U409"><span class="var type1" id="S14T8U513">qwp</span>(<span class="mxinfo" id="T1:U411">1</span>)</span>*<span class="var type1" id="S24T1U515">X</span></span> - <span class="mxinfo" id="T1:U413"><span class="mxinfo" id="T1:U414"><span class="var type1" id="S14T8U518">qwp</span>(<span class="mxinfo" id="T1:U416">4</span>)</span>*<span class="var type1" id="S25T1U520">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U418"><span class="mxinfo" id="T1:U419">2</span>*(<span class="mxinfo" id="T1:U420"><span class="mxinfo" id="T1:U421"><span class="mxinfo" id="T1:U422"><span class="var type1" id="S14T8U527">qwp</span>(<span class="mxinfo" id="T1:U424">2</span>)</span>*<span class="var type1" id="S24T1U529">X</span></span> + <span class="mxinfo" id="T1:U426"><span class="mxinfo" id="T1:U427"><span class="var type1" id="S14T8U532">qwp</span>(<span class="mxinfo" id="T1:U429">3</span>)</span>*<span class="var type1" id="S25T1U534">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo" id="T19:U402"><span class="mxinfo" id="T19:U404">                    <span class="mxinfo" id="T1:U431"><span class="mxinfo" id="T1:U432">2</span>*(<span class="mxinfo" id="T1:U433"><span class="mxinfo" id="T1:U434"><span class="mxinfo" id="T1:U435">-<span class="mxinfo" id="T1:U436"><span class="var type1" id="S14T8U542">qwp</span>(<span class="mxinfo" id="T1:U438">3</span>)</span></span>*<span class="var type1" id="S24T1U544">X</span></span> + <span class="mxinfo" id="T1:U440"><span class="mxinfo" id="T1:U441"><span class="var type1" id="S14T8U547">qwp</span>(<span class="mxinfo" id="T1:U443">2</span>)</span>*<span class="var type1" id="S25T1U549">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U445"><span class="mxinfo" id="T1:U446">2</span>*(<span class="mxinfo" id="T1:U447"><span class="mxinfo" id="T1:U448"><span class="mxinfo" id="T1:U449">-<span class="mxinfo" id="T1:U450"><span class="var type1" id="S14T8U557">qwp</span>(<span class="mxinfo" id="T1:U452">4</span>)</span></span>*<span class="var type1" id="S24T1U559">X</span></span> - <span class="mxinfo" id="T1:U454"><span class="mxinfo" id="T1:U455"><span class="var type1" id="S14T8U562">qwp</span>(<span class="mxinfo" id="T1:U457">1</span>)</span>*<span class="var type1" id="S25T1U564">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">            <span class="mxinfo" id="T19:U459"><span class="var type1" id="S36T19U567">dB2_q</span> = <span class="mxinfo" id="T19:U461">[<span class="mxinfo" id="T1:U462"><span class="mxinfo" id="T1:U463">2</span>*(<span class="mxinfo" id="T1:U464"><span class="mxinfo" id="T1:U465"><span class="mxinfo" id="T1:U466"><span class="var type1" id="S14T8U576">qwp</span>(<span class="mxinfo" id="T1:U468">4</span>)</span>*<span class="var type1" id="S24T1U578">X</span></span> + <span class="mxinfo" id="T1:U470"><span class="mxinfo" id="T1:U471"><span class="var type1" id="S14T8U581">qwp</span>(<span class="mxinfo" id="T1:U473">1</span>)</span>*<span class="var type1" id="S25T1U583">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U475"><span class="mxinfo" id="T1:U476">2</span>*(<span class="mxinfo" id="T1:U477"><span class="mxinfo" id="T1:U478"><span class="mxinfo" id="T1:U479"><span class="var type1" id="S14T8U590">qwp</span>(<span class="mxinfo" id="T1:U481">3</span>)</span>*<span class="var type1" id="S24T1U592">X</span></span> - <span class="mxinfo" id="T1:U483"><span class="mxinfo" id="T1:U484"><span class="var type1" id="S14T8U595">qwp</span>(<span class="mxinfo" id="T1:U486">2</span>)</span>*<span class="var type1" id="S25T1U597">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo" id="T19:U459"><span class="mxinfo" id="T19:U461">                    <span class="mxinfo" id="T1:U488"><span class="mxinfo" id="T1:U489">2</span>*(<span class="mxinfo" id="T1:U490"><span class="mxinfo" id="T1:U491"><span class="mxinfo" id="T1:U492"><span class="var type1" id="S14T8U604">qwp</span>(<span class="mxinfo" id="T1:U494">2</span>)</span>*<span class="var type1" id="S24T1U606">X</span></span> + <span class="mxinfo" id="T1:U496"><span class="mxinfo" id="T1:U497"><span class="var type1" id="S14T8U609">qwp</span>(<span class="mxinfo" id="T1:U499">3</span>)</span>*<span class="var type1" id="S25T1U611">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U501"><span class="mxinfo" id="T1:U502">2</span>*(<span class="mxinfo" id="T1:U503"><span class="mxinfo" id="T1:U504"><span class="mxinfo" id="T1:U505"><span class="var type1" id="S14T8U618">qwp</span>(<span class="mxinfo" id="T1:U507">1</span>)</span>*<span class="var type1" id="S24T1U620">X</span></span> - <span class="mxinfo" id="T1:U509"><span class="mxinfo" id="T1:U510"><span class="var type1" id="S14T8U623">qwp</span>(<span class="mxinfo" id="T1:U512">4</span>)</span>*<span class="var type1" id="S25T1U625">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="mxinfo" id="T19:U514"><span class="var type1" id="S37T19U628">dB3_q</span> = <span class="mxinfo" id="T19:U516">[<span class="mxinfo" id="T1:U517"><span class="mxinfo" id="T1:U518">2</span>*(<span class="mxinfo" id="T1:U519"><span class="mxinfo" id="T1:U520"><span class="mxinfo" id="T1:U521">-<span class="mxinfo" id="T1:U522"><span class="var type1" id="S14T8U638">qwp</span>(<span class="mxinfo" id="T1:U524">3</span>)</span></span>*<span class="var type1" id="S24T1U640">X</span></span> + <span class="mxinfo" id="T1:U526"><span class="mxinfo" id="T1:U527"><span class="var type1" id="S14T8U643">qwp</span>(<span class="mxinfo" id="T1:U529">2</span>)</span>*<span class="var type1" id="S25T1U645">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U531"><span class="mxinfo" id="T1:U532">2</span>*(<span class="mxinfo" id="T1:U533"><span class="mxinfo" id="T1:U534"><span class="mxinfo" id="T1:U535"><span class="var type1" id="S14T8U652">qwp</span>(<span class="mxinfo" id="T1:U537">4</span>)</span>*<span class="var type1" id="S24T1U654">X</span></span> + <span class="mxinfo" id="T1:U539"><span class="mxinfo" id="T1:U540"><span class="var type1" id="S14T8U657">qwp</span>(<span class="mxinfo" id="T1:U542">1</span>)</span>*<span class="var type1" id="S25T1U659">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo" id="T19:U514"><span class="mxinfo" id="T19:U516">                    <span class="mxinfo" id="T1:U544"><span class="mxinfo" id="T1:U545">2</span>*(<span class="mxinfo" id="T1:U546"><span class="mxinfo" id="T1:U547"><span class="mxinfo" id="T1:U548">-<span class="mxinfo" id="T1:U549"><span class="var type1" id="S14T8U667">qwp</span>(<span class="mxinfo" id="T1:U551">1</span>)</span></span>*<span class="var type1" id="S24T1U669">X</span></span> + <span class="mxinfo" id="T1:U553"><span class="mxinfo" id="T1:U554"><span class="var type1" id="S14T8U672">qwp</span>(<span class="mxinfo" id="T1:U556">4</span>)</span>*<span class="var type1" id="S25T1U674">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U558"><span class="mxinfo" id="T1:U559">2</span>*(<span class="mxinfo" id="T1:U560"><span class="mxinfo" id="T1:U561"><span class="mxinfo" id="T1:U562"><span class="var type1" id="S14T8U681">qwp</span>(<span class="mxinfo" id="T1:U564">2</span>)</span>*<span class="var type1" id="S24T1U683">X</span></span> + <span class="mxinfo" id="T1:U566"><span class="mxinfo" id="T1:U567"><span class="var type1" id="S14T8U686">qwp</span>(<span class="mxinfo" id="T1:U569">3</span>)</span>*<span class="var type1" id="S25T1U688">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">            <span class="mxinfo" id="T20:U571"><span class="var type1" id="S38T20U691">dB1_x</span> = <span class="mxinfo" id="T20:U573">[<span class="mxinfo" id="T1:U574">1</span> <span class="mxinfo" id="T1:U575">0</span> <span class="mxinfo" id="T1:U576">0</span> <span class="var type1" id="S34T18U697">dB_zeros</span> <span class="var type1" id="S35T19U698">dB1_q</span> <span class="var type1" id="S34T18U699">dB_zeros</span> <span class="var type1" id="S34T18U700">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">            <span class="mxinfo" id="T20:U581"><span class="var type1" id="S39T20U703">dB2_x</span> = <span class="mxinfo" id="T20:U583">[<span class="mxinfo" id="T1:U584">0</span> <span class="mxinfo" id="T1:U585">1</span> <span class="mxinfo" id="T1:U586">0</span> <span class="var type1" id="S34T18U709">dB_zeros</span> <span class="var type1" id="S36T19U710">dB2_q</span> <span class="var type1" id="S34T18U711">dB_zeros</span> <span class="var type1" id="S34T18U712">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">            <span class="mxinfo" id="T20:U591"><span class="var type1" id="S40T20U715">dB3_x</span> = <span class="mxinfo" id="T20:U593">[<span class="mxinfo" id="T1:U594">0</span> <span class="mxinfo" id="T1:U595">0</span> <span class="mxinfo" id="T1:U596">1</span> <span class="var type1" id="S34T18U721">dB_zeros</span> <span class="var type1" id="S37T19U722">dB3_q</span> <span class="var type1" id="S34T18U723">dB_zeros</span> <span class="var type1" id="S34T18U724">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">            <span class="mxinfo" id="T20:U601"><span class="var type1" id="S41T20U727">au_prime</span> = <span class="mxinfo" id="T20:U603"><span class="mxinfo" id="T20:U604"><span class="mxinfo" id="T20:U605"><span class="mxinfo" id="T1:U606"><span class="var type1" id="S23T5U732">K</span>(<span class="mxinfo" id="T1:U608">1</span>,<span class="mxinfo" id="T1:U609">1</span>)</span>*<span class="var type1" id="S38T20U735">dB1_x</span></span> + <span class="mxinfo" id="T20:U611"><span class="mxinfo" id="T1:U612"><span class="var type1" id="S23T5U738">K</span>(<span class="mxinfo" id="T1:U614">1</span>,<span class="mxinfo" id="T1:U615">2</span>)</span>*<span class="var type1" id="S39T20U741">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U617"><span class="mxinfo" id="T1:U618"><span class="var type1" id="S23T5U744">K</span>(<span class="mxinfo" id="T1:U620">1</span>,<span class="mxinfo" id="T1:U621">3</span>)</span>*<span class="var type1" id="S40T20U747">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">            <span class="mxinfo" id="T20:U623"><span class="var type1" id="S42T20U750">av_prime</span> = <span class="mxinfo" id="T20:U625"><span class="mxinfo" id="T20:U626"><span class="mxinfo" id="T20:U627"><span class="mxinfo" id="T1:U628"><span class="var type1" id="S23T5U755">K</span>(<span class="mxinfo" id="T1:U630">2</span>,<span class="mxinfo" id="T1:U631">1</span>)</span>*<span class="var type1" id="S38T20U758">dB1_x</span></span> + <span class="mxinfo" id="T20:U633"><span class="mxinfo" id="T1:U634"><span class="var type1" id="S23T5U761">K</span>(<span class="mxinfo" id="T1:U636">2</span>,<span class="mxinfo" id="T1:U637">2</span>)</span>*<span class="var type1" id="S39T20U764">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U639"><span class="mxinfo" id="T1:U640"><span class="var type1" id="S23T5U767">K</span>(<span class="mxinfo" id="T1:U642">2</span>,<span class="mxinfo" id="T1:U643">3</span>)</span>*<span class="var type1" id="S40T20U770">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">            <span class="mxinfo" id="T20:U645"><span class="var type1" id="S43T20U773">b_prime</span> = <span class="mxinfo" id="T20:U647"><span class="mxinfo" id="T20:U648"><span class="mxinfo" id="T20:U649"><span class="mxinfo" id="T1:U650"><span class="var type1" id="S23T5U778">K</span>(<span class="mxinfo" id="T1:U652">3</span>,<span class="mxinfo" id="T1:U653">1</span>)</span>*<span class="var type1" id="S38T20U781">dB1_x</span></span> + <span class="mxinfo" id="T20:U655"><span class="mxinfo" id="T1:U656"><span class="var type1" id="S23T5U784">K</span>(<span class="mxinfo" id="T1:U658">3</span>,<span class="mxinfo" id="T1:U659">2</span>)</span>*<span class="var type1" id="S39T20U787">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U661"><span class="mxinfo" id="T1:U662"><span class="var type1" id="S23T5U790">K</span>(<span class="mxinfo" id="T1:U664">3</span>,<span class="mxinfo" id="T1:U665">3</span>)</span>*<span class="var type1" id="S40T20U793">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">            <span class="mxinfo" id="T20:U667"><span class="var type1" id="S44T20U796">bu_prime</span> = <span class="var type1" id="S43T20U797">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">            <span class="mxinfo" id="T20:U670"><span class="var type1" id="S45T20U800">bv_prime</span> = <span class="var type1" id="S43T20U801">b_prime</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">            <span class="mxinfo" id="T1:U673"><span class="var type1" id="S46T1U804">b_sq</span> = <span class="mxinfo" id="T1:U675"><span class="var type1" id="S29T1U806">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">            <span class="mxinfo" id="T20:U677"><span class="var type1" id="S47T20U810">du_dx</span> = <span class="mxinfo" id="T20:U679">(<span class="mxinfo" id="T20:U680"><span class="mxinfo" id="T20:U681"><span class="var type1" id="S41T20U815">au_prime</span>*<span class="var type1" id="S30T1U816">bu</span></span> - <span class="mxinfo" id="T20:U684"><span class="var type1" id="S32T1U818">au</span>*<span class="var type1" id="S44T20U819">bu_prime</span></span></span>)/<span class="var type1" id="S46T1U820">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">            <span class="mxinfo" id="T20:U688"><span class="var type1" id="S48T20U823">dv_dx</span> = <span class="mxinfo" id="T20:U690">(<span class="mxinfo" id="T20:U691"><span class="mxinfo" id="T20:U692"><span class="var type1" id="S42T20U828">av_prime</span>*<span class="var type1" id="S31T1U829">bv</span></span> - <span class="mxinfo" id="T20:U695"><span class="var type1" id="S33T1U831">av</span>*<span class="var type1" id="S45T20U832">bv_prime</span></span></span>)/<span class="var type1" id="S46T1U833">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">            <span class="mxinfo" id="T49:U699"><span class="mxinfo" id="T49:U700"><span class="var type1" id="S11T21U837">H</span>(<span class="mxinfo" id="T17:U702"><span class="var type1" id="S17T1U839">k</span>:<span class="mxinfo" id="T1:U704"><span class="var type1" id="S17T1U841">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T49:U706">[<span class="var type1" id="S47T20U846">du_dx</span>;<span class="var type1" id="S48T20U848">dv_dx</span>]</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">            <span class="mxinfo" id="T1:U709"><span class="mxinfo" id="T1:U710"><span class="var type1" id="S16T35U852">z_meas</span>(<span class="var type1" id="S17T1U853">k</span>,<span class="mxinfo" id="T1:U713">1</span>)</span> = <span class="mxinfo" id="T1:U714"><span class="mxinfo" id="T3:U715"><span class="mxinfo" id="T48:U716"><span class="var type1" id="S5T2U858">z</span>(<span class="mxinfo" id="T1:U718">1</span>,<span class="var type1" id="S10T1U860">i</span>)</span>.red_data</span>(<span class="mxinfo" id="T1:U720">1</span>,<span class="mxinfo" id="T1:U721">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">            <span class="mxinfo" id="T1:U722"><span class="mxinfo" id="T1:U723"><span class="var type1" id="S16T35U867">z_meas</span>(<span class="mxinfo" id="T1:U725"><span class="var type1" id="S17T1U869">k</span>+<span class="mxinfo" id="T1:U727">1</span></span>,<span class="mxinfo" id="T1:U728">1</span>)</span> = <span class="mxinfo" id="T1:U729"><span class="mxinfo" id="T3:U730"><span class="mxinfo" id="T48:U731"><span class="var type1" id="S5T2U875">z</span>(<span class="mxinfo" id="T1:U733">1</span>,<span class="var type1" id="S10T1U877">i</span>)</span>.red_data</span>(<span class="mxinfo" id="T1:U735">1</span>,<span class="mxinfo" id="T1:U736">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">            <span class="mxinfo" id="T1:U737"><span class="var type1" id="S17T1U883">k</span> = <span class="mxinfo" id="T1:U739"><span class="var type1" id="S17T1U885">k</span> + <span class="mxinfo" id="T1:U741">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">        <span class="comment">% green blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U742"><span class="mxinfo" id="T1:U743"><span class="mxinfo" id="T48:U744"><span class="var type1" id="S5T2U893">z</span>(<span class="mxinfo" id="T1:U746">1</span>,<span class="var type1" id="S10T1U895">i</span>)</span>.number_green</span> == <span class="mxinfo" id="T1:U748">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">            <span class="comment">% do measurement estimation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">            <span class="mxinfo" id="T5:U749"><span class="var type1" id="S18T5U900">A</span> = <span class="mxinfo" id="T5:U751"><span class="mxinfo" id="T5:U752"><span class="mxinfo" id="T4:U753"><span class="mxinfo" id="T48:U754"><span class="var type1" id="S5T2U905">z</span>(<span class="mxinfo" id="T1:U756">1</span>,<span class="var type1" id="S10T1U907">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*1000</span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">            <span class="mxinfo" id="T5:U758"><span class="var type1" id="S19T5U913">Rcw</span> = <span class="mxinfo" id="T5:U760"><span class="mxinfo" id="T4:U761"><span class="mxinfo" id="T48:U762"><span class="var type1" id="S5T2U917">z</span>(<span class="mxinfo" id="T1:U764">1</span>,<span class="var type1" id="S10T1U919">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">            <span class="mxinfo" id="T6:U766"><span class="var type1" id="S20T6U924">Tcw</span> = <span class="mxinfo" id="T6:U768"><span class="mxinfo" id="T6:U769"><span class="mxinfo" id="T4:U770"><span class="mxinfo" id="T48:U771"><span class="var type1" id="S5T2U929">z</span>(<span class="mxinfo" id="T1:U773">1</span>,<span class="var type1" id="S10T1U931">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U775">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">            <span class="mxinfo" id="T17:U776"><span class="var type1" id="S21T17U937">u</span> = <span class="mxinfo" id="T17:U778"><span class="fcn" id="F50N4:B939">project2_2D</span>(<span class="var type1" id="S18T5U940">A</span>,<span class="var type1" id="S19T5U941">Rcw</span>,<span class="var type1" id="S20T6U942">Tcw</span>,<span class="var type1" id="S13T6U943">Twp</span>,<span class="var type1" id="S14T8U944">qwp</span>,<span class="mxinfo" id="T6:U784"><span class="mxinfo" id="T6:U785"><span class="var type1" id="S7T5U947">object_points</span>(:,<span class="mxinfo" id="T1:U787">2</span>)</span>/<span class="mxinfo" id="T1:U788">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="mxinfo" id="T17:U789"><span class="mxinfo" id="T17:U790"><span class="var type1" id="S15T35U954">z_est</span>(<span class="mxinfo" id="T17:U792"><span class="var type1" id="S17T1U956">k</span>:<span class="mxinfo" id="T1:U794"><span class="var type1" id="S17T1U958">k</span>+1</span></span>,<span class="mxinfo" id="T1:U796">1</span>)</span> = <span class="var type1" id="S21T17U961">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">            <span class="comment">% do jacobian calc</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">            <span class="mxinfo" id="T5:U798"><span class="var type1" id="S23T5U964">K</span> = <span class="mxinfo" id="T5:U800"><span class="var type1" id="S18T5U966">A</span>*<span class="var type1" id="S19T5U967">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">            <span class="mxinfo" id="T1:U803"><span class="var type1" id="S24T1U970">X</span> = <span class="mxinfo" id="T1:U805"><span class="mxinfo" id="T1:U806"><span class="var type1" id="S7T5U973">object_points</span>(<span class="mxinfo" id="T1:U808">1</span>,<span class="mxinfo" id="T1:U809">2</span>)</span>/<span class="mxinfo" id="T1:U810">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">            <span class="mxinfo" id="T1:U811"><span class="var type1" id="S25T1U979">Y</span> = <span class="mxinfo" id="T1:U813"><span class="mxinfo" id="T1:U814"><span class="var type1" id="S7T5U982">object_points</span>(<span class="mxinfo" id="T1:U816">2</span>,<span class="mxinfo" id="T1:U817">2</span>)</span>/<span class="mxinfo" id="T1:U818">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="mxinfo" id="T1:U819"><span class="var type1" id="S26T1U988">B1</span> = <span class="mxinfo" id="T1:U821"><span class="mxinfo" id="T1:U822"><span class="mxinfo" id="T1:U823"><span class="mxinfo" id="T1:U824">(<span class="mxinfo" id="T1:U825"><span class="mxinfo" id="T1:U826"><span class="mxinfo" id="T1:U827"><span class="mxinfo" id="T1:U828"><span class="mxinfo" id="T1:U829"><span class="var type1" id="S14T8U999">qwp</span>(<span class="mxinfo" id="T1:U831">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U832"><span class="mxinfo" id="T1:U833"><span class="var type1" id="S14T8U1004">qwp</span>(<span class="mxinfo" id="T1:U835">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U836"><span class="mxinfo" id="T1:U837"><span class="var type1" id="S14T8U1009">qwp</span>(<span class="mxinfo" id="T1:U839">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U840"><span class="mxinfo" id="T1:U841"><span class="var type1" id="S14T8U1014">qwp</span>(<span class="mxinfo" id="T1:U843">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U1017">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="mxinfo" id="T1:U819"><span class="mxinfo" id="T1:U821"><span class="mxinfo" id="T1:U822"><span class="mxinfo" id="T1:U823">                <span class="mxinfo" id="T1:U845"><span class="mxinfo" id="T1:U846"><span class="mxinfo" id="T1:U847">+ 2</span>*(<span class="mxinfo" id="T1:U848"><span class="mxinfo" id="T1:U849"><span class="mxinfo" id="T1:U850"><span class="var type1" id="S14T8U1026">qwp</span>(<span class="mxinfo" id="T1:U852">2</span>)</span>*<span class="mxinfo" id="T1:U853"><span class="var type1" id="S14T8U1029">qwp</span>(<span class="mxinfo" id="T1:U855">3</span>)</span></span> - <span class="mxinfo" id="T1:U856"><span class="mxinfo" id="T1:U857"><span class="var type1" id="S14T8U1033">qwp</span>(<span class="mxinfo" id="T1:U859">1</span>)</span>*<span class="mxinfo" id="T1:U860"><span class="var type1" id="S14T8U1036">qwp</span>(<span class="mxinfo" id="T1:U862">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1038">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"><span class="mxinfo" id="T1:U819"><span class="mxinfo" id="T1:U821"><span class="mxinfo" id="T1:U822">                + <span class="mxinfo" id="T1:U864"><span class="var type1" id="S13T6U1041">Twp</span>(<span class="mxinfo" id="T1:U866">1</span>)</span></span> - <span class="mxinfo" id="T1:U867"><span class="mxinfo" id="T1:U868"><span class="mxinfo" id="T6:U869"><span class="mxinfo" id="T4:U870"><span class="mxinfo" id="T48:U871"><span class="var type1" id="S5T2U1048">z</span>(<span class="mxinfo" id="T1:U873">1</span>,<span class="var type1" id="S10T1U1050">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U875">1</span>)</span>/<span class="mxinfo" id="T1:U876">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo" id="T1:U877"><span class="var type1" id="S27T1U1057">B2</span> = <span class="mxinfo" id="T1:U879"><span class="mxinfo" id="T1:U880"><span class="mxinfo" id="T1:U881"><span class="mxinfo" id="T1:U882"><span class="mxinfo" id="T1:U883"><span class="mxinfo" id="T1:U884">2</span>*(<span class="mxinfo" id="T1:U885"><span class="mxinfo" id="T1:U886"><span class="mxinfo" id="T1:U887"><span class="var type1" id="S14T8U1068">qwp</span>(<span class="mxinfo" id="T1:U889">2</span>)</span>*<span class="mxinfo" id="T1:U890"><span class="var type1" id="S14T8U1071">qwp</span>(<span class="mxinfo" id="T1:U892">3</span>)</span></span> + <span class="mxinfo" id="T1:U893"><span class="mxinfo" id="T1:U894"><span class="var type1" id="S14T8U1075">qwp</span>(<span class="mxinfo" id="T1:U896">1</span>)</span>*<span class="mxinfo" id="T1:U897"><span class="var type1" id="S14T8U1078">qwp</span>(<span class="mxinfo" id="T1:U899">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1080">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"><span class="mxinfo" id="T1:U877"><span class="mxinfo" id="T1:U879"><span class="mxinfo" id="T1:U880"><span class="mxinfo" id="T1:U881">                <span class="mxinfo" id="T1:U901">+ (<span class="mxinfo" id="T1:U902"><span class="mxinfo" id="T1:U903"><span class="mxinfo" id="T1:U904"><span class="mxinfo" id="T1:U905"><span class="mxinfo" id="T1:U906"><span class="var type1" id="S14T8U1089">qwp</span>(<span class="mxinfo" id="T1:U908">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U909"><span class="mxinfo" id="T1:U910"><span class="var type1" id="S14T8U1094">qwp</span>(<span class="mxinfo" id="T1:U912">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U913"><span class="mxinfo" id="T1:U914"><span class="var type1" id="S14T8U1099">qwp</span>(<span class="mxinfo" id="T1:U916">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U917"><span class="mxinfo" id="T1:U918"><span class="var type1" id="S14T8U1104">qwp</span>(<span class="mxinfo" id="T1:U920">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U1107">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"><span class="mxinfo" id="T1:U877"><span class="mxinfo" id="T1:U879"><span class="mxinfo" id="T1:U880">                + <span class="mxinfo" id="T1:U922"><span class="var type1" id="S13T6U1110">Twp</span>(<span class="mxinfo" id="T1:U924">2</span>)</span></span> - <span class="mxinfo" id="T1:U925"><span class="mxinfo" id="T1:U926"><span class="mxinfo" id="T6:U927"><span class="mxinfo" id="T4:U928"><span class="mxinfo" id="T48:U929"><span class="var type1" id="S5T2U1117">z</span>(<span class="mxinfo" id="T1:U931">1</span>,<span class="var type1" id="S10T1U1119">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U933">2</span>)</span>/<span class="mxinfo" id="T1:U934">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">            <span class="mxinfo" id="T1:U935"><span class="var type1" id="S28T1U1126">B3</span> = <span class="mxinfo" id="T1:U937"><span class="mxinfo" id="T1:U938"><span class="mxinfo" id="T1:U939"><span class="mxinfo" id="T1:U940"><span class="mxinfo" id="T1:U941"><span class="mxinfo" id="T1:U942">2</span>*(<span class="mxinfo" id="T1:U943"><span class="mxinfo" id="T1:U944"><span class="mxinfo" id="T1:U945"><span class="var type1" id="S14T8U1137">qwp</span>(<span class="mxinfo" id="T1:U947">2</span>)</span>*<span class="mxinfo" id="T1:U948"><span class="var type1" id="S14T8U1140">qwp</span>(<span class="mxinfo" id="T1:U950">4</span>)</span></span> - <span class="mxinfo" id="T1:U951"><span class="mxinfo" id="T1:U952"><span class="var type1" id="S14T8U1144">qwp</span>(<span class="mxinfo" id="T1:U954">1</span>)</span>*<span class="mxinfo" id="T1:U955"><span class="var type1" id="S14T8U1147">qwp</span>(<span class="mxinfo" id="T1:U957">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1149">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"><span class="mxinfo" id="T1:U935"><span class="mxinfo" id="T1:U937"><span class="mxinfo" id="T1:U938"><span class="mxinfo" id="T1:U939">                <span class="mxinfo" id="T1:U959"><span class="mxinfo" id="T1:U960"><span class="mxinfo" id="T1:U961">+ 2</span>*(<span class="mxinfo" id="T1:U962"><span class="mxinfo" id="T1:U963"><span class="mxinfo" id="T1:U964"><span class="var type1" id="S14T8U1158">qwp</span>(<span class="mxinfo" id="T1:U966">3</span>)</span>*<span class="mxinfo" id="T1:U967"><span class="var type1" id="S14T8U1161">qwp</span>(<span class="mxinfo" id="T1:U969">4</span>)</span></span> + <span class="mxinfo" id="T1:U970"><span class="mxinfo" id="T1:U971"><span class="var type1" id="S14T8U1165">qwp</span>(<span class="mxinfo" id="T1:U973">1</span>)</span>*<span class="mxinfo" id="T1:U974"><span class="var type1" id="S14T8U1168">qwp</span>(<span class="mxinfo" id="T1:U976">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1170">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"><span class="mxinfo" id="T1:U935"><span class="mxinfo" id="T1:U937"><span class="mxinfo" id="T1:U938">                + <span class="mxinfo" id="T1:U978"><span class="var type1" id="S13T6U1173">Twp</span>(<span class="mxinfo" id="T1:U980">3</span>)</span></span> - <span class="mxinfo" id="T1:U981"><span class="mxinfo" id="T1:U982"><span class="mxinfo" id="T6:U983"><span class="mxinfo" id="T4:U984"><span class="mxinfo" id="T48:U985"><span class="var type1" id="S5T2U1180">z</span>(<span class="mxinfo" id="T1:U987">1</span>,<span class="var type1" id="S10T1U1182">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U989">3</span>)</span>/<span class="mxinfo" id="T1:U990">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">            <span class="mxinfo" id="T1:U991"><span class="var type1" id="S29T1U1189">b</span> = <span class="mxinfo" id="T1:U993"><span class="mxinfo" id="T1:U994"><span class="mxinfo" id="T1:U995"><span class="mxinfo" id="T1:U996"><span class="var type1" id="S23T5U1194">K</span>(<span class="mxinfo" id="T1:U998">3</span>,<span class="mxinfo" id="T1:U999">1</span>)</span>*<span class="var type1" id="S26T1U1197">B1</span></span> + <span class="mxinfo" id="T1:U1001"><span class="mxinfo" id="T1:U1002"><span class="var type1" id="S23T5U1200">K</span>(<span class="mxinfo" id="T1:U1004">3</span>,<span class="mxinfo" id="T1:U1005">2</span>)</span>*<span class="var type1" id="S27T1U1203">B2</span></span></span> + <span class="mxinfo" id="T1:U1007"><span class="mxinfo" id="T1:U1008"><span class="var type1" id="S23T5U1206">K</span>(<span class="mxinfo" id="T1:U1010">3</span>,<span class="mxinfo" id="T1:U1011">3</span>)</span>*<span class="var type1" id="S28T1U1209">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">            <span class="mxinfo" id="T1:U1013"><span class="var type1" id="S30T1U1212">bu</span> = <span class="var type1" id="S29T1U1213">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">            <span class="mxinfo" id="T1:U1016"><span class="var type1" id="S31T1U1216">bv</span> = <span class="var type1" id="S29T1U1217">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">            <span class="mxinfo" id="T1:U1019"><span class="var type1" id="S32T1U1220">au</span> = <span class="mxinfo" id="T1:U1021"><span class="mxinfo" id="T1:U1022"><span class="mxinfo" id="T1:U1023"><span class="mxinfo" id="T1:U1024"><span class="var type1" id="S23T5U1225">K</span>(<span class="mxinfo" id="T1:U1026">1</span>,<span class="mxinfo" id="T1:U1027">1</span>)</span>*<span class="var type1" id="S26T1U1228">B1</span></span> + <span class="mxinfo" id="T1:U1029"><span class="mxinfo" id="T1:U1030"><span class="var type1" id="S23T5U1231">K</span>(<span class="mxinfo" id="T1:U1032">1</span>,<span class="mxinfo" id="T1:U1033">2</span>)</span>*<span class="var type1" id="S27T1U1234">B2</span></span></span> + <span class="mxinfo" id="T1:U1035"><span class="mxinfo" id="T1:U1036"><span class="var type1" id="S23T5U1237">K</span>(<span class="mxinfo" id="T1:U1038">1</span>,<span class="mxinfo" id="T1:U1039">3</span>)</span>*<span class="var type1" id="S28T1U1240">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">            <span class="mxinfo" id="T1:U1041"><span class="var type1" id="S33T1U1243">av</span> = <span class="mxinfo" id="T1:U1043"><span class="mxinfo" id="T1:U1044"><span class="mxinfo" id="T1:U1045"><span class="mxinfo" id="T1:U1046"><span class="var type1" id="S23T5U1248">K</span>(<span class="mxinfo" id="T1:U1048">2</span>,<span class="mxinfo" id="T1:U1049">1</span>)</span>*<span class="var type1" id="S26T1U1251">B1</span></span> + <span class="mxinfo" id="T1:U1051"><span class="mxinfo" id="T1:U1052"><span class="var type1" id="S23T5U1254">K</span>(<span class="mxinfo" id="T1:U1054">2</span>,<span class="mxinfo" id="T1:U1055">2</span>)</span>*<span class="var type1" id="S27T1U1257">B2</span></span></span> + <span class="mxinfo" id="T1:U1057"><span class="mxinfo" id="T1:U1058"><span class="var type1" id="S23T5U1260">K</span>(<span class="mxinfo" id="T1:U1060">2</span>,<span class="mxinfo" id="T1:U1061">3</span>)</span>*<span class="var type1" id="S28T1U1263">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">            <span class="mxinfo" id="T18:U1063"><span class="var type1" id="S34T18U1266">dB_zeros</span> = <span class="mxinfo" id="T18:U1065">[0 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">            <span class="mxinfo" id="T19:U1066"><span class="var type1" id="S35T19U1274">dB1_q</span> = <span class="mxinfo" id="T19:U1068">[<span class="mxinfo" id="T1:U1069"><span class="mxinfo" id="T1:U1070">2</span>*(<span class="mxinfo" id="T1:U1071"><span class="mxinfo" id="T1:U1072"><span class="mxinfo" id="T1:U1073"><span class="var type1" id="S14T8U1283">qwp</span>(<span class="mxinfo" id="T1:U1075">1</span>)</span>*<span class="var type1" id="S24T1U1285">X</span></span> - <span class="mxinfo" id="T1:U1077"><span class="mxinfo" id="T1:U1078"><span class="var type1" id="S14T8U1288">qwp</span>(<span class="mxinfo" id="T1:U1080">4</span>)</span>*<span class="var type1" id="S25T1U1290">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1082"><span class="mxinfo" id="T1:U1083">2</span>*(<span class="mxinfo" id="T1:U1084"><span class="mxinfo" id="T1:U1085"><span class="mxinfo" id="T1:U1086"><span class="var type1" id="S14T8U1297">qwp</span>(<span class="mxinfo" id="T1:U1088">2</span>)</span>*<span class="var type1" id="S24T1U1299">X</span></span> + <span class="mxinfo" id="T1:U1090"><span class="mxinfo" id="T1:U1091"><span class="var type1" id="S14T8U1302">qwp</span>(<span class="mxinfo" id="T1:U1093">3</span>)</span>*<span class="var type1" id="S25T1U1304">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line"><span class="mxinfo" id="T19:U1066"><span class="mxinfo" id="T19:U1068">                    <span class="mxinfo" id="T1:U1095"><span class="mxinfo" id="T1:U1096">2</span>*(<span class="mxinfo" id="T1:U1097"><span class="mxinfo" id="T1:U1098"><span class="mxinfo" id="T1:U1099">-<span class="mxinfo" id="T1:U1100"><span class="var type1" id="S14T8U1312">qwp</span>(<span class="mxinfo" id="T1:U1102">3</span>)</span></span>*<span class="var type1" id="S24T1U1314">X</span></span> + <span class="mxinfo" id="T1:U1104"><span class="mxinfo" id="T1:U1105"><span class="var type1" id="S14T8U1317">qwp</span>(<span class="mxinfo" id="T1:U1107">2</span>)</span>*<span class="var type1" id="S25T1U1319">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1109"><span class="mxinfo" id="T1:U1110">2</span>*(<span class="mxinfo" id="T1:U1111"><span class="mxinfo" id="T1:U1112"><span class="mxinfo" id="T1:U1113">-<span class="mxinfo" id="T1:U1114"><span class="var type1" id="S14T8U1327">qwp</span>(<span class="mxinfo" id="T1:U1116">4</span>)</span></span>*<span class="var type1" id="S24T1U1329">X</span></span> - <span class="mxinfo" id="T1:U1118"><span class="mxinfo" id="T1:U1119"><span class="var type1" id="S14T8U1332">qwp</span>(<span class="mxinfo" id="T1:U1121">1</span>)</span>*<span class="var type1" id="S25T1U1334">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="mxinfo" id="T19:U1123"><span class="var type1" id="S36T19U1337">dB2_q</span> = <span class="mxinfo" id="T19:U1125">[<span class="mxinfo" id="T1:U1126"><span class="mxinfo" id="T1:U1127">2</span>*(<span class="mxinfo" id="T1:U1128"><span class="mxinfo" id="T1:U1129"><span class="mxinfo" id="T1:U1130"><span class="var type1" id="S14T8U1346">qwp</span>(<span class="mxinfo" id="T1:U1132">4</span>)</span>*<span class="var type1" id="S24T1U1348">X</span></span> + <span class="mxinfo" id="T1:U1134"><span class="mxinfo" id="T1:U1135"><span class="var type1" id="S14T8U1351">qwp</span>(<span class="mxinfo" id="T1:U1137">1</span>)</span>*<span class="var type1" id="S25T1U1353">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1139"><span class="mxinfo" id="T1:U1140">2</span>*(<span class="mxinfo" id="T1:U1141"><span class="mxinfo" id="T1:U1142"><span class="mxinfo" id="T1:U1143"><span class="var type1" id="S14T8U1360">qwp</span>(<span class="mxinfo" id="T1:U1145">3</span>)</span>*<span class="var type1" id="S24T1U1362">X</span></span> - <span class="mxinfo" id="T1:U1147"><span class="mxinfo" id="T1:U1148"><span class="var type1" id="S14T8U1365">qwp</span>(<span class="mxinfo" id="T1:U1150">2</span>)</span>*<span class="var type1" id="S25T1U1367">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line"><span class="mxinfo" id="T19:U1123"><span class="mxinfo" id="T19:U1125">                    <span class="mxinfo" id="T1:U1152"><span class="mxinfo" id="T1:U1153">2</span>*(<span class="mxinfo" id="T1:U1154"><span class="mxinfo" id="T1:U1155"><span class="mxinfo" id="T1:U1156"><span class="var type1" id="S14T8U1374">qwp</span>(<span class="mxinfo" id="T1:U1158">2</span>)</span>*<span class="var type1" id="S24T1U1376">X</span></span> + <span class="mxinfo" id="T1:U1160"><span class="mxinfo" id="T1:U1161"><span class="var type1" id="S14T8U1379">qwp</span>(<span class="mxinfo" id="T1:U1163">3</span>)</span>*<span class="var type1" id="S25T1U1381">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1165"><span class="mxinfo" id="T1:U1166">2</span>*(<span class="mxinfo" id="T1:U1167"><span class="mxinfo" id="T1:U1168"><span class="mxinfo" id="T1:U1169"><span class="var type1" id="S14T8U1388">qwp</span>(<span class="mxinfo" id="T1:U1171">1</span>)</span>*<span class="var type1" id="S24T1U1390">X</span></span> - <span class="mxinfo" id="T1:U1173"><span class="mxinfo" id="T1:U1174"><span class="var type1" id="S14T8U1393">qwp</span>(<span class="mxinfo" id="T1:U1176">4</span>)</span>*<span class="var type1" id="S25T1U1395">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">            <span class="mxinfo" id="T19:U1178"><span class="var type1" id="S37T19U1398">dB3_q</span> = <span class="mxinfo" id="T19:U1180">[<span class="mxinfo" id="T1:U1181"><span class="mxinfo" id="T1:U1182">2</span>*(<span class="mxinfo" id="T1:U1183"><span class="mxinfo" id="T1:U1184"><span class="mxinfo" id="T1:U1185">-<span class="mxinfo" id="T1:U1186"><span class="var type1" id="S14T8U1408">qwp</span>(<span class="mxinfo" id="T1:U1188">3</span>)</span></span>*<span class="var type1" id="S24T1U1410">X</span></span> + <span class="mxinfo" id="T1:U1190"><span class="mxinfo" id="T1:U1191"><span class="var type1" id="S14T8U1413">qwp</span>(<span class="mxinfo" id="T1:U1193">2</span>)</span>*<span class="var type1" id="S25T1U1415">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1195"><span class="mxinfo" id="T1:U1196">2</span>*(<span class="mxinfo" id="T1:U1197"><span class="mxinfo" id="T1:U1198"><span class="mxinfo" id="T1:U1199"><span class="var type1" id="S14T8U1422">qwp</span>(<span class="mxinfo" id="T1:U1201">4</span>)</span>*<span class="var type1" id="S24T1U1424">X</span></span> + <span class="mxinfo" id="T1:U1203"><span class="mxinfo" id="T1:U1204"><span class="var type1" id="S14T8U1427">qwp</span>(<span class="mxinfo" id="T1:U1206">1</span>)</span>*<span class="var type1" id="S25T1U1429">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="mxinfo" id="T19:U1178"><span class="mxinfo" id="T19:U1180">                    <span class="mxinfo" id="T1:U1208"><span class="mxinfo" id="T1:U1209">2</span>*(<span class="mxinfo" id="T1:U1210"><span class="mxinfo" id="T1:U1211"><span class="mxinfo" id="T1:U1212">-<span class="mxinfo" id="T1:U1213"><span class="var type1" id="S14T8U1437">qwp</span>(<span class="mxinfo" id="T1:U1215">1</span>)</span></span>*<span class="var type1" id="S24T1U1439">X</span></span> + <span class="mxinfo" id="T1:U1217"><span class="mxinfo" id="T1:U1218"><span class="var type1" id="S14T8U1442">qwp</span>(<span class="mxinfo" id="T1:U1220">4</span>)</span>*<span class="var type1" id="S25T1U1444">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1222"><span class="mxinfo" id="T1:U1223">2</span>*(<span class="mxinfo" id="T1:U1224"><span class="mxinfo" id="T1:U1225"><span class="mxinfo" id="T1:U1226"><span class="var type1" id="S14T8U1451">qwp</span>(<span class="mxinfo" id="T1:U1228">2</span>)</span>*<span class="var type1" id="S24T1U1453">X</span></span> + <span class="mxinfo" id="T1:U1230"><span class="mxinfo" id="T1:U1231"><span class="var type1" id="S14T8U1456">qwp</span>(<span class="mxinfo" id="T1:U1233">3</span>)</span>*<span class="var type1" id="S25T1U1458">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="mxinfo" id="T20:U1235"><span class="var type1" id="S38T20U1461">dB1_x</span> = <span class="mxinfo" id="T20:U1237">[<span class="mxinfo" id="T1:U1238">1</span> <span class="mxinfo" id="T1:U1239">0</span> <span class="mxinfo" id="T1:U1240">0</span> <span class="var type1" id="S34T18U1467">dB_zeros</span> <span class="var type1" id="S35T19U1468">dB1_q</span> <span class="var type1" id="S34T18U1469">dB_zeros</span> <span class="var type1" id="S34T18U1470">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">            <span class="mxinfo" id="T20:U1245"><span class="var type1" id="S39T20U1473">dB2_x</span> = <span class="mxinfo" id="T20:U1247">[<span class="mxinfo" id="T1:U1248">0</span> <span class="mxinfo" id="T1:U1249">1</span> <span class="mxinfo" id="T1:U1250">0</span> <span class="var type1" id="S34T18U1479">dB_zeros</span> <span class="var type1" id="S36T19U1480">dB2_q</span> <span class="var type1" id="S34T18U1481">dB_zeros</span> <span class="var type1" id="S34T18U1482">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">            <span class="mxinfo" id="T20:U1255"><span class="var type1" id="S40T20U1485">dB3_x</span> = <span class="mxinfo" id="T20:U1257">[<span class="mxinfo" id="T1:U1258">0</span> <span class="mxinfo" id="T1:U1259">0</span> <span class="mxinfo" id="T1:U1260">1</span> <span class="var type1" id="S34T18U1491">dB_zeros</span> <span class="var type1" id="S37T19U1492">dB3_q</span> <span class="var type1" id="S34T18U1493">dB_zeros</span> <span class="var type1" id="S34T18U1494">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">            <span class="mxinfo" id="T20:U1265"><span class="var type1" id="S41T20U1497">au_prime</span> = <span class="mxinfo" id="T20:U1267"><span class="mxinfo" id="T20:U1268"><span class="mxinfo" id="T20:U1269"><span class="mxinfo" id="T1:U1270"><span class="var type1" id="S23T5U1502">K</span>(<span class="mxinfo" id="T1:U1272">1</span>,<span class="mxinfo" id="T1:U1273">1</span>)</span>*<span class="var type1" id="S38T20U1505">dB1_x</span></span> + <span class="mxinfo" id="T20:U1275"><span class="mxinfo" id="T1:U1276"><span class="var type1" id="S23T5U1508">K</span>(<span class="mxinfo" id="T1:U1278">1</span>,<span class="mxinfo" id="T1:U1279">2</span>)</span>*<span class="var type1" id="S39T20U1511">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1281"><span class="mxinfo" id="T1:U1282"><span class="var type1" id="S23T5U1514">K</span>(<span class="mxinfo" id="T1:U1284">1</span>,<span class="mxinfo" id="T1:U1285">3</span>)</span>*<span class="var type1" id="S40T20U1517">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">            <span class="mxinfo" id="T20:U1287"><span class="var type1" id="S42T20U1520">av_prime</span> = <span class="mxinfo" id="T20:U1289"><span class="mxinfo" id="T20:U1290"><span class="mxinfo" id="T20:U1291"><span class="mxinfo" id="T1:U1292"><span class="var type1" id="S23T5U1525">K</span>(<span class="mxinfo" id="T1:U1294">2</span>,<span class="mxinfo" id="T1:U1295">1</span>)</span>*<span class="var type1" id="S38T20U1528">dB1_x</span></span> + <span class="mxinfo" id="T20:U1297"><span class="mxinfo" id="T1:U1298"><span class="var type1" id="S23T5U1531">K</span>(<span class="mxinfo" id="T1:U1300">2</span>,<span class="mxinfo" id="T1:U1301">2</span>)</span>*<span class="var type1" id="S39T20U1534">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1303"><span class="mxinfo" id="T1:U1304"><span class="var type1" id="S23T5U1537">K</span>(<span class="mxinfo" id="T1:U1306">2</span>,<span class="mxinfo" id="T1:U1307">3</span>)</span>*<span class="var type1" id="S40T20U1540">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">            <span class="mxinfo" id="T20:U1309"><span class="var type1" id="S43T20U1543">b_prime</span> = <span class="mxinfo" id="T20:U1311"><span class="mxinfo" id="T20:U1312"><span class="mxinfo" id="T20:U1313"><span class="mxinfo" id="T1:U1314"><span class="var type1" id="S23T5U1548">K</span>(<span class="mxinfo" id="T1:U1316">3</span>,<span class="mxinfo" id="T1:U1317">1</span>)</span>*<span class="var type1" id="S38T20U1551">dB1_x</span></span> + <span class="mxinfo" id="T20:U1319"><span class="mxinfo" id="T1:U1320"><span class="var type1" id="S23T5U1554">K</span>(<span class="mxinfo" id="T1:U1322">3</span>,<span class="mxinfo" id="T1:U1323">2</span>)</span>*<span class="var type1" id="S39T20U1557">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1325"><span class="mxinfo" id="T1:U1326"><span class="var type1" id="S23T5U1560">K</span>(<span class="mxinfo" id="T1:U1328">3</span>,<span class="mxinfo" id="T1:U1329">3</span>)</span>*<span class="var type1" id="S40T20U1563">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">            <span class="mxinfo" id="T20:U1331"><span class="var type1" id="S44T20U1566">bu_prime</span> = <span class="var type1" id="S43T20U1567">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">            <span class="mxinfo" id="T20:U1334"><span class="var type1" id="S45T20U1570">bv_prime</span> = <span class="var type1" id="S43T20U1571">b_prime</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">            <span class="mxinfo" id="T1:U1337"><span class="var type1" id="S46T1U1574">b_sq</span> = <span class="mxinfo" id="T1:U1339"><span class="var type1" id="S29T1U1576">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">            <span class="mxinfo" id="T20:U1341"><span class="var type1" id="S47T20U1580">du_dx</span> = <span class="mxinfo" id="T20:U1343">(<span class="mxinfo" id="T20:U1344"><span class="mxinfo" id="T20:U1345"><span class="var type1" id="S41T20U1585">au_prime</span>*<span class="var type1" id="S30T1U1586">bu</span></span> - <span class="mxinfo" id="T20:U1348"><span class="var type1" id="S32T1U1588">au</span>*<span class="var type1" id="S44T20U1589">bu_prime</span></span></span>)/<span class="var type1" id="S46T1U1590">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            <span class="mxinfo" id="T20:U1352"><span class="var type1" id="S48T20U1593">dv_dx</span> = <span class="mxinfo" id="T20:U1354">(<span class="mxinfo" id="T20:U1355"><span class="mxinfo" id="T20:U1356"><span class="var type1" id="S42T20U1598">av_prime</span>*<span class="var type1" id="S31T1U1599">bv</span></span> - <span class="mxinfo" id="T20:U1359"><span class="var type1" id="S33T1U1601">av</span>*<span class="var type1" id="S45T20U1602">bv_prime</span></span></span>)/<span class="var type1" id="S46T1U1603">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">            <span class="mxinfo" id="T49:U1363"><span class="mxinfo" id="T49:U1364"><span class="var type1" id="S11T21U1607">H</span>(<span class="mxinfo" id="T17:U1366"><span class="var type1" id="S17T1U1609">k</span>:<span class="mxinfo" id="T1:U1368"><span class="var type1" id="S17T1U1611">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T49:U1370">[<span class="var type1" id="S47T20U1616">du_dx</span>;<span class="var type1" id="S48T20U1618">dv_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">            <span class="mxinfo" id="T1:U1373"><span class="mxinfo" id="T1:U1374"><span class="var type1" id="S16T35U1622">z_meas</span>(<span class="var type1" id="S17T1U1623">k</span>,<span class="mxinfo" id="T1:U1377">1</span>)</span> = <span class="mxinfo" id="T1:U1378"><span class="mxinfo" id="T3:U1379"><span class="mxinfo" id="T48:U1380"><span class="var type1" id="S5T2U1628">z</span>(<span class="mxinfo" id="T1:U1382">1</span>,<span class="var type1" id="S10T1U1630">i</span>)</span>.green_data</span>(<span class="mxinfo" id="T1:U1384">1</span>,<span class="mxinfo" id="T1:U1385">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">            <span class="mxinfo" id="T1:U1386"><span class="mxinfo" id="T1:U1387"><span class="var type1" id="S16T35U1637">z_meas</span>(<span class="mxinfo" id="T1:U1389"><span class="var type1" id="S17T1U1639">k</span>+<span class="mxinfo" id="T1:U1391">1</span></span>,<span class="mxinfo" id="T1:U1392">1</span>)</span> = <span class="mxinfo" id="T1:U1393"><span class="mxinfo" id="T3:U1394"><span class="mxinfo" id="T48:U1395"><span class="var type1" id="S5T2U1645">z</span>(<span class="mxinfo" id="T1:U1397">1</span>,<span class="var type1" id="S10T1U1647">i</span>)</span>.green_data</span>(<span class="mxinfo" id="T1:U1399">1</span>,<span class="mxinfo" id="T1:U1400">2</span>)</span></span>;            </span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">            <span class="mxinfo" id="T1:U1401"><span class="var type1" id="S17T1U1653">k</span> = <span class="mxinfo" id="T1:U1403"><span class="var type1" id="S17T1U1655">k</span> + <span class="mxinfo" id="T1:U1405">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">        <span class="comment">% blue blobs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">        <span class="keyword">if</span> (<span class="mxinfo" id="T11:U1406"><span class="mxinfo" id="T1:U1407"><span class="mxinfo" id="T48:U1408"><span class="var type1" id="S5T2U1663">z</span>(<span class="mxinfo" id="T1:U1410">1</span>,<span class="var type1" id="S10T1U1665">i</span>)</span>.number_blue</span> == <span class="mxinfo" id="T1:U1412">1</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">            <span class="mxinfo" id="T5:U1413"><span class="var type1" id="S18T5U1670">A</span> = <span class="mxinfo" id="T5:U1415"><span class="mxinfo" id="T5:U1416"><span class="mxinfo" id="T4:U1417"><span class="mxinfo" id="T48:U1418"><span class="var type1" id="S5T2U1675">z</span>(<span class="mxinfo" id="T1:U1420">1</span>,<span class="var type1" id="S10T1U1677">i</span>)</span>.cam_param</span>.intrinsic_mat</span>*1000</span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">            <span class="mxinfo" id="T5:U1422"><span class="var type1" id="S19T5U1683">Rcw</span> = <span class="mxinfo" id="T5:U1424"><span class="mxinfo" id="T4:U1425"><span class="mxinfo" id="T48:U1426"><span class="var type1" id="S5T2U1687">z</span>(<span class="mxinfo" id="T1:U1428">1</span>,<span class="var type1" id="S10T1U1689">i</span>)</span>.cam_param</span>.rotation_w2c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">            <span class="mxinfo" id="T6:U1430"><span class="var type1" id="S20T6U1694">Tcw</span> = <span class="mxinfo" id="T6:U1432"><span class="mxinfo" id="T6:U1433"><span class="mxinfo" id="T4:U1434"><span class="mxinfo" id="T48:U1435"><span class="var type1" id="S5T2U1699">z</span>(<span class="mxinfo" id="T1:U1437">1</span>,<span class="var type1" id="S10T1U1701">i</span>)</span>.cam_param</span>.translation_w2c</span>/<span class="mxinfo" id="T1:U1439">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">            <span class="mxinfo" id="T17:U1440"><span class="var type1" id="S21T17U1707">u</span> = <span class="mxinfo" id="T17:U1442"><span class="fcn" id="F50N4:B1709">project2_2D</span>(<span class="var type1" id="S18T5U1710">A</span>,<span class="var type1" id="S19T5U1711">Rcw</span>,<span class="var type1" id="S20T6U1712">Tcw</span>,<span class="var type1" id="S13T6U1713">Twp</span>,<span class="var type1" id="S14T8U1714">qwp</span>,<span class="mxinfo" id="T6:U1448"><span class="mxinfo" id="T6:U1449"><span class="var type1" id="S7T5U1717">object_points</span>(:,<span class="mxinfo" id="T1:U1451">3</span>)</span>/<span class="mxinfo" id="T1:U1452">1000</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">            <span class="mxinfo" id="T17:U1453"><span class="mxinfo" id="T17:U1454"><span class="var type1" id="S15T35U1724">z_est</span>(<span class="mxinfo" id="T17:U1456"><span class="var type1" id="S17T1U1726">k</span>:<span class="mxinfo" id="T1:U1458"><span class="var type1" id="S17T1U1728">k</span>+1</span></span>,<span class="mxinfo" id="T1:U1460">1</span>)</span> = <span class="var type1" id="S21T17U1731">u</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">            <span class="mxinfo" id="T5:U1462"><span class="var type1" id="S23T5U1734">K</span> = <span class="mxinfo" id="T5:U1464"><span class="var type1" id="S18T5U1736">A</span>*<span class="var type1" id="S19T5U1737">Rcw</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">            <span class="mxinfo" id="T1:U1467"><span class="var type1" id="S24T1U1740">X</span> = <span class="mxinfo" id="T1:U1469"><span class="mxinfo" id="T1:U1470"><span class="var type1" id="S7T5U1743">object_points</span>(<span class="mxinfo" id="T1:U1472">1</span>,<span class="mxinfo" id="T1:U1473">3</span>)</span>/<span class="mxinfo" id="T1:U1474">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">            <span class="mxinfo" id="T1:U1475"><span class="var type1" id="S25T1U1749">Y</span> = <span class="mxinfo" id="T1:U1477"><span class="mxinfo" id="T1:U1478"><span class="var type1" id="S7T5U1752">object_points</span>(<span class="mxinfo" id="T1:U1480">2</span>,<span class="mxinfo" id="T1:U1481">3</span>)</span>/<span class="mxinfo" id="T1:U1482">1000</span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">            <span class="comment">% calculate B's</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">            <span class="mxinfo" id="T1:U1483"><span class="var type1" id="S26T1U1758">B1</span> = <span class="mxinfo" id="T1:U1485"><span class="mxinfo" id="T1:U1486"><span class="mxinfo" id="T1:U1487"><span class="mxinfo" id="T1:U1488">(<span class="mxinfo" id="T1:U1489"><span class="mxinfo" id="T1:U1490"><span class="mxinfo" id="T1:U1491"><span class="mxinfo" id="T1:U1492"><span class="mxinfo" id="T1:U1493"><span class="var type1" id="S14T8U1769">qwp</span>(<span class="mxinfo" id="T1:U1495">1</span>)</span>^2</span>+<span class="mxinfo" id="T1:U1496"><span class="mxinfo" id="T1:U1497"><span class="var type1" id="S14T8U1774">qwp</span>(<span class="mxinfo" id="T1:U1499">2</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1500"><span class="mxinfo" id="T1:U1501"><span class="var type1" id="S14T8U1779">qwp</span>(<span class="mxinfo" id="T1:U1503">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1504"><span class="mxinfo" id="T1:U1505"><span class="var type1" id="S14T8U1784">qwp</span>(<span class="mxinfo" id="T1:U1507">4</span>)</span>^2</span></span>)*<span class="var type1" id="S24T1U1787">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="mxinfo" id="T1:U1483"><span class="mxinfo" id="T1:U1485"><span class="mxinfo" id="T1:U1486"><span class="mxinfo" id="T1:U1487">                <span class="mxinfo" id="T1:U1509"><span class="mxinfo" id="T1:U1510"><span class="mxinfo" id="T1:U1511">+ 2</span>*(<span class="mxinfo" id="T1:U1512"><span class="mxinfo" id="T1:U1513"><span class="mxinfo" id="T1:U1514"><span class="var type1" id="S14T8U1796">qwp</span>(<span class="mxinfo" id="T1:U1516">2</span>)</span>*<span class="mxinfo" id="T1:U1517"><span class="var type1" id="S14T8U1799">qwp</span>(<span class="mxinfo" id="T1:U1519">3</span>)</span></span> - <span class="mxinfo" id="T1:U1520"><span class="mxinfo" id="T1:U1521"><span class="var type1" id="S14T8U1803">qwp</span>(<span class="mxinfo" id="T1:U1523">1</span>)</span>*<span class="mxinfo" id="T1:U1524"><span class="var type1" id="S14T8U1806">qwp</span>(<span class="mxinfo" id="T1:U1526">4</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1808">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line"><span class="mxinfo" id="T1:U1483"><span class="mxinfo" id="T1:U1485"><span class="mxinfo" id="T1:U1486">                + <span class="mxinfo" id="T1:U1528"><span class="var type1" id="S13T6U1811">Twp</span>(<span class="mxinfo" id="T1:U1530">1</span>)</span></span> - <span class="mxinfo" id="T1:U1531"><span class="mxinfo" id="T1:U1532"><span class="mxinfo" id="T6:U1533"><span class="mxinfo" id="T4:U1534"><span class="mxinfo" id="T48:U1535"><span class="var type1" id="S5T2U1818">z</span>(<span class="mxinfo" id="T1:U1537">1</span>,<span class="var type1" id="S10T1U1820">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1539">1</span>)</span>/<span class="mxinfo" id="T1:U1540">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">            <span class="mxinfo" id="T1:U1541"><span class="var type1" id="S27T1U1827">B2</span> = <span class="mxinfo" id="T1:U1543"><span class="mxinfo" id="T1:U1544"><span class="mxinfo" id="T1:U1545"><span class="mxinfo" id="T1:U1546"><span class="mxinfo" id="T1:U1547"><span class="mxinfo" id="T1:U1548">2</span>*(<span class="mxinfo" id="T1:U1549"><span class="mxinfo" id="T1:U1550"><span class="mxinfo" id="T1:U1551"><span class="var type1" id="S14T8U1838">qwp</span>(<span class="mxinfo" id="T1:U1553">2</span>)</span>*<span class="mxinfo" id="T1:U1554"><span class="var type1" id="S14T8U1841">qwp</span>(<span class="mxinfo" id="T1:U1556">3</span>)</span></span> + <span class="mxinfo" id="T1:U1557"><span class="mxinfo" id="T1:U1558"><span class="var type1" id="S14T8U1845">qwp</span>(<span class="mxinfo" id="T1:U1560">1</span>)</span>*<span class="mxinfo" id="T1:U1561"><span class="var type1" id="S14T8U1848">qwp</span>(<span class="mxinfo" id="T1:U1563">4</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1850">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo" id="T1:U1541"><span class="mxinfo" id="T1:U1543"><span class="mxinfo" id="T1:U1544"><span class="mxinfo" id="T1:U1545">                <span class="mxinfo" id="T1:U1565">+ (<span class="mxinfo" id="T1:U1566"><span class="mxinfo" id="T1:U1567"><span class="mxinfo" id="T1:U1568"><span class="mxinfo" id="T1:U1569"><span class="mxinfo" id="T1:U1570"><span class="var type1" id="S14T8U1859">qwp</span>(<span class="mxinfo" id="T1:U1572">1</span>)</span>^2</span>-<span class="mxinfo" id="T1:U1573"><span class="mxinfo" id="T1:U1574"><span class="var type1" id="S14T8U1864">qwp</span>(<span class="mxinfo" id="T1:U1576">2</span>)</span>^2</span></span>+<span class="mxinfo" id="T1:U1577"><span class="mxinfo" id="T1:U1578"><span class="var type1" id="S14T8U1869">qwp</span>(<span class="mxinfo" id="T1:U1580">3</span>)</span>^2</span></span>-<span class="mxinfo" id="T1:U1581"><span class="mxinfo" id="T1:U1582"><span class="var type1" id="S14T8U1874">qwp</span>(<span class="mxinfo" id="T1:U1584">4</span>)</span>^2</span></span>)*<span class="var type1" id="S25T1U1877">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="mxinfo" id="T1:U1541"><span class="mxinfo" id="T1:U1543"><span class="mxinfo" id="T1:U1544">                + <span class="mxinfo" id="T1:U1586"><span class="var type1" id="S13T6U1880">Twp</span>(<span class="mxinfo" id="T1:U1588">2</span>)</span></span> - <span class="mxinfo" id="T1:U1589"><span class="mxinfo" id="T1:U1590"><span class="mxinfo" id="T6:U1591"><span class="mxinfo" id="T4:U1592"><span class="mxinfo" id="T48:U1593"><span class="var type1" id="S5T2U1887">z</span>(<span class="mxinfo" id="T1:U1595">1</span>,<span class="var type1" id="S10T1U1889">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1597">2</span>)</span>/<span class="mxinfo" id="T1:U1598">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">            <span class="mxinfo" id="T1:U1599"><span class="var type1" id="S28T1U1896">B3</span> = <span class="mxinfo" id="T1:U1601"><span class="mxinfo" id="T1:U1602"><span class="mxinfo" id="T1:U1603"><span class="mxinfo" id="T1:U1604"><span class="mxinfo" id="T1:U1605"><span class="mxinfo" id="T1:U1606">2</span>*(<span class="mxinfo" id="T1:U1607"><span class="mxinfo" id="T1:U1608"><span class="mxinfo" id="T1:U1609"><span class="var type1" id="S14T8U1907">qwp</span>(<span class="mxinfo" id="T1:U1611">2</span>)</span>*<span class="mxinfo" id="T1:U1612"><span class="var type1" id="S14T8U1910">qwp</span>(<span class="mxinfo" id="T1:U1614">4</span>)</span></span> - <span class="mxinfo" id="T1:U1615"><span class="mxinfo" id="T1:U1616"><span class="var type1" id="S14T8U1914">qwp</span>(<span class="mxinfo" id="T1:U1618">1</span>)</span>*<span class="mxinfo" id="T1:U1619"><span class="var type1" id="S14T8U1917">qwp</span>(<span class="mxinfo" id="T1:U1621">3</span>)</span></span></span>)</span>*<span class="var type1" id="S24T1U1919">X</span></span> + <span class="keyword">...</span></span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line"><span class="mxinfo" id="T1:U1599"><span class="mxinfo" id="T1:U1601"><span class="mxinfo" id="T1:U1602"><span class="mxinfo" id="T1:U1603">                <span class="mxinfo" id="T1:U1623"><span class="mxinfo" id="T1:U1624"><span class="mxinfo" id="T1:U1625">+ 2</span>*(<span class="mxinfo" id="T1:U1626"><span class="mxinfo" id="T1:U1627"><span class="mxinfo" id="T1:U1628"><span class="var type1" id="S14T8U1928">qwp</span>(<span class="mxinfo" id="T1:U1630">3</span>)</span>*<span class="mxinfo" id="T1:U1631"><span class="var type1" id="S14T8U1931">qwp</span>(<span class="mxinfo" id="T1:U1633">4</span>)</span></span> + <span class="mxinfo" id="T1:U1634"><span class="mxinfo" id="T1:U1635"><span class="var type1" id="S14T8U1935">qwp</span>(<span class="mxinfo" id="T1:U1637">1</span>)</span>*<span class="mxinfo" id="T1:U1638"><span class="var type1" id="S14T8U1938">qwp</span>(<span class="mxinfo" id="T1:U1640">2</span>)</span></span></span>)</span>*<span class="var type1" id="S25T1U1940">Y</span></span></span> + <span class="keyword">...</span></span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line"><span class="mxinfo" id="T1:U1599"><span class="mxinfo" id="T1:U1601"><span class="mxinfo" id="T1:U1602">                + <span class="mxinfo" id="T1:U1642"><span class="var type1" id="S13T6U1943">Twp</span>(<span class="mxinfo" id="T1:U1644">3</span>)</span></span> - <span class="mxinfo" id="T1:U1645"><span class="mxinfo" id="T1:U1646"><span class="mxinfo" id="T6:U1647"><span class="mxinfo" id="T4:U1648"><span class="mxinfo" id="T48:U1649"><span class="var type1" id="S5T2U1950">z</span>(<span class="mxinfo" id="T1:U1651">1</span>,<span class="var type1" id="S10T1U1952">i</span>)</span>.cam_param</span>.translation_w2c</span>(<span class="mxinfo" id="T1:U1653">3</span>)</span>/<span class="mxinfo" id="T1:U1654">1000</span></span></span></span>; <span class="comment">% convert mapping from pixel/mm to pixel/m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">            <span class="mxinfo" id="T1:U1655"><span class="var type1" id="S29T1U1959">b</span> = <span class="mxinfo" id="T1:U1657"><span class="mxinfo" id="T1:U1658"><span class="mxinfo" id="T1:U1659"><span class="mxinfo" id="T1:U1660"><span class="var type1" id="S23T5U1964">K</span>(<span class="mxinfo" id="T1:U1662">3</span>,<span class="mxinfo" id="T1:U1663">1</span>)</span>*<span class="var type1" id="S26T1U1967">B1</span></span> + <span class="mxinfo" id="T1:U1665"><span class="mxinfo" id="T1:U1666"><span class="var type1" id="S23T5U1970">K</span>(<span class="mxinfo" id="T1:U1668">3</span>,<span class="mxinfo" id="T1:U1669">2</span>)</span>*<span class="var type1" id="S27T1U1973">B2</span></span></span> + <span class="mxinfo" id="T1:U1671"><span class="mxinfo" id="T1:U1672"><span class="var type1" id="S23T5U1976">K</span>(<span class="mxinfo" id="T1:U1674">3</span>,<span class="mxinfo" id="T1:U1675">3</span>)</span>*<span class="var type1" id="S28T1U1979">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">            <span class="mxinfo" id="T1:U1677"><span class="var type1" id="S30T1U1982">bu</span> = <span class="var type1" id="S29T1U1983">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">            <span class="mxinfo" id="T1:U1680"><span class="var type1" id="S31T1U1986">bv</span> = <span class="var type1" id="S29T1U1987">b</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">            <span class="mxinfo" id="T1:U1683"><span class="var type1" id="S32T1U1990">au</span> = <span class="mxinfo" id="T1:U1685"><span class="mxinfo" id="T1:U1686"><span class="mxinfo" id="T1:U1687"><span class="mxinfo" id="T1:U1688"><span class="var type1" id="S23T5U1995">K</span>(<span class="mxinfo" id="T1:U1690">1</span>,<span class="mxinfo" id="T1:U1691">1</span>)</span>*<span class="var type1" id="S26T1U1998">B1</span></span> + <span class="mxinfo" id="T1:U1693"><span class="mxinfo" id="T1:U1694"><span class="var type1" id="S23T5U2001">K</span>(<span class="mxinfo" id="T1:U1696">1</span>,<span class="mxinfo" id="T1:U1697">2</span>)</span>*<span class="var type1" id="S27T1U2004">B2</span></span></span> + <span class="mxinfo" id="T1:U1699"><span class="mxinfo" id="T1:U1700"><span class="var type1" id="S23T5U2007">K</span>(<span class="mxinfo" id="T1:U1702">1</span>,<span class="mxinfo" id="T1:U1703">3</span>)</span>*<span class="var type1" id="S28T1U2010">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">            <span class="mxinfo" id="T1:U1705"><span class="var type1" id="S33T1U2013">av</span> = <span class="mxinfo" id="T1:U1707"><span class="mxinfo" id="T1:U1708"><span class="mxinfo" id="T1:U1709"><span class="mxinfo" id="T1:U1710"><span class="var type1" id="S23T5U2018">K</span>(<span class="mxinfo" id="T1:U1712">2</span>,<span class="mxinfo" id="T1:U1713">1</span>)</span>*<span class="var type1" id="S26T1U2021">B1</span></span> + <span class="mxinfo" id="T1:U1715"><span class="mxinfo" id="T1:U1716"><span class="var type1" id="S23T5U2024">K</span>(<span class="mxinfo" id="T1:U1718">2</span>,<span class="mxinfo" id="T1:U1719">2</span>)</span>*<span class="var type1" id="S27T1U2027">B2</span></span></span> + <span class="mxinfo" id="T1:U1721"><span class="mxinfo" id="T1:U1722"><span class="var type1" id="S23T5U2030">K</span>(<span class="mxinfo" id="T1:U1724">2</span>,<span class="mxinfo" id="T1:U1725">3</span>)</span>*<span class="var type1" id="S28T1U2033">B3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">            <span class="mxinfo" id="T18:U1727"><span class="var type1" id="S34T18U2036">dB_zeros</span> = <span class="mxinfo" id="T18:U1729">[0 0 0]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">            <span class="mxinfo" id="T19:U1730"><span class="var type1" id="S35T19U2044">dB1_q</span> = <span class="mxinfo" id="T19:U1732">[<span class="mxinfo" id="T1:U1733"><span class="mxinfo" id="T1:U1734">2</span>*(<span class="mxinfo" id="T1:U1735"><span class="mxinfo" id="T1:U1736"><span class="mxinfo" id="T1:U1737"><span class="var type1" id="S14T8U2053">qwp</span>(<span class="mxinfo" id="T1:U1739">1</span>)</span>*<span class="var type1" id="S24T1U2055">X</span></span> - <span class="mxinfo" id="T1:U1741"><span class="mxinfo" id="T1:U1742"><span class="var type1" id="S14T8U2058">qwp</span>(<span class="mxinfo" id="T1:U1744">4</span>)</span>*<span class="var type1" id="S25T1U2060">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1746"><span class="mxinfo" id="T1:U1747">2</span>*(<span class="mxinfo" id="T1:U1748"><span class="mxinfo" id="T1:U1749"><span class="mxinfo" id="T1:U1750"><span class="var type1" id="S14T8U2067">qwp</span>(<span class="mxinfo" id="T1:U1752">2</span>)</span>*<span class="var type1" id="S24T1U2069">X</span></span> + <span class="mxinfo" id="T1:U1754"><span class="mxinfo" id="T1:U1755"><span class="var type1" id="S14T8U2072">qwp</span>(<span class="mxinfo" id="T1:U1757">3</span>)</span>*<span class="var type1" id="S25T1U2074">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo" id="T19:U1730"><span class="mxinfo" id="T19:U1732">                    <span class="mxinfo" id="T1:U1759"><span class="mxinfo" id="T1:U1760">2</span>*(<span class="mxinfo" id="T1:U1761"><span class="mxinfo" id="T1:U1762"><span class="mxinfo" id="T1:U1763">-<span class="mxinfo" id="T1:U1764"><span class="var type1" id="S14T8U2082">qwp</span>(<span class="mxinfo" id="T1:U1766">3</span>)</span></span>*<span class="var type1" id="S24T1U2084">X</span></span> + <span class="mxinfo" id="T1:U1768"><span class="mxinfo" id="T1:U1769"><span class="var type1" id="S14T8U2087">qwp</span>(<span class="mxinfo" id="T1:U1771">2</span>)</span>*<span class="var type1" id="S25T1U2089">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1773"><span class="mxinfo" id="T1:U1774">2</span>*(<span class="mxinfo" id="T1:U1775"><span class="mxinfo" id="T1:U1776"><span class="mxinfo" id="T1:U1777">-<span class="mxinfo" id="T1:U1778"><span class="var type1" id="S14T8U2097">qwp</span>(<span class="mxinfo" id="T1:U1780">4</span>)</span></span>*<span class="var type1" id="S24T1U2099">X</span></span> - <span class="mxinfo" id="T1:U1782"><span class="mxinfo" id="T1:U1783"><span class="var type1" id="S14T8U2102">qwp</span>(<span class="mxinfo" id="T1:U1785">1</span>)</span>*<span class="var type1" id="S25T1U2104">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">            <span class="mxinfo" id="T19:U1787"><span class="var type1" id="S36T19U2107">dB2_q</span> = <span class="mxinfo" id="T19:U1789">[<span class="mxinfo" id="T1:U1790"><span class="mxinfo" id="T1:U1791">2</span>*(<span class="mxinfo" id="T1:U1792"><span class="mxinfo" id="T1:U1793"><span class="mxinfo" id="T1:U1794"><span class="var type1" id="S14T8U2116">qwp</span>(<span class="mxinfo" id="T1:U1796">4</span>)</span>*<span class="var type1" id="S24T1U2118">X</span></span> + <span class="mxinfo" id="T1:U1798"><span class="mxinfo" id="T1:U1799"><span class="var type1" id="S14T8U2121">qwp</span>(<span class="mxinfo" id="T1:U1801">1</span>)</span>*<span class="var type1" id="S25T1U2123">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1803"><span class="mxinfo" id="T1:U1804">2</span>*(<span class="mxinfo" id="T1:U1805"><span class="mxinfo" id="T1:U1806"><span class="mxinfo" id="T1:U1807"><span class="var type1" id="S14T8U2130">qwp</span>(<span class="mxinfo" id="T1:U1809">3</span>)</span>*<span class="var type1" id="S24T1U2132">X</span></span> - <span class="mxinfo" id="T1:U1811"><span class="mxinfo" id="T1:U1812"><span class="var type1" id="S14T8U2135">qwp</span>(<span class="mxinfo" id="T1:U1814">2</span>)</span>*<span class="var type1" id="S25T1U2137">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo" id="T19:U1787"><span class="mxinfo" id="T19:U1789">                    <span class="mxinfo" id="T1:U1816"><span class="mxinfo" id="T1:U1817">2</span>*(<span class="mxinfo" id="T1:U1818"><span class="mxinfo" id="T1:U1819"><span class="mxinfo" id="T1:U1820"><span class="var type1" id="S14T8U2144">qwp</span>(<span class="mxinfo" id="T1:U1822">2</span>)</span>*<span class="var type1" id="S24T1U2146">X</span></span> + <span class="mxinfo" id="T1:U1824"><span class="mxinfo" id="T1:U1825"><span class="var type1" id="S14T8U2149">qwp</span>(<span class="mxinfo" id="T1:U1827">3</span>)</span>*<span class="var type1" id="S25T1U2151">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1829"><span class="mxinfo" id="T1:U1830">2</span>*(<span class="mxinfo" id="T1:U1831"><span class="mxinfo" id="T1:U1832"><span class="mxinfo" id="T1:U1833"><span class="var type1" id="S14T8U2158">qwp</span>(<span class="mxinfo" id="T1:U1835">1</span>)</span>*<span class="var type1" id="S24T1U2160">X</span></span> - <span class="mxinfo" id="T1:U1837"><span class="mxinfo" id="T1:U1838"><span class="var type1" id="S14T8U2163">qwp</span>(<span class="mxinfo" id="T1:U1840">4</span>)</span>*<span class="var type1" id="S25T1U2165">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">            <span class="mxinfo" id="T19:U1842"><span class="var type1" id="S37T19U2168">dB3_q</span> = <span class="mxinfo" id="T19:U1844">[<span class="mxinfo" id="T1:U1845"><span class="mxinfo" id="T1:U1846">2</span>*(<span class="mxinfo" id="T1:U1847"><span class="mxinfo" id="T1:U1848"><span class="mxinfo" id="T1:U1849">-<span class="mxinfo" id="T1:U1850"><span class="var type1" id="S14T8U2178">qwp</span>(<span class="mxinfo" id="T1:U1852">3</span>)</span></span>*<span class="var type1" id="S24T1U2180">X</span></span> + <span class="mxinfo" id="T1:U1854"><span class="mxinfo" id="T1:U1855"><span class="var type1" id="S14T8U2183">qwp</span>(<span class="mxinfo" id="T1:U1857">2</span>)</span>*<span class="var type1" id="S25T1U2185">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1859"><span class="mxinfo" id="T1:U1860">2</span>*(<span class="mxinfo" id="T1:U1861"><span class="mxinfo" id="T1:U1862"><span class="mxinfo" id="T1:U1863"><span class="var type1" id="S14T8U2192">qwp</span>(<span class="mxinfo" id="T1:U1865">4</span>)</span>*<span class="var type1" id="S24T1U2194">X</span></span> + <span class="mxinfo" id="T1:U1867"><span class="mxinfo" id="T1:U1868"><span class="var type1" id="S14T8U2197">qwp</span>(<span class="mxinfo" id="T1:U1870">1</span>)</span>*<span class="var type1" id="S25T1U2199">Y</span></span></span>)</span>,<span class="keyword">...</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"><span class="mxinfo" id="T19:U1842"><span class="mxinfo" id="T19:U1844">                    <span class="mxinfo" id="T1:U1872"><span class="mxinfo" id="T1:U1873">2</span>*(<span class="mxinfo" id="T1:U1874"><span class="mxinfo" id="T1:U1875"><span class="mxinfo" id="T1:U1876">-<span class="mxinfo" id="T1:U1877"><span class="var type1" id="S14T8U2207">qwp</span>(<span class="mxinfo" id="T1:U1879">1</span>)</span></span>*<span class="var type1" id="S24T1U2209">X</span></span> + <span class="mxinfo" id="T1:U1881"><span class="mxinfo" id="T1:U1882"><span class="var type1" id="S14T8U2212">qwp</span>(<span class="mxinfo" id="T1:U1884">4</span>)</span>*<span class="var type1" id="S25T1U2214">Y</span></span></span>)</span>,<span class="mxinfo" id="T1:U1886"><span class="mxinfo" id="T1:U1887">2</span>*(<span class="mxinfo" id="T1:U1888"><span class="mxinfo" id="T1:U1889"><span class="mxinfo" id="T1:U1890"><span class="var type1" id="S14T8U2221">qwp</span>(<span class="mxinfo" id="T1:U1892">2</span>)</span>*<span class="var type1" id="S24T1U2223">X</span></span> + <span class="mxinfo" id="T1:U1894"><span class="mxinfo" id="T1:U1895"><span class="var type1" id="S14T8U2226">qwp</span>(<span class="mxinfo" id="T1:U1897">3</span>)</span>*<span class="var type1" id="S25T1U2228">Y</span></span></span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">            <span class="mxinfo" id="T20:U1899"><span class="var type1" id="S38T20U2231">dB1_x</span> = <span class="mxinfo" id="T20:U1901">[<span class="mxinfo" id="T1:U1902">1</span> <span class="mxinfo" id="T1:U1903">0</span> <span class="mxinfo" id="T1:U1904">0</span> <span class="var type1" id="S34T18U2237">dB_zeros</span> <span class="var type1" id="S35T19U2238">dB1_q</span> <span class="var type1" id="S34T18U2239">dB_zeros</span> <span class="var type1" id="S34T18U2240">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">            <span class="mxinfo" id="T20:U1909"><span class="var type1" id="S39T20U2243">dB2_x</span> = <span class="mxinfo" id="T20:U1911">[<span class="mxinfo" id="T1:U1912">0</span> <span class="mxinfo" id="T1:U1913">1</span> <span class="mxinfo" id="T1:U1914">0</span> <span class="var type1" id="S34T18U2249">dB_zeros</span> <span class="var type1" id="S36T19U2250">dB2_q</span> <span class="var type1" id="S34T18U2251">dB_zeros</span> <span class="var type1" id="S34T18U2252">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">            <span class="mxinfo" id="T20:U1919"><span class="var type1" id="S40T20U2255">dB3_x</span> = <span class="mxinfo" id="T20:U1921">[<span class="mxinfo" id="T1:U1922">0</span> <span class="mxinfo" id="T1:U1923">0</span> <span class="mxinfo" id="T1:U1924">1</span> <span class="var type1" id="S34T18U2261">dB_zeros</span> <span class="var type1" id="S37T19U2262">dB3_q</span> <span class="var type1" id="S34T18U2263">dB_zeros</span> <span class="var type1" id="S34T18U2264">dB_zeros</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">            <span class="mxinfo" id="T20:U1929"><span class="var type1" id="S41T20U2267">au_prime</span> = <span class="mxinfo" id="T20:U1931"><span class="mxinfo" id="T20:U1932"><span class="mxinfo" id="T20:U1933"><span class="mxinfo" id="T1:U1934"><span class="var type1" id="S23T5U2272">K</span>(<span class="mxinfo" id="T1:U1936">1</span>,<span class="mxinfo" id="T1:U1937">1</span>)</span>*<span class="var type1" id="S38T20U2275">dB1_x</span></span> + <span class="mxinfo" id="T20:U1939"><span class="mxinfo" id="T1:U1940"><span class="var type1" id="S23T5U2278">K</span>(<span class="mxinfo" id="T1:U1942">1</span>,<span class="mxinfo" id="T1:U1943">2</span>)</span>*<span class="var type1" id="S39T20U2281">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1945"><span class="mxinfo" id="T1:U1946"><span class="var type1" id="S23T5U2284">K</span>(<span class="mxinfo" id="T1:U1948">1</span>,<span class="mxinfo" id="T1:U1949">3</span>)</span>*<span class="var type1" id="S40T20U2287">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">            <span class="mxinfo" id="T20:U1951"><span class="var type1" id="S42T20U2290">av_prime</span> = <span class="mxinfo" id="T20:U1953"><span class="mxinfo" id="T20:U1954"><span class="mxinfo" id="T20:U1955"><span class="mxinfo" id="T1:U1956"><span class="var type1" id="S23T5U2295">K</span>(<span class="mxinfo" id="T1:U1958">2</span>,<span class="mxinfo" id="T1:U1959">1</span>)</span>*<span class="var type1" id="S38T20U2298">dB1_x</span></span> + <span class="mxinfo" id="T20:U1961"><span class="mxinfo" id="T1:U1962"><span class="var type1" id="S23T5U2301">K</span>(<span class="mxinfo" id="T1:U1964">2</span>,<span class="mxinfo" id="T1:U1965">2</span>)</span>*<span class="var type1" id="S39T20U2304">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1967"><span class="mxinfo" id="T1:U1968"><span class="var type1" id="S23T5U2307">K</span>(<span class="mxinfo" id="T1:U1970">2</span>,<span class="mxinfo" id="T1:U1971">3</span>)</span>*<span class="var type1" id="S40T20U2310">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">            <span class="mxinfo" id="T20:U1973"><span class="var type1" id="S43T20U2313">b_prime</span> = <span class="mxinfo" id="T20:U1975"><span class="mxinfo" id="T20:U1976"><span class="mxinfo" id="T20:U1977"><span class="mxinfo" id="T1:U1978"><span class="var type1" id="S23T5U2318">K</span>(<span class="mxinfo" id="T1:U1980">3</span>,<span class="mxinfo" id="T1:U1981">1</span>)</span>*<span class="var type1" id="S38T20U2321">dB1_x</span></span> + <span class="mxinfo" id="T20:U1983"><span class="mxinfo" id="T1:U1984"><span class="var type1" id="S23T5U2324">K</span>(<span class="mxinfo" id="T1:U1986">3</span>,<span class="mxinfo" id="T1:U1987">2</span>)</span>*<span class="var type1" id="S39T20U2327">dB2_x</span></span></span> + <span class="mxinfo" id="T20:U1989"><span class="mxinfo" id="T1:U1990"><span class="var type1" id="S23T5U2330">K</span>(<span class="mxinfo" id="T1:U1992">3</span>,<span class="mxinfo" id="T1:U1993">3</span>)</span>*<span class="var type1" id="S40T20U2333">dB3_x</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">            <span class="mxinfo" id="T20:U1995"><span class="var type1" id="S44T20U2336">bu_prime</span> = <span class="var type1" id="S43T20U2337">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">            <span class="mxinfo" id="T20:U1998"><span class="var type1" id="S45T20U2340">bv_prime</span> = <span class="var type1" id="S43T20U2341">b_prime</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">            <span class="mxinfo" id="T1:U2001"><span class="var type1" id="S46T1U2344">b_sq</span> = <span class="mxinfo" id="T1:U2003"><span class="var type1" id="S29T1U2346">b</span>^2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">            <span class="mxinfo" id="T20:U2005"><span class="var type1" id="S47T20U2350">du_dx</span> = <span class="mxinfo" id="T20:U2007">(<span class="mxinfo" id="T20:U2008"><span class="mxinfo" id="T20:U2009"><span class="var type1" id="S41T20U2355">au_prime</span>*<span class="var type1" id="S30T1U2356">bu</span></span> - <span class="mxinfo" id="T20:U2012"><span class="var type1" id="S32T1U2358">au</span>*<span class="var type1" id="S44T20U2359">bu_prime</span></span></span>)/<span class="var type1" id="S46T1U2360">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">            <span class="mxinfo" id="T20:U2016"><span class="var type1" id="S48T20U2363">dv_dx</span> = <span class="mxinfo" id="T20:U2018">(<span class="mxinfo" id="T20:U2019"><span class="mxinfo" id="T20:U2020"><span class="var type1" id="S42T20U2368">av_prime</span>*<span class="var type1" id="S31T1U2369">bv</span></span> - <span class="mxinfo" id="T20:U2023"><span class="var type1" id="S33T1U2371">av</span>*<span class="var type1" id="S45T20U2372">bv_prime</span></span></span>)/<span class="var type1" id="S46T1U2373">b_sq</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">            <span class="mxinfo" id="T49:U2027"><span class="mxinfo" id="T49:U2028"><span class="var type1" id="S11T21U2377">H</span>(<span class="mxinfo" id="T17:U2030"><span class="var type1" id="S17T1U2379">k</span>:<span class="mxinfo" id="T1:U2032"><span class="var type1" id="S17T1U2381">k</span>+1</span></span>,:)</span> = <span class="mxinfo" id="T49:U2034">[<span class="var type1" id="S47T20U2386">du_dx</span>;<span class="var type1" id="S48T20U2388">dv_dx</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line">            <span class="mxinfo" id="T1:U2037"><span class="mxinfo" id="T1:U2038"><span class="var type1" id="S16T35U2392">z_meas</span>(<span class="var type1" id="S17T1U2393">k</span>,<span class="mxinfo" id="T1:U2041">1</span>)</span> = <span class="mxinfo" id="T1:U2042"><span class="mxinfo" id="T3:U2043"><span class="mxinfo" id="T48:U2044"><span class="var type1" id="S5T2U2398">z</span>(<span class="mxinfo" id="T1:U2046">1</span>,<span class="var type1" id="S10T1U2400">i</span>)</span>.blue_data</span>(<span class="mxinfo" id="T1:U2048">1</span>,<span class="mxinfo" id="T1:U2049">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line">            <span class="mxinfo" id="T1:U2050"><span class="mxinfo" id="T1:U2051"><span class="var type1" id="S16T35U2407">z_meas</span>(<span class="mxinfo" id="T1:U2053"><span class="var type1" id="S17T1U2409">k</span>+<span class="mxinfo" id="T1:U2055">1</span></span>,<span class="mxinfo" id="T1:U2056">1</span>)</span> = <span class="mxinfo" id="T1:U2057"><span class="mxinfo" id="T3:U2058"><span class="mxinfo" id="T48:U2059"><span class="var type1" id="S5T2U2415">z</span>(<span class="mxinfo" id="T1:U2061">1</span>,<span class="var type1" id="S10T1U2417">i</span>)</span>.blue_data</span>(<span class="mxinfo" id="T1:U2063">1</span>,<span class="mxinfo" id="T1:U2064">2</span>)</span></span>;                        </span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line">            <span class="mxinfo" id="T1:U2065"><span class="var type1" id="S17T1U2423">k</span> = <span class="mxinfo" id="T1:U2067"><span class="var type1" id="S17T1U2425">k</span> + <span class="mxinfo" id="T1:U2069">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line">    <span class="comment">% pixel noise goes additively</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line">    <span class="mxinfo" id="T1:U2070">[<span class="var type1" id="S49T1U2430">row_H</span>,<span class="mxinfo" id="T1:U2072"><span class="var type1" id="S50T1U2431">col_H</span></span>] = size(<span class="var type1" id="S11T21U2434">H</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line">    <span class="mxinfo" id="T26:U2075"><span class="var type1" id="S52T26U2437">R</span> = <span class="mxinfo" id="T26:U2077"><span class="mxinfo" id="T26:U2078">eye(<span class="var type1" id="S49T1U2441">row_H</span>)</span>*<span class="var type1" id="S8T1U2442">Measurement_noise</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line">    <span class="comment">% Compute Kalman gain</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line">    <span class="mxinfo" id="T28:U2081"><span class="var type1" id="S54T28U2445">Kalman</span> = <span class="mxinfo" id="T28:U2083"><span class="mxinfo" id="T28:U2084"><span class="var type1" id="S6T27U2448">P</span>*<span class="mxinfo" id="T28:U2086"><span class="var type1" id="S11T21U2450">H</span>'</span></span>*(<span class="mxinfo" id="T26:U2088">(<span class="mxinfo" id="T26:U2089"><span class="mxinfo" id="T26:U2090"><span class="mxinfo" id="T21:U2091"><span class="var type1" id="S11T21U2457">H</span>*<span class="var type1" id="S6T27U2458">P</span></span>*<span class="mxinfo" id="T28:U2094"><span class="var type1" id="S11T21U2460">H</span>'</span></span> + <span class="var type1" id="S52T26U2461">R</span></span>)^-1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line">    <span class="mxinfo" id="T7:U2097"><span class="var type1" id="S2T7U2466">xCorr</span> = <span class="mxinfo" id="T7:U2099"><span class="var type1" id="S4T7U2468">x</span> + <span class="mxinfo" id="T7:U2101"><span class="var type1" id="S54T28U2470">Kalman</span>*(<span class="mxinfo" id="T35:U2103"><span class="var type1" id="S16T35U2473">z_meas</span> - <span class="var type1" id="S15T35U2474">z_est</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line">    <span class="mxinfo" id="T27:U2106"><span class="var type1" id="S3T27U2477">PCorr</span> = <span class="mxinfo" id="T27:U2108">(<span class="mxinfo" id="T27:U2109"><span class="mxinfo" id="T27:U2110">eye(16)</span> - <span class="mxinfo" id="T27:U2111"><span class="var type1" id="S54T28U2485">Kalman</span>*<span class="var type1" id="S11T21U2486">H</span></span></span>)*<span class="var type1" id="S6T27U2487">P</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,225" id="srcline225">225</a></span><span class="line"></span></span>
</pre>
